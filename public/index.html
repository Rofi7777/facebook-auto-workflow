<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Platform Baby Toy Content Generator</title>
    <link rel="stylesheet" href="/css/adminConsole.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #87CEEB 0%, #FFB6C1 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }
        
        /* Áî®Êà∂Ë™çË≠âÂçÄÂüüÊ®£Âºè */
        .header-top-bar {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 100;
        }
        
        .user-info {
            display: none;
            align-items: center;
            gap: 10px;
            background: rgba(255,255,255,0.9);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 13px;
            color: #333;
        }
        
        .user-info .user-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: linear-gradient(135deg, #87CEEB 0%, #FFB6C1 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 12px;
        }
        
        .auth-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s;
        }
        
        .auth-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .auth-btn.logout-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a5a 100%);
        }
        
        .auth-btn.logout-btn:hover {
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.4);
        }
        
        /* ÂÖ®Â±èË™çË≠âÈ†ÅÈù¢Ê®£Âºè - Á≤æÁæéÁâà */
        #authShell {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #2d1b4e 0%, #4a2c7a 30%, #6b3fa0 60%, #8b5ab5 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            overflow: hidden;
        }
        
        #authShell::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 100, 150, 0.15) 0%, transparent 30%),
                radial-gradient(circle at 80% 70%, rgba(100, 150, 255, 0.15) 0%, transparent 30%),
                radial-gradient(circle at 50% 50%, rgba(150, 100, 255, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }
        
        /* Ë£ùÈ£æÊÄßÊµÆÂãïÂÖÉÁ¥† */
        .auth-decoration {
            position: absolute;
            font-size: 24px;
            animation: float 6s ease-in-out infinite;
            z-index: 1;
            pointer-events: none;
        }
        
        .auth-decoration.star1 { top: 8%; left: 5%; animation-delay: 0s; font-size: 28px; }
        .auth-decoration.star2 { top: 15%; right: 15%; animation-delay: 1s; font-size: 20px; }
        .auth-decoration.star3 { bottom: 20%; right: 8%; animation-delay: 2s; font-size: 16px; }
        .auth-decoration.star4 { top: 40%; left: 8%; animation-delay: 3s; font-size: 14px; }
        .auth-decoration.balloon { bottom: 25%; left: 8%; animation-delay: 1.5s; font-size: 32px; }
        .auth-decoration.rocket { bottom: 15%; right: 10%; animation-delay: 2.5s; font-size: 36px; }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-10px) rotate(3deg); }
            50% { transform: translateY(-5px) rotate(-2deg); }
            75% { transform: translateY(-15px) rotate(2deg); }
        }
        
        #authShell.hidden {
            display: none;
        }
        
        #appShell {
            display: none;
        }
        
        #appShell.visible {
            display: block;
        }
        
        .auth-card {
            background: rgba(255, 255, 255, 0.12);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 28px;
            padding: 45px 40px;
            width: 90%;
            max-width: 420px;
            box-shadow: 0 25px 80px rgba(0,0,0,0.3);
            position: relative;
            z-index: 10;
            text-align: center;
        }
        
        .auth-header-title {
            font-size: 22px;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 20px;
            letter-spacing: 2px;
        }
        
        .auth-logo {
            margin-bottom: 15px;
        }
        
        .auth-logo-icon {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, #7c4dff 0%, #b388ff 100%);
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 36px;
            box-shadow: 0 8px 25px rgba(124, 77, 255, 0.4);
        }
        
        .auth-brand-name {
            font-size: 26px;
            font-weight: 700;
            color: white;
            margin-bottom: 6px;
        }
        
        .auth-tagline {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 4px;
        }
        
        .auth-tagline .emoji {
            margin-left: 4px;
        }
        
        .auth-welcome-title {
            font-size: 15px;
            font-weight: 400;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 25px;
        }
        
        .auth-welcome-title .sparkle {
            margin-left: 4px;
        }
        
        .auth-form-group {
            margin-bottom: 18px;
            text-align: left;
        }
        
        .auth-form-group label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 10px;
        }
        
        .auth-form-group label .icon {
            font-size: 14px;
        }
        
        .auth-form-group input {
            width: 100%;
            padding: 15px 18px;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.15);
            color: white;
            backdrop-filter: blur(5px);
        }
        
        .auth-form-group input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.25);
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1);
        }
        
        .auth-form-group input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .auth-submit-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(90deg, #667eea 0%, #a855f7 50%, #ec4899 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .auth-submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(168, 85, 247, 0.5);
        }
        
        .auth-submit-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }
        
        .auth-submit-btn .arrow {
            font-size: 18px;
            transition: transform 0.3s;
        }
        
        .auth-submit-btn:hover .arrow {
            transform: translateX(4px);
        }
        
        .auth-toggle-link {
            margin-top: 25px;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .auth-toggle-link a {
            color: #f0abfc;
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .auth-toggle-link a:hover {
            color: white;
            text-decoration: underline;
        }
        
        .auth-toggle-link .arrow-link {
            margin-left: 4px;
        }
        
        .auth-error {
            background: rgba(255, 100, 100, 0.2);
            border: 1px solid rgba(255, 100, 100, 0.4);
            color: #ffb3b3;
            padding: 12px 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 13px;
            display: none;
            text-align: left;
        }
        
        .auth-lang-switcher {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 10001;
        }
        
        .auth-lang-switcher select {
            padding: 10px 18px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.15);
            color: white;
            font-size: 13px;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }
        
        .auth-lang-switcher select:hover {
            background: rgba(255, 255, 255, 0.25);
        }
        
        .auth-lang-switcher select option {
            background: #4a2c7a;
            color: white;
        }
        
        /* ÈüøÊáâÂºèË®≠Ë®à - Âπ≥Êùø */
        @media (max-width: 768px) {
            #authShell {
                padding: 16px;
            }
            
            .auth-decoration {
                display: none;
            }
            
            .auth-card {
                max-width: 360px;
                width: 100%;
                padding: 32px 24px;
                border-radius: 22px;
            }
            
            .auth-header-title {
                font-size: 18px;
                margin-bottom: 15px;
            }
            
            .auth-logo-icon {
                width: 60px;
                height: 60px;
                font-size: 30px;
                border-radius: 14px;
            }
            
            .auth-brand-name {
                font-size: 22px;
            }
            
            .auth-tagline {
                font-size: 13px;
            }
            
            .auth-welcome-title {
                font-size: 14px;
                margin-bottom: 20px;
            }
            
            .auth-form-group input {
                font-size: 15px;
                padding: 14px 16px;
                min-height: 48px;
            }
            
            .auth-submit-btn {
                padding: 14px;
                font-size: 15px;
                min-height: 48px;
            }
            
            .auth-lang-switcher {
                top: 16px;
                right: 16px;
            }
            
            .auth-lang-switcher select {
                padding: 10px 14px;
                font-size: 12px;
                min-height: 44px;
            }
        }
        
        /* ÈüøÊáâÂºèË®≠Ë®à - ÊâãÊ©ü */
        @media (max-width: 480px) {
            #authShell {
                padding: 12px;
            }
            
            .auth-decoration {
                display: none;
            }
            
            .auth-card {
                width: 94%;
                max-width: none;
                padding: 28px 20px;
                border-radius: 20px;
                margin: 0 auto;
            }
            
            .auth-header-title {
                font-size: 16px;
                margin-bottom: 12px;
                letter-spacing: 1px;
            }
            
            .auth-logo-icon {
                width: 55px;
                height: 55px;
                font-size: 28px;
                border-radius: 12px;
                margin-bottom: 12px;
            }
            
            .auth-brand-name {
                font-size: 20px;
            }
            
            .auth-tagline {
                font-size: 12px;
            }
            
            .auth-welcome-title {
                font-size: 13px;
                margin-bottom: 18px;
            }
            
            .auth-form-group {
                margin-bottom: 14px;
            }
            
            .auth-form-group label {
                font-size: 12px;
                margin-bottom: 8px;
            }
            
            .auth-form-group input {
                font-size: 16px;
                padding: 14px;
                min-height: 50px;
                border-radius: 10px;
            }
            
            .auth-submit-btn {
                padding: 16px;
                font-size: 16px;
                min-height: 52px;
                border-radius: 12px;
                margin-top: 8px;
            }
            
            .auth-toggle-link {
                font-size: 13px;
                margin-top: 20px;
            }
            
            .auth-error {
                font-size: 12px;
                padding: 10px 12px;
            }
            
            .auth-lang-switcher {
                top: 10px;
                right: 10px;
            }
            
            .auth-lang-switcher select {
                padding: 8px 12px;
                font-size: 11px;
                min-height: 40px;
                border-radius: 8px;
            }
        }
        
        /* ÊâãÊ©üÊ©´ÂêëÊ®°Âºè */
        @media (max-height: 600px) and (orientation: landscape) {
            #authShell {
                overflow-y: auto;
                padding: 10px;
            }
            
            .auth-decoration {
                display: none;
            }
            
            .auth-card {
                padding: 20px;
                margin: 10px auto;
            }
            
            .auth-header-title {
                font-size: 14px;
                margin-bottom: 8px;
            }
            
            .auth-logo-icon {
                width: 45px;
                height: 45px;
                font-size: 22px;
                margin-bottom: 8px;
            }
            
            .auth-brand-name {
                font-size: 18px;
            }
            
            .auth-tagline {
                font-size: 11px;
                margin-bottom: 2px;
            }
            
            .auth-welcome-title {
                font-size: 12px;
                margin-bottom: 12px;
            }
            
            .auth-card .form-group {
                margin-bottom: 12px;
            }
            
            .auth-card input {
                padding: 10px 12px;
                min-height: 40px;
            }
            
            .auth-card button {
                padding: 12px;
                min-height: 44px;
                margin-top: 5px;
            }
        }
        
        /* ‰øùÁïôËàäÁöÑ modal Ê®£Âºè‰ΩúÁÇ∫ÂÇôÁî® */
        .auth-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }
        
        .auth-modal-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            width: 90%;
            max-width: 420px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            position: relative;
        }
        
        .auth-modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 24px;
            color: #999;
            cursor: pointer;
            transition: color 0.2s;
        }
        
        .auth-modal-close:hover {
            color: #333;
        }
        
        .auth-tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid #eee;
        }
        
        .auth-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            color: #999;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
        }
        
        .auth-tab:hover {
            color: #667eea;
        }
        
        .auth-tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }
        
        .auth-form-container {
            display: none;
        }
        
        .auth-form-container.active,
        #loginFormContainer {
            display: block;
        }
        
        .auth-form-group {
            margin-bottom: 20px;
        }
        
        .auth-form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }
        
        .auth-form-group input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 15px;
            transition: border-color 0.3s;
        }
        
        .auth-form-group input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .auth-submit-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .auth-submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }
        
        .auth-submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .auth-error {
            display: none;
            background: #ffe6e6;
            color: #d63031;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
        }
        
        .auth-divider {
            text-align: center;
            margin: 25px 0;
            color: #999;
            font-size: 13px;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Áî®Êà∂ÂõûÈ•ãÊåâÈàïÊ®£Âºè */
        .feedback-buttons {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            padding: 12px 16px;
            background: linear-gradient(135deg, rgba(135, 206, 235, 0.1) 0%, rgba(255, 182, 193, 0.1) 100%);
            border-radius: 12px;
            border: 1px solid rgba(135, 206, 235, 0.2);
        }
        
        .feedback-buttons .feedback-label {
            font-size: 13px;
            color: #666;
            margin-right: 8px;
        }
        
        .feedback-buttons .feedback-label.thanks {
            color: #27ae60;
            font-weight: 500;
        }
        
        .feedback-buttons .feedback-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border: 2px solid #e0e0e0;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 16px;
        }
        
        .feedback-buttons .feedback-btn:hover {
            transform: scale(1.1);
            border-color: #87CEEB;
        }
        
        .feedback-buttons .feedback-btn.thumbs-up:hover,
        .feedback-buttons .feedback-btn.thumbs-up.selected {
            background: #d4edda;
            border-color: #27ae60;
        }
        
        .feedback-buttons .feedback-btn.thumbs-down:hover,
        .feedback-buttons .feedback-btn.thumbs-down.selected {
            background: #f8d7da;
            border-color: #e74c3c;
        }
        
        .feedback-buttons .feedback-btn.selected {
            transform: scale(1.15);
        }
        
        /* Ë™ûË®ÄÂàáÊèõÂô®Ê®£Âºè */
        .language-switcher {
            position: relative;
        }
        
        .language-dropdown {
            position: relative;
            display: inline-block;
        }
        
        .language-btn {
            background: linear-gradient(135deg, #87CEEB 0%, #FFB6C1 100%);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .language-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(135, 206, 235, 0.4);
        }
        
        .language-menu {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            overflow: hidden;
            min-width: 180px;
            z-index: 1000;
        }
        
        .language-menu.active {
            display: block;
        }
        
        .language-option {
            padding: 12px 20px;
            cursor: pointer;
            transition: background 0.2s;
            font-size: 14px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .language-option:hover {
            background: #f0f8ff;
        }
        
        .language-option.active {
            background: linear-gradient(135deg, #87CEEB 0%, #FFB6C1 100%);
            color: white;
        }
        
        .header h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 32px;
        }
        
        .header p {
            color: #666;
            font-size: 18px;
        }
        
        /* ÂàÜÈ†ÅÂàáÊèõÊ®£Âºè */
        .tab-navigation {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .tab-btn {
            padding: 12px 30px;
            font-size: 16px;
            font-weight: 600;
            border: 2px solid #87CEEB;
            background: white;
            color: #87CEEB;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .tab-btn:hover {
            background: #f0f8ff;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(135, 206, 235, 0.3);
        }
        
        .tab-btn.active {
            background: linear-gradient(135deg, #87CEEB 0%, #FFB6C1 100%);
            color: white;
            border-color: transparent;
        }
        
        .page-content {
            display: none;
        }
        
        .page-content.active {
            display: block;
        }
        
        .workflow-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .input-panel, .output-panel {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            padding: 30px;
        }
        
        .panel-title {
            font-size: 24px;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }
        
        .form-group input:not([type="checkbox"]):not([type="radio"]),
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #87CEEB;
        }
        
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 12px;
            margin-top: 10px;
            width: 100%;
        }
        
        .checkbox-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 15px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            transition: all 0.3s;
            cursor: pointer;
            min-height: 60px;
            box-sizing: border-box;
            width: 100%;
        }
        
        .checkbox-item label {
            flex: 1;
            font-size: 14px;
            cursor: pointer;
            line-height: 1.4;
            word-wrap: break-word;
            overflow-wrap: break-word;
            display: block;
            width: 100%;
        }
        
        .checkbox-item:hover {
            border-color: #87CEEB;
            background: #f8f9fa;
        }
        
        .checkbox-item input[type="radio"],
        .checkbox-item input[type="checkbox"] {
            width: auto;
            flex: 0 0 auto;
            margin: 0;
        }
        
        .file-upload {
            border: 2px dashed #e1e5e9;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: border-color 0.3s;
            cursor: pointer;
        }
        
        .file-upload:hover {
            border-color: #87CEEB;
        }
        
        .file-upload input[type="file"] {
            display: none;
        }
        
        .image-preview-container {
            display: none;
            margin-top: 15px;
            padding: 15px;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            background: #f8f9fa;
        }
        
        .image-preview-container.show {
            display: block;
        }
        
        .image-preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .image-preview-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            background: white;
            border: 2px solid #e1e5e9;
        }
        
        .image-preview-item img {
            width: 100%;
            height: 100px;
            object-fit: cover;
            display: block;
        }
        
        .image-preview-item .remove-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(255, 0, 0, 0.8);
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .image-preview-item .remove-btn:hover {
            background: rgba(255, 0, 0, 1);
        }
        
        .selected-count {
            margin-top: 10px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }
        
        .btn {
            background: linear-gradient(135deg, #87CEEB 0%, #FFB6C1 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: transform 0.2s;
            margin-bottom: 10px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: #6c757d;
        }
        
        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #87CEEB;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .results-container {
            display: none;
            margin-top: 30px;
        }
        
        .platform-result {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .platform-result h3 {
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .platform-result .content {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            white-space: pre-wrap;
        }
        
        .platform-result .hashtags {
            color: #007bff;
            font-weight: 500;
        }
        
        .hashtags-bilingual {
            margin-top: 15px;
            color: #1976d2;
            font-size: 0.9em;
            padding: 10px;
            background: #f5f5f5;
            border-radius: 8px;
        }
        
        .bilingual-content .language-section {
            padding: 12px;
            margin: 8px 0;
            border-left: 4px solid #e0e0e0;
            background: #fafafa;
            border-radius: 0 8px 8px 0;
        }
        
        .bilingual-analysis {
            margin-bottom: 15px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        
        .bilingual-analysis .language-section {
            padding: 8px;
            margin: 4px 0;
            border-left: 3px solid #e0e0e0;
            background: #ffffff;
            border-radius: 0 6px 6px 0;
        }
        
        .platform-result .image-preview {
            max-width: 100%;
            border-radius: 8px;
            margin-top: 10px;
        }
        
        .analysis-section {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .analysis-section h4 {
            color: #1976d2;
            margin-bottom: 10px;
        }
        
        .pain-point, .scenario {
            background: white;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 8px;
            border-left: 4px solid #87CEEB;
        }
        
        /* Â∞çË©±Ë¶ñÁ™óÊ®£Âºè */
        .chat-advisor-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            padding: 25px;
            margin-top: 20px;
            display: none;
        }
        
        .chat-advisor-container.active {
            display: block;
        }
        
        .chat-header {
            font-size: 20px;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e1e5e9;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .chat-messages {
            height: 400px;
            overflow-y: auto;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .chat-message {
            margin-bottom: 15px;
            display: flex;
            gap: 10px;
        }
        
        .chat-message.user {
            flex-direction: row-reverse;
        }
        
        .chat-message-content {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 15px;
            line-height: 1.5;
        }
        
        .chat-message.ai .chat-message-content {
            background: linear-gradient(135deg, #87CEEB 0%, #FFB6C1 100%);
            color: white;
        }
        
        .chat-message.user .chat-message-content {
            background: white;
            color: #333;
            border: 2px solid #e1e5e9;
        }
        
        .chat-message-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .chat-message.ai .chat-message-avatar {
            background: linear-gradient(135deg, #87CEEB 0%, #FFB6C1 100%);
        }
        
        .chat-message.user .chat-message-avatar {
            background: #e1e5e9;
        }
        
        .suggested-questions {
            margin-bottom: 15px;
            padding: 15px;
            background: #fff3cd;
            border-radius: 10px;
            border-left: 4px solid #ffc107;
        }
        
        .suggested-questions h4 {
            margin-bottom: 10px;
            color: #856404;
            font-size: 14px;
        }
        
        .suggested-question-btn {
            display: block;
            width: 100%;
            text-align: left;
            padding: 10px 15px;
            margin-bottom: 8px;
            background: white;
            border: 1px solid #ffc107;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            color: #856404;
        }
        
        .suggested-question-btn:hover {
            background: #ffc107;
            color: white;
            transform: translateX(5px);
        }
        
        .chat-input-area {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }
        
        .chat-input-wrapper {
            flex: 1;
            position: relative;
        }
        
        .chat-input {
            width: 100%;
            padding: 12px 100px 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 25px;
            font-size: 14px;
            resize: none;
            font-family: inherit;
            max-height: 100px;
        }
        
        .chat-input:focus {
            outline: none;
            border-color: #87CEEB;
        }
        
        .chat-file-upload-btn {
            position: absolute;
            right: 50px;
            bottom: 8px;
            background: #f0f0f0;
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 18px;
        }
        
        .chat-file-upload-btn:hover {
            background: #87CEEB;
            color: white;
        }
        
        .chat-send-btn {
            background: linear-gradient(135deg, #87CEEB 0%, #FFB6C1 100%);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 20px;
        }
        
        .chat-send-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 10px rgba(135, 206, 235, 0.4);
        }
        
        .chat-send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .chat-file-preview {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }
        
        .chat-file-item {
            background: #f0f0f0;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .chat-file-remove {
            cursor: pointer;
            color: #999;
            font-weight: bold;
        }
        
        .chat-file-remove:hover {
            color: #ff4444;
        }
        
        @media (max-width: 768px) {
            .workflow-container {
                grid-template-columns: 1fr;
            }
            
            .checkbox-group {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .checkbox-item {
                min-height: 70px;
                padding: 12px;
            }
            
            .checkbox-item label {
                font-size: 13px;
                line-height: 1.3;
            }
        }
    </style>
</head>
<body>
    <!-- ÂÖ®Â±èÁôªÂÖ•È†ÅÈù¢ (Êú™ÁôªÂÖ•ÊôÇÈ°ØÁ§∫) -->
    <div id="authShell">
        <!-- Ë£ùÈ£æÊÄßÊµÆÂãïÂÖÉÁ¥† -->
        <div class="auth-decoration star1">‚ú®</div>
        <div class="auth-decoration star2">‚≠ê</div>
        <div class="auth-decoration star3">‚ú®</div>
        <div class="auth-decoration star4">‚≠ê</div>
        <div class="auth-decoration balloon">üéà</div>
        <div class="auth-decoration rocket">üöÄ</div>
        
        <div class="auth-lang-switcher">
            <select id="authLangSelect" onchange="selectLanguage(this.value)">
                <option value="zh-TW">üáπüáº ÁπÅÈ´î‰∏≠Êñá</option>
                <option value="en">üá¨üáß English</option>
                <option value="vi">üáªüá≥ Ti·∫øng Vi·ªát</option>
            </select>
        </div>
        
        <div class="auth-card">
            <!-- È†ÇÈÉ®Ê®ôÈ°å -->
            <div class="auth-header-title" data-i18n="auth_header_title">AI Êô∫ÊÖßÂÖßÂÆπÂπ≥Âè∞</div>
            
            <!-- Logo ÂúñÊ®ô -->
            <div class="auth-logo">
                <div class="auth-logo-icon">ü§ñ</div>
                <div class="auth-brand-name">Googoogaga AI</div>
                <div class="auth-tagline" data-i18n="auth_tagline">ÊÇ®ÁöÑ AI ÂÖßÂÆπÂâµ‰ΩúÂ§•‰º¥<span class="emoji">üåü</span></div>
            </div>
            
            <!-- ÁôªÂÖ•Ë°®ÂñÆ -->
            <div id="authLoginForm">
                <p class="auth-welcome-title" data-i18n="auth_welcome_message">Ê≠°ËøéÂõû‰æÜÔºÅ<span class="sparkle">‚ú®</span></p>
                
                <div class="auth-error" id="authLoginError"></div>
                
                <form onsubmit="handleAuthLogin(event)">
                    <div class="auth-form-group">
                        <label for="authEmail"><span class="icon">‚úâÔ∏è</span> <span data-i18n="auth_email">ÈõªÂ≠êÈÉµ‰ª∂</span></label>
                        <input type="email" id="authEmail" placeholder="your@email.com" required autocomplete="email">
                    </div>
                    <div class="auth-form-group">
                        <label for="authPassword"><span class="icon">üîí</span> <span data-i18n="auth_password">ÂØÜÁ¢º</span></label>
                        <input type="password" id="authPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required autocomplete="current-password">
                    </div>
                    <button type="submit" class="auth-submit-btn" id="authLoginBtn">
                        <span data-i18n="auth_login_btn">ÁôªÂÖ•</span>
                        <span class="arrow">‚Üí</span>
                    </button>
                </form>
                
                <div class="auth-toggle-link">
                    <span data-i18n="auth_no_account">ÈÇÑÊ≤íÊúâÂ∏≥ËôüÔºü</span>
                    <a onclick="toggleAuthForm('register')"><span data-i18n="auth_register_now">Á´ãÂç≥Ë®ªÂÜä</span><span class="arrow-link">‚Ä∫</span></a>
                </div>
            </div>
            
            <!-- Ë®ªÂÜäË°®ÂñÆ -->
            <div id="authRegisterForm" style="display: none;">
                <p class="auth-welcome-title" data-i18n="auth_create_account">Âª∫Á´ãÊñ∞Â∏≥Ëôü<span class="sparkle">‚ú®</span></p>
                
                <div class="auth-error" id="authRegisterError"></div>
                
                <form onsubmit="handleAuthRegister(event)">
                    <div class="auth-form-group">
                        <label for="authRegEmail"><span class="icon">‚úâÔ∏è</span> <span data-i18n="auth_email">ÈõªÂ≠êÈÉµ‰ª∂</span></label>
                        <input type="email" id="authRegEmail" placeholder="your@email.com" required autocomplete="email">
                    </div>
                    <div class="auth-form-group">
                        <label for="authRegPassword"><span class="icon">üîí</span> <span data-i18n="auth_password">ÂØÜÁ¢º</span></label>
                        <input type="password" id="authRegPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" minlength="6" required autocomplete="new-password">
                    </div>
                    <div class="auth-form-group">
                        <label for="authRegConfirmPassword"><span class="icon">üîí</span> <span data-i18n="auth_confirm_password">Á¢∫Ë™çÂØÜÁ¢º</span></label>
                        <input type="password" id="authRegConfirmPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" minlength="6" required autocomplete="new-password">
                    </div>
                    <button type="submit" class="auth-submit-btn" id="authRegisterBtn">
                        <span data-i18n="auth_register_btn">Ë®ªÂÜä</span>
                        <span class="arrow">‚Üí</span>
                    </button>
                </form>
                
                <div class="auth-toggle-link">
                    <span data-i18n="auth_has_account">Â∑≤ÊúâÂ∏≥ËôüÔºü</span>
                    <a onclick="toggleAuthForm('login')" data-i18n="auth_login_now">Á´ãÂç≥ÁôªÂÖ•</a>
                </div>
            </div>
        </div>
    </div>

    <!-- ‰∏ªÊáâÁî®ÂÖßÂÆπ (ÁôªÂÖ•ÂæåÈ°ØÁ§∫) -->
    <div id="appShell">
    <div class="main-container">
        <div class="header">
            <!-- È†ÇÈÉ®Â∑•ÂÖ∑ÂàóÔºöÁî®Êà∂Ë™çË≠â + Ë™ûË®ÄÂàáÊèõ -->
            <div class="header-top-bar">
                <!-- Áî®Êà∂Ë≥áË®ä (ÁôªÂÖ•ÂæåÈ°ØÁ§∫) -->
                <div class="user-info" id="userInfo">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <span id="userEmail">user@email.com</span>
                    <button class="auth-btn logout-btn" id="logoutBtn" onclick="handleLogout()" style="display: none;">
                        <span data-i18n="auth_logout">ÁôªÂá∫</span>
                    </button>
                </div>
                
                <!-- ÁôªÂÖ•ÊåâÈàï (Êú™ÁôªÂÖ•ÊôÇÈ°ØÁ§∫) -->
                <div id="authButtons">
                    <button class="auth-btn" id="loginBtn" onclick="AuthManager.showLoginModal()">
                        üîê <span data-i18n="auth_login">ÁôªÂÖ•</span>
                    </button>
                </div>
                
                <!-- Ë™ûË®ÄÂàáÊèõÂô® -->
                <div class="language-switcher">
                    <div class="language-dropdown">
                        <button class="language-btn" onclick="toggleLanguageMenu()">
                            üåê <span id="currentLanguageDisplay">ÁπÅÈ´î‰∏≠Êñá</span> ‚ñº
                        </button>
                        <div class="language-menu" id="languageMenu">
                            <div class="language-option active" onclick="selectLanguage('zh-TW')">
                                üáπüáº ÁπÅÈ´î‰∏≠Êñá
                            </div>
                            <div class="language-option" onclick="selectLanguage('en')">
                                üá¨üáß English
                            </div>
                            <div class="language-option" onclick="selectLanguage('vi')">
                                üáªüá≥ Ti·∫øng Vi·ªát
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <img id="brandLogo" src="" alt="Brand Logo" style="max-height: 120px; margin-bottom: 15px; border-radius: 10px; display: none;">
            <h1 id="brandTitle" data-i18n="app_title">üß∏ Googoogaga Multi-Platform Generator</h1>
            <p id="brandSlogan" data-i18n="app_subtitle_line1">C√πng b√© kh√°m ph√° th·∫ø gi·ªõi di·ªáu k·ª≥ m·ªói ng√†y</p>
            <p data-i18n="app_subtitle_line2">AI È©ÖÂãïÁöÑÂ§öÂπ≥Âè∞Â¨∞ÂπºÂÖíÁé©ÂÖ∑Ë°åÈä∑ÂÖßÂÆπÁîüÊàêÂô®</p>
            
            <!-- ÂàÜÈ†ÅÂàáÊèõÂ∞éËà™ -->
            <div class="tab-navigation">
                <button class="tab-btn active" onclick="switchPage('page1')">
                    <span data-i18n="tab_image_generation">üé® AI ÂúñÁâáÁîüÊàê</span>
                </button>
                <button class="tab-btn" onclick="switchPage('page2')">
                    <span data-i18n="tab_ads_advisor">üìä AI Âª£ÂëäÈ°ßÂïè</span>
                </button>
                <button class="tab-btn" onclick="switchPage('page3')">
                    <span data-i18n="tab_course_editor">üìö AI Ë™≤Á®ãÁ∑®ËºØÂ∞àÂÆ∂</span>
                </button>
                <button class="tab-btn" onclick="switchPage('page4')">
                    <span data-i18n="tab_prompt_architect">üìù AI Êåá‰ª§Êû∂ÊßãÂ∏´</span>
                </button>
                <button class="tab-btn admin-only" id="adminTabBtn" onclick="switchPage('page5')" style="display: none;">
                    <span data-i18n="tab_admin">üëë ÁÆ°ÁêÜÂì°</span>
                </button>
            </div>
        </div>
        
        <!-- Page 1: AI ÂúñÁâáÁîüÊàê -->
        <div id="page1" class="page-content active">
        <div class="workflow-container">
            <div class="input-panel">
                <h2 class="panel-title">üìù <span data-i18n="product_info_input">Áî¢ÂìÅË≥áË®äËº∏ÂÖ•</span></h2>
                
                <form id="productForm">
                    <div class="form-group">
                        <label for="industryCategory" data-i18n="industry_category">Áî¢Ê•≠È°ûÂà• / Industry Category</label>
                        <select id="industryCategory" name="industryCategory" required>
                            <option value="mother-kids" data-i18n="industry_mother_kids">üë∂ Mother & Kids (ÊØçÂ¨∞Áî®ÂìÅ)</option>
                            <option value="fashion" data-i18n="industry_fashion">üëó Fashion (ÊôÇÂ∞öÊúçÈ£æ)</option>
                            <option value="art-toy" data-i18n="industry_art_toy">üé® Art Toy (ËóùË°ìÁé©ÂÖ∑)</option>
                            <option value="others" data-i18n="industry_others">‚ú® Others (ÂÖ∂‰ªñ)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="productName" data-i18n="product_name">Áî¢ÂìÅÂêçÁ®± / Product Name</label>
                        <input type="text" id="productName" name="productName" data-i18n-placeholder="product_name_placeholder" placeholder="Ëº∏ÂÖ•Áî¢ÂìÅÂêçÁ®±" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="productDescription" data-i18n="product_description">Áî¢ÂìÅÊèèËø∞ (ÂèØÈÅ∏)</label>
                        <textarea id="productDescription" name="productDescription" data-i18n-placeholder="product_description_placeholder" placeholder="ÊèèËø∞Áî¢ÂìÅÁâπËâ≤„ÄÅÂäüËÉΩ„ÄÅÈÅ©Áî®Âπ¥ÈΩ°Á≠â..." rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label data-i18n="image_upload">Áî¢ÂìÅÂúñÁâá / Product Image (ÊîØÊåÅ1-5ÂºµÂúñÁâáÂêåÊôÇ‰∏äÂÇ≥)</label>
                        <div class="file-upload" onclick="document.getElementById('imageUpload').click()">
                            <input type="file" id="imageUpload" accept="image/*" multiple>
                            <p data-i18n="image_upload_text">üì∏ ‰∏äÂÇ≥Áé©ÂÖ∑ÂúñÁâá (Upload toy images - ÊúÄÂ§ö5Âºµ)</p>
                            <small data-i18n="image_upload_hint">ÊîØÊè¥ JPG, PNG (ÊØèÂºµÊúÄÂ§ß 10MBÔºåÊúÄÂ§ö5ÂºµÂúñÁâá)</small>
                        </div>
                        <div id="imagePreviewContainer" class="image-preview-container"></div>
                        <div id="selectedImageCount" class="selected-count" style="display: none;"></div>
                    </div>
                    
                    <div class="form-group">
                        <label data-i18n="target_platform">ÁõÆÊ®ôÂπ≥Âè∞ / Target Platforms</label>
                        <div class="checkbox-group" id="platformsGroup">
                            <!-- Platforms will be loaded dynamically -->
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="language">ÂÖßÂÆπË™ûË®Ä / Content Language</label>
                        <select id="language" name="language">
                            <option value="zh-TW">ÁπÅÈ´î‰∏≠Êñá (Traditional Chinese)</option>
                            <option value="vi">Ti·∫øng Vi·ªát (Vietnamese)</option>
                            <option value="bilingual">ÈõôË™û (Bilingual)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="generateImages" name="generateImages" onchange="toggleScenarioOptions()">
                            <span data-i18n="generate_image_checkbox">Ëá™ÂãïÁîüÊàêË°åÈä∑ÂúñÁâá (Generate Marketing Images)</span>
                        </label>
                    </div>
                    
                    <!-- Ê®°ÁâπÂÖíÂíåÂ†¥ÊôØË®≠ÂÆöÈÅ∏È†Ö -->
                    <div class="form-group" id="modelSceneOptionsGroup" style="display: none;">
                        <h4 style="color: #FF6B4A; margin-bottom: 15px;">üë• <span data-i18n="model_settings">Ê®°ÁâπÂÖíË®≠ÂÆö</span></h4>
                        
                        <div class="form-group">
                            <label for="modelNationality" data-i18n="model_nationality">Ê®°ÁâπÂÖíÂúãÁ±ç</label>
                            <select id="modelNationality" name="modelNationality">
                                <option value="taiwan" data-i18n="nationality_taiwan">Âè∞ÁÅ£</option>
                                <option value="usa" data-i18n="nationality_usa">ÁæéÂúã</option>
                                <option value="russia" data-i18n="nationality_russia">‰øÑÁæÖÊñØ</option>
                                <option value="brazil" data-i18n="nationality_brazil">Â∑¥Ë•ø</option>
                                <option value="custom" data-i18n="nationality_custom">Ëá™ÂÆöÁæ©</option>
                            </select>
                            <div id="customNationalityInput" style="display: none; margin-top: 10px;">
                                <input type="text" id="customNationalityText" placeholder="Ë´ãËº∏ÂÖ•Ê®°ÁâπÂÖíÂúãÁ±çÊàñÁ®ÆÊóèÊèèËø∞ (‰æãÂ¶Ç: Êó•Êú¨„ÄÅÈüìÂúã„ÄÅÊ∑∑Ë°ÄÁ≠â)" style="width: 100%; padding: 10px; border: 2px solid #e1e5e9; border-radius: 8px; font-size: 14px;" data-i18n-placeholder="custom_nationality_placeholder">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="modelCombination" data-i18n="model_combination">‰∫∫Áâ©ÁµÑÂêà</label>
                            <select id="modelCombination" name="modelCombination">
                                <option value="parents_baby" data-i18n="combination_parents_baby">Áà∏Â™ΩËàáÂ¨∞ÂÖí</option>
                                <option value="mom_baby" data-i18n="combination_mom_baby">Â™ΩÂ™ΩËàáÂ¨∞ÂÖí</option>
                                <option value="dad_baby" data-i18n="combination_dad_baby">Áà∏Áà∏ËàáÂ¨∞ÂÖí</option>
                                <option value="couple" data-i18n="combination_couple">Â§´Â¶ª</option>
                                <option value="custom" data-i18n="combination_custom">Ëá™ÂÆöÁæ©</option>
                            </select>
                            <div id="customCombinationInput" style="display: none; margin-top: 10px;">
                                <input type="text" id="customCombinationText" placeholder="Ë´ãËº∏ÂÖ•‰∫∫Áâ©ÁµÑÂêàÊèèËø∞ (‰æãÂ¶Ç: Á•ñÁà∂ÊØçËàáÂ≠´Â≠ê„ÄÅ‰∏â‰ª£ÂêåÂ†ÇÁ≠â)" style="width: 100%; padding: 10px; border: 2px solid #e1e5e9; border-radius: 8px; font-size: 14px;" data-i18n-placeholder="custom_combination_placeholder">
                            </div>
                        </div>
                        
                        <h4 style="color: #4ECDC4; margin-top: 20px; margin-bottom: 15px;">üåç <span data-i18n="scene_settings">Â†¥ÊôØË®≠ÂÆö</span></h4>
                        
                        <div class="form-group">
                            <label for="sceneLocation" data-i18n="scene_location">Â†¥ÊôØÂú∞Èªû</label>
                            <select id="sceneLocation" name="sceneLocation">
                                <option value="city" data-i18n="location_city">ÂüéÂ∏Ç</option>
                                <option value="beach" data-i18n="location_beach">Êµ∑ÈÇä</option>
                                <option value="mountain" data-i18n="location_mountain">Â±±ÂçÄ</option>
                                <option value="park" data-i18n="location_park">ÂÖ¨Âúí</option>
                                <option value="custom" data-i18n="location_custom">Ëá™ÂÆöÁæ©</option>
                            </select>
                            <div id="customLocationInput" style="display: none; margin-top: 10px;">
                                <input type="text" id="customLocationText" placeholder="Ë´ãËº∏ÂÖ•Â†¥ÊôØÂú∞ÈªûÊèèËø∞ (‰æãÂ¶Ç: ÂíñÂï°Âª≥„ÄÅÈÅäÊ®ÇÂ†¥„ÄÅÊ£ÆÊûóÁ≠â)" style="width: 100%; padding: 10px; border: 2px solid #e1e5e9; border-radius: 8px; font-size: 14px;" data-i18n-placeholder="custom_location_placeholder">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Â†¥ÊôØÈÅ∏ÊìáÈÅ∏È†Ö -->
                    <div class="form-group" id="scenarioOptionsGroup" style="display: none;">
                        <label data-i18n="usage_scenario_selection">‰ΩøÁî®Â†¥ÊôØÈÅ∏Êìá / Usage Scenario Selection</label>
                        <div class="checkbox-group" id="scenarioGroup">
                            <div class="checkbox-item">
                                <input type="radio" id="scenario_parent_child" name="scenarioType" value="Ë¶™Â≠ê‰∫íÂãï" checked>
                                <label for="scenario_parent_child">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ <span data-i18n="scenario_parent_child">Ë¶™Â≠ê‰∫íÂãï (Parent-Child Interaction)</span></label>
                            </div>
                            <div class="checkbox-item">
                                <input type="radio" id="scenario_child_solo" name="scenarioType" value="Â∞èÂ≠©ÂñÆ‰∫∫‰ΩøÁî®">
                                <label for="scenario_child_solo">üßí <span data-i18n="scenario_child_solo">Â∞èÂ≠©ÂñÆ‰∫∫‰ΩøÁî® (Child Solo Play)</span></label>
                            </div>
                            <div class="checkbox-item">
                                <input type="radio" id="scenario_outdoor_travel" name="scenarioType" value="Â§ñÂá∫ÊóÖÈÅä">
                                <label for="scenario_outdoor_travel">üåç <span data-i18n="scenario_outdoor_travel">Â§ñÂá∫ÊóÖÈÅä (Outdoor Travel)</span></label>
                            </div>
                            <div class="checkbox-item">
                                <input type="radio" id="scenario_home_play" name="scenarioType" value="Â±ÖÂÆ∂ÈÅäÊà≤">
                                <label for="scenario_home_play">üè† <span data-i18n="scenario_home_play">Â±ÖÂÆ∂ÈÅäÊà≤ (Home Play)</span></label>
                            </div>
                            <div class="checkbox-item">
                                <input type="radio" id="scenario_personal_styling" name="scenarioType" value="ÂÄã‰∫∫Á©øÊê≠">
                                <label for="scenario_personal_styling">üëî <span data-i18n="scenario_personal_styling">ÂÄã‰∫∫Á©øÊê≠ (Personal Styling)</span></label>
                            </div>
                            <div class="checkbox-item">
                                <input type="radio" id="scenario_office_home_decor" name="scenarioType" value="Ëæ¶ÂÖ¨ÂÆ§/Â±ÖÂÆ∂‰ΩàÁΩÆ">
                                <label for="scenario_office_home_decor">üè¢ <span data-i18n="scenario_office_home_decor">Ëæ¶ÂÖ¨ÂÆ§/Â±ÖÂÆ∂‰ΩàÁΩÆ (Office/Home Decoration)</span></label>
                            </div>
                            <div class="checkbox-item">
                                <input type="radio" id="scenario_other" name="scenarioType" value="ÂÖ∂‰ªñ">
                                <label for="scenario_other">‚ú® <span data-i18n="scenario_other">ÂÖ∂‰ªñ (Other Creative)</span></label>
                            </div>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn" id="analyzeBtn">
                        üß† <span data-i18n="analyze_generate_button">ÂàÜÊûêÁî¢ÂìÅ‰∏¶ÁîüÊàêÂÖßÂÆπ</span>
                    </button>
                    
                    <button type="button" class="btn" id="switchScenarioBtn" style="display: none; background: #28a745;">
                        üîÑ <span data-i18n="switch_scenario_button">ÂàáÊèõÂ†¥ÊôØÈáçÊñ∞ÁîüÊàê (ÂêåÁî¢ÂìÅ‰∏çÂêåÂπ≥Âè∞)</span>
                    </button>
                    
                    <button type="button" class="btn btn-secondary" id="generateScenariosBtn" style="display: none;">
                        üé¨ <span data-i18n="generate_scenarios_button">ÁîüÊàêË°åÈä∑Â†¥ÊôØ</span>
                    </button>
                </form>
                
                <div id="status" class="status"></div>
            </div>
            
            <div class="output-panel">
                <h2 class="panel-title">üìä <span data-i18n="ai_analysis_result">AI ÂàÜÊûêÁµêÊûú</span></h2>
                <div id="analysisResults">
                    <p style="text-align: center; color: #666; padding: 40px;">
                        ‰∏äÂÇ≥Áî¢ÂìÅÂúñÁâá‰∏¶ÈªûÊìäÂàÜÊûêÊåâÈàïÈñãÂßã AI Êô∫ÊÖßÂàÜÊûê
                    </p>
                </div>
            </div>
        </div>
        
        <div class="results-container" id="resultsContainer">
            <div style="background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); padding: 30px;">
                <h2 class="panel-title">üéØ Â§öÂπ≥Âè∞ÂÖßÂÆπÁîüÊàêÁµêÊûú</h2>
                <div id="platformResults"></div>
            </div>
        </div>
        
        <div class="scenarios-container" id="scenariosContainer" style="display: none;">
            <div style="background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); padding: 30px; margin-top: 30px;">
                <h2 class="panel-title">üé¨ AI ÁîüÊàêË°åÈä∑Â†¥ÊôØ</h2>
                <div id="scenarioResults"></div>
            </div>
        </div>
        </div>
        <!-- End of Page 1 -->

        <!-- Page 2: AI Âª£ÂëäÈ°ßÂïè -->
        <div id="page2" class="page-content">
            <div class="workflow-container">
                <!-- Â∑¶ÂÅ¥ÔºöË≥áÊñôËº∏ÂÖ•ÂçÄ -->
                <div class="input-panel">
                    <h2 class="panel-title">üì§ <span data-i18n="data_input_area">Ë≥áÊñôËº∏ÂÖ•ÂçÄ</span></h2>
                    
                    <form id="adsAnalysisForm">
                        <div class="form-group">
                            <label for="brandName" data-i18n="brand_name">ÂìÅÁâåÂêçÁ®± / Brand Name (ÈÅ∏Â°´)</label>
                            <input type="text" id="brandName" name="brandName" data-i18n-placeholder="brand_name_placeholder" placeholder="Ëº∏ÂÖ•ÂìÅÁâåÂêçÁ®±">
                        </div>
                        
                        <div class="form-group">
                            <label for="adProductName" data-i18n="product_name_optional">Áî¢ÂìÅÂêçÁ®± / Product Name (ÈÅ∏Â°´)</label>
                            <input type="text" id="adProductName" name="adProductName" data-i18n-placeholder="product_name_optional_placeholder" placeholder="Ëº∏ÂÖ•Áî¢ÂìÅÂêçÁ®±">
                        </div>
                        
                        <div class="form-group">
                            <label for="coreProduct" data-i18n="core_product">Ê†∏ÂøÉÁî¢ÂìÅ / Core Product (ÈÅ∏Â°´)</label>
                            <textarea id="coreProduct" name="coreProduct" data-i18n-placeholder="core_product_placeholder" placeholder="ÊèèËø∞Ê†∏ÂøÉÁî¢ÂìÅÁâπËâ≤..." rows="2"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="targetMarket" data-i18n="target_market">ÁõÆÊ®ôËàáÂ∏ÇÂ†¥ / Target Market (ÈÅ∏Â°´)</label>
                            <textarea id="targetMarket" name="targetMarket" data-i18n-placeholder="target_market_placeholder" placeholder="ÊèèËø∞ÁõÆÊ®ôÂÆ¢Áæ§ËàáÂ∏ÇÂ†¥ÂÆö‰Ωç..." rows="2"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label data-i18n="file_upload">Ê™îÊ°à‰∏äÂÇ≥ / File Upload (ÈÅ∏Â°´ÔºåÊîØÊè¥ 1-10 ÂÄãÊ™îÊ°à)</label>
                            <div class="file-upload" onclick="document.getElementById('adsFileUpload').click()">
                                <input type="file" id="adsFileUpload" accept="image/*,.pdf,.xlsx,.xls,.doc,.docx,.csv" multiple>
                                <p data-i18n="file_upload_text">üìÅ ‰∏äÂÇ≥Âª£ÂëäË≥áÊñôÊ™îÊ°à</p>
                                <small data-i18n="file_upload_hint">ÊîØÊè¥ Image, PDF, Excel, Word, CSV (ÊØèÂÄãÊ™îÊ°àÊúÄÂ§ß 10MBÔºåÊúÄÂ§ö10ÂÄãÊ™îÊ°à)</small>
                            </div>
                            <div id="adsFilePreviewContainer" class="image-preview-container"></div>
                            <div id="selectedAdsFileCount" class="selected-count" style="display: none;"></div>
                        </div>
                        
                        <div class="form-group">
                            <label data-i18n="platform_selection">Âπ≥Âè∞ÂãæÈÅ∏ / Platform Selection</label>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="platform_tiktok" name="adsPlatform" value="TikTok">
                                    <label for="platform_tiktok" data-i18n="platform_tiktok">üì± TikTok Ads</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="platform_shopee" name="adsPlatform" value="Shopee">
                                    <label for="platform_shopee" data-i18n="platform_shopee">üõçÔ∏è Shopee Ads</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="platform_meta" name="adsPlatform" value="Meta">
                                    <label for="platform_meta" data-i18n="platform_meta">üë• Meta Ads (Facebook/Instagram)</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="platform_zalo" name="adsPlatform" value="Zalo">
                                    <label for="platform_zalo" data-i18n="platform_zalo">üí¨ Zalo Ads</label>
                                </div>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn" id="analyzeAdsBtn">
                            üß† <span data-i18n="start_analysis">ÈñãÂßãÂàÜÊûê (Start Analysis)</span>
                        </button>
                    </form>
                    
                    <div id="adsStatus" class="status"></div>
                    
                    <!-- AI Âª£ÂëäÈ°ßÂïèÂ∞çË©±Ë¶ñÁ™ó -->
                    <div class="chat-advisor-container" id="chatAdvisorContainer">
                        <div class="chat-header">
                            üí¨ <span data-i18n="chat_advisor_title">AI Âª£ÂëäÈ°ßÂïèÂ∞çË©±</span>
                        </div>
                        
                        <!-- Âª∫Ë≠∞ÂïèÈ°åÂçÄ -->
                        <div class="suggested-questions" id="suggestedQuestions" style="display: none;">
                            <h4 data-i18n="ai_suggested_questions">AI Âª∫Ë≠∞ÁöÑÂïèÈ°åÔºö</h4>
                            <div id="suggestedQuestionsList"></div>
                        </div>
                        
                        <!-- Â∞çË©±Ë®äÊÅØÂçÄ -->
                        <div class="chat-messages" id="chatMessages">
                            <div class="chat-message ai">
                                <div class="chat-message-avatar">ü§ñ</div>
                                <div class="chat-message-content">
                                    ÊÇ®Â•ΩÔºÅÊàëÊòØÊÇ®ÁöÑ AI Âª£ÂëäÈ°ßÂïè„ÄÇÂÆåÊàêÂª£ÂëäÂàÜÊûêÂæåÔºåÊàëÊúÉÁÇ∫ÊÇ®Êèê‰æõ‰∏âÂÄãÂ∞àÊ•≠ÂïèÈ°åÂπ´Âä©ÊÇ®Ê∑±ÂÖ•ÊÄùËÄÉÔºåÊÇ®‰πüÂèØ‰ª•Èö®ÊôÇÂêëÊàëÊèêÂïèÊàñ‰∏äÂÇ≥Êõ¥Â§öË≥áÊñôÈÄ≤Ë°åÂàÜÊûê„ÄÇ
                                </div>
                            </div>
                        </div>
                        
                        <!-- Â∞çË©±Ëº∏ÂÖ•ÂçÄ -->
                        <div class="chat-input-area">
                            <div class="chat-input-wrapper">
                                <div class="chat-file-preview" id="chatFilePreview"></div>
                                <textarea 
                                    class="chat-input" 
                                    id="chatInput" 
                                    placeholder="Ëº∏ÂÖ•ÊÇ®ÁöÑÂïèÈ°å..." 
                                    rows="1"
                                    data-i18n-placeholder="chat_placeholder"
                                ></textarea>
                                <input type="file" id="chatFileUpload" accept="image/*,.pdf,.xlsx,.xls,.doc,.docx,.csv" multiple style="display: none;">
                                <button class="chat-file-upload-btn" onclick="document.getElementById('chatFileUpload').click()" title="‰∏äÂÇ≥Ê™îÊ°à">
                                    üìé
                                </button>
                            </div>
                            <button class="chat-send-btn" id="chatSendBtn" onclick="sendChatMessage()">
                                ‚û§
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Âè≥ÂÅ¥ÔºöAI ÂàÜÊûêÁµêÊûúÂçÄ -->
                <div class="output-panel">
                    <h2 class="panel-title">ü§ñ <span data-i18n="ai_analysis_results_area">AI ÂàÜÊûêÁµêÊûúÂçÄ</span></h2>
                    <div id="adsAnalysisResults">
                        <p style="text-align: center; color: #666; padding: 40px;">
                            ‰∏äÂÇ≥Âª£ÂëäË≥áÊñô‰∏¶ÈªûÊìäÂàÜÊûêÊåâÈàïÈñãÂßã AI Êô∫ÊÖßÂàÜÊûê
                        </p>
                    </div>
                    
                    <!-- Â†±ÂëäÊìç‰ΩúÊåâÈàï -->
                    <div id="reportActions" style="display: none; margin-top: 20px; text-align: center; gap: 10px;">
                        <button class="btn" onclick="exportPDF()" style="background: #28a745;">
                            üìÑ ÂåØÂá∫ PDF
                        </button>
                        <button class="btn btn-secondary" onclick="reanalyze()">
                            üîÑ ÈáçÊñ∞ÂàÜÊûê
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!-- End of Page 2 -->

        <!-- Page 3: AI Ë™≤Á®ãÁ∑®ËºØÂ∞àÂÆ∂ -->
        <div id="page3" class="page-content">
            <div class="workflow-container">
                <!-- Â∑¶ÂÅ¥ÔºöË™≤Á®ãÂèÉÊï∏Ë®≠ÂÆö -->
                <div class="input-panel">
                    <h2 class="panel-title">üìö <span data-i18n="course_parameters">Ë™≤Á®ãÂèÉÊï∏Ë®≠ÂÆö</span></h2>
                    
                    <form id="courseForm">
                        <!-- 1. ÁõÆÊ®ôÂπ¥ÈΩ° -->
                        <div class="form-group">
                            <label for="targetAge" data-i18n="target_age">ÁõÆÊ®ôÂπ¥ÈΩ°</label>
                            <select id="targetAge" name="targetAge" onchange="handleAgeChange()" required>
                                <option value="3-5">3-5 Ê≠≤</option>
                                <option value="6-8">6-8 Ê≠≤</option>
                                <option value="9-11">9-11 Ê≠≤</option>
                                <option value="12-14">12-14 Ê≠≤</option>
                                <option value="custom">Ëá™ÂÆöÁæ© (Custom)</option>
                            </select>
                            <input type="number" id="customAgeText" style="display: none; margin-top: 10px;" placeholder="Ë´ãËº∏ÂÖ•Âπ¥ÈΩ°Êï∏Â≠ó" min="1" max="18">
                        </div>

                        <!-- 2. Ë™≤Á®ãÈ°ûÂà• -->
                        <div class="form-group">
                            <label for="category" data-i18n="category">Ë™≤Á®ãÈ°ûÂà•</label>
                            <select id="category" name="category" onchange="updateTopicOptions(); handleCategoryChange()" required>
                                <option value="social">Á§æÊúÉ Social</option>
                                <option value="science">Ëá™ÁÑ∂ Science</option>
                                <option value="math">Êï∏Â≠∏ Math</option>
                                <option value="language">Ë™ûÊñá Language</option>
                                <option value="art">ËóùË°ì Art</option>
                                <option value="custom">Ëá™ÂÆöÁæ© (Custom)</option>
                            </select>
                            <input type="text" id="customCategoryText" style="display: none; margin-top: 10px;" placeholder="Ë´ãËº∏ÂÖ•Ëá™ÂÆöÁæ©ÁßëÂà•">
                        </div>

                        <!-- 3. Ë™≤Á®ã‰∏ªÈ°å -->
                        <div class="form-group">
                            <label for="topic" data-i18n="topic">Ë™≤Á®ã‰∏ªÈ°å</label>
                            <select id="topic" name="topic" onchange="handleTopicChange()" required>
                                <option value="ÂÆ∂Â∫≠">ÂÆ∂Â∫≠</option>
                                <option value="‰∫§ÈÄöÂ∑•ÂÖ∑">‰∫§ÈÄöÂ∑•ÂÖ∑</option>
                                <option value="Á§æÊúÉËßíËâ≤">Á§æÊúÉËßíËâ≤</option>
                                <option value="ÊñáÂåñÁØÄÊó•">ÊñáÂåñÁØÄÊó•</option>
                                <option value="ÂÆâÂÖ®ÊïôËÇ≤">ÂÆâÂÖ®ÊïôËÇ≤</option>
                                <option value="custom">Ëá™ÂÆöÁæ© (Custom)</option>
                            </select>
                            <input type="text" id="customTopicText" style="display: none; margin-top: 10px;" placeholder="Ë´ãËº∏ÂÖ•Ëá™ÂÆöÁæ©‰∏ªÈ°å">
                        </div>

                        <!-- 4. Ë™≤Á®ãÊôÇÈï∑ -->
                        <div class="form-group">
                            <label for="duration" data-i18n="duration">Ë™≤Á®ãÊôÇÈï∑</label>
                            <select id="duration" name="duration" onchange="handleDurationChange()" required>
                                <option value="30">30 ÂàÜÈêò</option>
                                <option value="60">60 ÂàÜÈêò</option>
                                <option value="90">90 ÂàÜÈêò</option>
                                <option value="custom">Ëá™ÂÆöÁæ© (Custom)</option>
                            </select>
                            <input type="number" id="customDurationText" style="display: none; margin-top: 10px;" placeholder="Ë´ãËº∏ÂÖ•ÊôÇÈñì (ÂàÜÈêò)" min="10" max="240">
                        </div>

                        <!-- 5. ÊïôÂ≠∏È¢®Ê†º -->
                        <div class="form-group">
                            <label for="style" data-i18n="style">ÊïôÂ≠∏È¢®Ê†º</label>
                            <select id="style" name="style" onchange="handleStyleChange()" required>
                                <option value="story-based">ÊïÖ‰∫ãÂºïÂ∞éÂºè Story-based</option>
                                <option value="picture-book">ÊèíÁï´Áπ™Êú¨È¢® Picture-book</option>
                                <option value="singapore-style">ÊÄùËæ®Âºè Singapore-style</option>
                                <option value="gamified">ÈÅäÊà≤Âåñ Gamified</option>
                                <option value="montessori">Montessori ËíôÂºè</option>
                                <option value="custom">Ëá™ÂÆöÁæ© (Custom)</option>
                            </select>
                            <input type="text" id="customStyleText" style="display: none; margin-top: 10px;" placeholder="Ë´ãËº∏ÂÖ•Ëá™ÂÆöÁæ©È¢®Ê†º">
                        </div>

                        <!-- 6. Ëº∏Âá∫Ê†ºÂºè (Â§öÈÅ∏) -->
                        <div class="form-group">
                            <label data-i18n="output_types">Ëº∏Âá∫Ê†ºÂºè (ÂèØÂ§öÈÅ∏)</label>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="outline" name="outputTypes" value="outline" checked>
                                    <label for="outline">üìã Ë™≤Á∂± Outline</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="lessonPlan" name="outputTypes" value="lessonPlan">
                                    <label for="lessonPlan">üìù ÊïôÊ°à Lesson Plan</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="story" name="outputTypes" value="story">
                                    <label for="story">üìñ ÊïÖ‰∫ã Story-based Content</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="worksheet" name="outputTypes" value="worksheet">
                                    <label for="worksheet">‚úèÔ∏è Worksheet Á∑¥ÁøíÈ°å</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="slides" name="outputTypes" value="slides">
                                    <label for="slides">üñºÔ∏è Slides (PPT Script)</label>
                                </div>
                            </div>
                        </div>

                        <!-- 7. ÂÖßÂÆπË™ûË®Ä -->
                        <div class="form-group">
                            <label for="courseLanguage" data-i18n="course_language">ÂÖßÂÆπË™ûË®Ä</label>
                            <select id="courseLanguage" name="courseLanguage" required>
                                <option value="chinese">‰∏≠Êñá Chinese</option>
                                <option value="english">Ëã±Êñá English</option>
                                <option value="vietnamese">Ë∂äÊñá Vietnamese</option>
                                <option value="chinese-english">‰∏≠Ëã±ÈõôË™û Chinese-English</option>
                                <option value="english-vietnamese">Ëã±Ë∂äÈõôË™û English-Vietnamese</option>
                                <option value="trilingual">‰∏âË™ûÁâà Trilingual (‰∏≠Ëã±Ë∂ä)</option>
                            </select>
                        </div>

                        <!-- 8. AI ÊèíÂúñÁîüÊàê -->
                        <div class="form-group">
                            <label for="includeImages" data-i18n="include_images">AI ÊèíÂúñÁîüÊàê</label>
                            <select id="includeImages" name="includeImages" required>
                                <option value="yes">ÊòØ Yes (‰ΩøÁî® Nano Banana)</option>
                                <option value="no" selected>Âê¶ No</option>
                            </select>
                        </div>

                        <!-- ÁîüÊàêÊåâÈàï -->
                        <button type="button" class="btn" id="generateCourseBtn" onclick="generateCourse()">
                            üéì <span data-i18n="generate_course_btn">ÁîüÊàêË™≤Á®ãÂÖßÂÆπ</span>
                        </button>
                    </form>
                </div>

                <!-- Âè≥ÂÅ¥ÔºöË™≤Á®ãÈ†êË¶ΩËàá‰∏ãËºâ -->
                <div class="output-panel">
                    <h2 class="panel-title">üìñ <span data-i18n="course_preview">Ë™≤Á®ãÂÖßÂÆπÈ†êË¶Ω</span></h2>
                    
                    <div id="coursePreview" style="max-height: 600px; overflow-y: auto; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                        <p style="text-align: center; color: #666; padding: 40px;">
                            ÈÅ∏ÊìáË™≤Á®ãÂèÉÊï∏‰∏¶ÈªûÊìäÁîüÊàêÊåâÈàïÈñãÂßã AI Ë™≤Á®ãÁ∑®ËºØ
                        </p>
                    </div>

                    <!-- ‰∏ãËºâÊåâÈàïÂçÄÂüü -->
                    <div id="downloadActions" style="display: none; margin-top: 20px; text-align: center; gap: 10px;">
                        <button class="btn" onclick="downloadWord()" style="background: #2b579a;">
                            üìÑ <span data-i18n="download_word">‰∏ãËºâ Word</span>
                        </button>
                        <button class="btn" onclick="downloadPDF()" style="background: #d32f2f;">
                            üìï <span data-i18n="download_pdf">‰∏ãËºâ PDF</span>
                        </button>
                    </div>

                    <!-- ÁãÄÊÖãÈ°ØÁ§∫ -->
                    <div id="courseStatus" style="margin-top: 15px; padding: 10px; border-radius: 5px; display: none;"></div>
                </div>
            </div>
        </div>
        <!-- End of Page 3 -->

        <!-- Page 4: BizPrompt Architect Pro (AI Êåá‰ª§Êû∂ÊßãÂ∏´) -->
        <div id="page4" class="page-content">
            <div class="workflow-container" style="grid-template-columns: 1fr 1fr;">
                <!-- Â∑¶ÂÅ¥ÔºöËº∏ÂÖ•ÂçÄÂüü -->
                <div class="input-panel">
                    <h2 class="panel-title">üìù <span data-i18n="prompt_architect_title">BizPrompt Architect Pro</span></h2>
                    <p style="color: #666; margin-bottom: 20px;" data-i18n="prompt_architect_subtitle">ÂÖ®Êñπ‰Ωç AI Êåá‰ª§Êû∂ÊßãÂ∏´ - ËÆìÊÇ®Áî¢Âá∫Â∞àÂÆ∂Á¥ö Prompt</p>
                    
                    <!-- ‰∏âÊÖãÂàáÊèõÁ≥ªÁµ± -->
                    <div class="mode-tabs" style="display: flex; gap: 10px; margin-bottom: 25px; flex-wrap: wrap;">
                        <button type="button" class="mode-tab active" onclick="switchPromptMode('business')" id="modeTabBusiness" style="flex: 1; min-width: 100px; padding: 12px 15px; border: 2px solid #87CEEB; background: linear-gradient(135deg, #87CEEB 0%, #FFB6C1 100%); color: white; border-radius: 10px; cursor: pointer; font-weight: 600; transition: all 0.3s;">
                            üë®‚Äçüíº ÂïÜÊ•≠È°ßÂïè
                        </button>
                        <button type="button" class="mode-tab" onclick="switchPromptMode('coding')" id="modeTabCoding" style="flex: 1; min-width: 100px; padding: 12px 15px; border: 2px solid #87CEEB; background: white; color: #87CEEB; border-radius: 10px; cursor: pointer; font-weight: 600; transition: all 0.3s;">
                            üíª ËªüÈ´îÈñãÁôº
                        </button>
                        <button type="button" class="mode-tab" onclick="switchPromptMode('image')" id="modeTabImage" style="flex: 1; min-width: 100px; padding: 12px 15px; border: 2px solid #87CEEB; background: white; color: #87CEEB; border-radius: 10px; cursor: pointer; font-weight: 600; transition: all 0.3s;">
                            üé® Ë¶ñË¶∫Áπ™Âúñ
                        </button>
                    </div>

                    <!-- ==================== ÂïÜÊ•≠È°ßÂïèÊ®°Âºè ==================== -->
                    <div id="businessMode" class="prompt-mode active" style="display: block;">
                        <form id="businessPromptForm">
                            <!-- L1: È†òÂüüÈÅ∏Êìá -->
                            <div class="form-group">
                                <label for="bizDomain">üè¢ L1 È†òÂüü (Domain)</label>
                                <select id="bizDomain" onchange="updateBizIndustry()" required style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;">
                                    <option value="">-- Ë´ãÈÅ∏ÊìáÈ†òÂüü --</option>
                                    <option value="marketing">Â∏ÇÂ†¥Ë°åÈä∑ Marketing</option>
                                    <option value="strategy">‰ºÅÊ•≠Êà∞Áï• Strategy</option>
                                    <option value="sales">Ê•≠ÂãôÈä∑ÂîÆ Sales</option>
                                    <option value="product">Áî¢ÂìÅÁÆ°ÁêÜ Product</option>
                                    <option value="finance">Ë≤°ÂãôÂàÜÊûê Finance</option>
                                    <option value="hr">‰∫∫ÂäõË≥áÊ∫ê HR</option>
                                    <option value="custom">‚ûï Ëá™ÂÆöÁæ© Custom</option>
                                </select>
                                <input type="text" id="bizDomainCustom" placeholder="Ëº∏ÂÖ•Ëá™ÂÆöÁæ©È†òÂüü..." style="display: none; margin-top: 10px; width: 100%; padding: 12px; border: 2px solid #87CEEB; border-radius: 8px;">
                            </div>

                            <!-- L2: Ë°åÊ•≠ÈÅ∏Êìá -->
                            <div class="form-group">
                                <label for="bizIndustry">üè≠ L2 Ë≥ΩÈÅì (Industry)</label>
                                <select id="bizIndustry" onchange="updateBizRole()" required style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;">
                                    <option value="">-- Ë´ãÂÖàÈÅ∏ÊìáÈ†òÂüü --</option>
                                </select>
                                <input type="text" id="bizIndustryCustom" placeholder="Ëº∏ÂÖ•Ëá™ÂÆöÁæ©Ë°åÊ•≠..." style="display: none; margin-top: 10px; width: 100%; padding: 12px; border: 2px solid #87CEEB; border-radius: 8px;">
                            </div>

                            <!-- L3: ËßíËâ≤ÈÅ∏Êìá -->
                            <div class="form-group">
                                <label for="bizRole">üë§ L3 ËßíËâ≤ (Role)</label>
                                <select id="bizRole" onchange="updateBizFramework()" required style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;">
                                    <option value="">-- Ë´ãÂÖàÈÅ∏ÊìáË°åÊ•≠ --</option>
                                </select>
                                <input type="text" id="bizRoleCustom" placeholder="Ëº∏ÂÖ•Ëá™ÂÆöÁæ©ËßíËâ≤..." style="display: none; margin-top: 10px; width: 100%; padding: 12px; border: 2px solid #87CEEB; border-radius: 8px;">
                            </div>

                            <!-- L4: Ê®°Âûã/Ê°ÜÊû∂ÈÅ∏Êìá -->
                            <div class="form-group">
                                <label for="bizFramework">üß† L4 Ê®°Âûã (Framework)</label>
                                <select id="bizFramework" onchange="handleFrameworkChange()" required style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;">
                                    <option value="">-- Ë´ãÂÖàÈÅ∏ÊìáËßíËâ≤ --</option>
                                </select>
                                <input type="text" id="bizFrameworkCustom" placeholder="Ëº∏ÂÖ•Ëá™ÂÆöÁæ©Ê®°Âûã/Ê°ÜÊû∂..." style="display: none; margin-top: 10px; width: 100%; padding: 12px; border: 2px solid #87CEEB; border-radius: 8px;">
                            </div>

                            <!-- ÂÖ∑È´î‰ªªÂãôËº∏ÂÖ• -->
                            <div class="form-group">
                                <label for="bizContext">üìã ÂÖ∑È´î‰ªªÂãôÊèèËø∞ (Context)</label>
                                <textarea id="bizContext" rows="4" placeholder="ÊèèËø∞ÊÇ®ÊÉ≥Ëß£Ê±∫ÁöÑÂïÜÊ•≠ÂïèÈ°åÊàñ‰ªªÂãôÁõÆÊ®ô..." style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px; resize: vertical;"></textarea>
                            </div>

                            <button type="button" id="bizGenerateBtn" class="btn" onclick="generateBusinessPrompt()" style="width: 100%; padding: 15px; background: linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%); color: white; border: none; border-radius: 10px; font-size: 16px; font-weight: 600; cursor: pointer;">
                                üöÄ ÁîüÊàêÂ∞àÊ•≠ Prompt
                            </button>
                        </form>
                    </div>

                    <!-- ==================== ËªüÈ´îÈñãÁôºÊ®°Âºè ==================== -->
                    <div id="codingMode" class="prompt-mode" style="display: none;">
                        <form id="codingPromptForm">
                            <div class="form-group">
                                <label for="codingInput">üíª ÊèèËø∞ÊÇ®ÁöÑËªüÈ´îÈúÄÊ±Ç</label>
                                <p style="color: #888; font-size: 13px; margin-bottom: 10px;">‰æãÂ¶ÇÔºö„ÄåÂÅö‰∏ÄÂÄãÂÉè Uber ÁöÑ App„Äç„ÄÅ„ÄåÊàëÈúÄË¶Å‰∏ÄÂÄãÈõªÂïÜÁ∂≤Á´ôÂæåÂè∞ÁÆ°ÁêÜÁ≥ªÁµ±„Äç</p>
                                <textarea id="codingInput" rows="6" placeholder="Áî®Ëá™ÁÑ∂Ë™ûË®ÄÊèèËø∞ÊÇ®ÊÉ≥ÈñãÁôºÁöÑËªüÈ´îÂäüËÉΩ..." style="width: 100%; padding: 15px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px; resize: vertical;"></textarea>
                            </div>

                            <!-- ÂèÉËÄÉË≥áÊñô‰∏äÂÇ≥ÂçÄ -->
                            <div class="form-group" style="background: linear-gradient(135deg, rgba(33, 150, 243, 0.05) 0%, rgba(3, 169, 244, 0.05) 100%); padding: 15px; border-radius: 10px; border: 1px dashed #2196F3;">
                                <label style="color: #1976D2; font-size: 14px; margin-bottom: 10px; display: block;" data-i18n="ref_upload_label">üìé ÂèÉËÄÉË≥áÊñô (ÈÅ∏Â°´)</label>
                                <p style="color: #888; font-size: 12px; margin-bottom: 12px;" data-i18n="ref_upload_hint">‰∏äÂÇ≥ÂèÉËÄÉÂúñÁâá„ÄÅÊñá‰ª∂ÊàñË≤º‰∏äÁ∂≤ÂùÄÔºåAI Â∞áÂàÜÊûêÂæåÁîüÊàêÊõ¥Á≤æÊ∫ñÁöÑÊèêÁ§∫Ë©û</p>
                                
                                <!-- ‰∏äÂÇ≥ÂçÄÂüü -->
                                <div id="codingUploadZone" class="upload-drop-zone" 
                                     ondragover="handleDragOver(event, 'coding')" 
                                     ondragleave="handleDragLeave(event, 'coding')" 
                                     ondrop="handleDrop(event, 'coding')"
                                     style="border: 2px dashed #90CAF9; border-radius: 10px; padding: 20px; text-align: center; background: #fff; transition: all 0.3s; cursor: pointer;"
                                     onclick="document.getElementById('codingFileInput').click()">
                                    <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                                        <span style="font-size: 32px;">üìÅ</span>
                                        <span style="color: #666; font-size: 13px;" data-i18n="ref_drop_hint">ÊãñÊîæÊ™îÊ°àÂà∞Ê≠§ËôïÔºåÊàñÈªûÊìä‰∏äÂÇ≥</span>
                                        <div style="display: flex; gap: 8px; flex-wrap: wrap; justify-content: center;">
                                            <span style="background: #E3F2FD; color: #1976D2; padding: 3px 8px; border-radius: 12px; font-size: 11px;">üñºÔ∏è ÂúñÁâá</span>
                                            <span style="background: #E8F5E9; color: #388E3C; padding: 3px 8px; border-radius: 12px; font-size: 11px;">üìÑ PDF</span>
                                            <span style="background: #FFF3E0; color: #F57C00; padding: 3px 8px; border-radius: 12px; font-size: 11px;">üìä Excel</span>
                                            <span style="background: #E3F2FD; color: #1565C0; padding: 3px 8px; border-radius: 12px; font-size: 11px;">üìù Word</span>
                                            <span style="background: #FCE4EC; color: #C2185B; padding: 3px 8px; border-radius: 12px; font-size: 11px;">üìΩÔ∏è PPT</span>
                                            <span style="background: #F3E5F5; color: #7B1FA2; padding: 3px 8px; border-radius: 12px; font-size: 11px;">üìã MD</span>
                                        </div>
                                    </div>
                                    <input type="file" id="codingFileInput" multiple accept="image/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.md,.txt" style="display: none;" onchange="handleFileSelect(event, 'coding')">
                                </div>
                                
                                <!-- Á∂≤ÂùÄËº∏ÂÖ• -->
                                <div style="margin-top: 12px; display: flex; gap: 8px;">
                                    <input type="text" id="codingUrlInput" placeholder="Ë≤º‰∏äÂèÉËÄÉÁ∂≤ÂùÄ (‰æãÂ¶Ç: https://example.com)..." style="flex: 1; padding: 10px 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 13px;" data-i18n-placeholder="ref_url_placeholder">
                                    <button type="button" onclick="addUrlReference('coding')" style="padding: 10px 15px; background: #2196F3; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 13px;">
                                        üîó <span data-i18n="ref_add_url">Âä†ÂÖ•</span>
                                    </button>
                                </div>
                                
                                <!-- Â∑≤‰∏äÂÇ≥È†ÖÁõÆÈ†êË¶Ω -->
                                <div id="codingUploadedItems" style="margin-top: 12px; display: none;">
                                    <div style="font-size: 12px; color: #666; margin-bottom: 8px;" data-i18n="ref_uploaded_items">üìã Â∑≤Âä†ÂÖ•ÁöÑÂèÉËÄÉË≥áÊñôÔºö</div>
                                    <div id="codingUploadedList" style="display: flex; flex-wrap: wrap; gap: 8px;"></div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="codingPlatform">üéØ ÁõÆÊ®ôÂπ≥Âè∞</label>
                                <select id="codingPlatform" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;">
                                    <option value="web">Web Á∂≤È†ÅÊáâÁî®</option>
                                    <option value="mobile">Mobile App</option>
                                    <option value="desktop">Desktop Ê°åÈù¢ÊáâÁî®</option>
                                    <option value="api">API / Backend</option>
                                    <option value="fullstack">Full Stack ÂÖ®Á´Ø</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="codingComplexity">üìä Ë§áÈõúÂ∫¶</label>
                                <select id="codingComplexity" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;">
                                    <option value="mvp">MVP ÊúÄÂ∞èÂèØË°åÁî¢ÂìÅ</option>
                                    <option value="standard">Standard Ê®ôÊ∫ñÂäüËÉΩ</option>
                                    <option value="enterprise">Enterprise ‰ºÅÊ•≠Á¥ö</option>
                                </select>
                            </div>

                            <button type="button" class="btn" onclick="generateCodingPrompt()" id="codingGenerateBtn" style="width: 100%; padding: 15px; background: linear-gradient(135deg, #2196F3 0%, #03A9F4 100%); color: white; border: none; border-radius: 10px; font-size: 16px; font-weight: 600; cursor: pointer;">
                                ü§ñ AI ËΩâË≠ØÁÇ∫ÁµêÊßãÂåñ PRD
                            </button>
                        </form>
                    </div>

                    <!-- ==================== Ë¶ñË¶∫Áπ™ÂúñÊ®°Âºè ==================== -->
                    <div id="imageMode" class="prompt-mode" style="display: none;">
                        <form id="imagePromptForm">
                            <div class="form-group">
                                <label for="imageInput" data-i18n="img_desc_label">üé® ÊèèËø∞ÊÇ®ÊÉ≥ÁîüÊàêÁöÑÁï´Èù¢</label>
                                <p style="color: #888; font-size: 13px; margin-bottom: 10px;" data-i18n="img_desc_hint">‰æãÂ¶ÇÔºö„ÄåÂ§™Á©∫‰∏≠ÁöÑË≤ì„Äç„ÄÅ„ÄåÊó•ËêΩÊôÇÂàÜÁöÑÊµ∑ÈÇäÂíñÂï°Âª≥„Äç„ÄÅ„ÄåÊú™‰æÜÂüéÂ∏ÇÁöÑÈúìËôπË°óÊôØ„Äç</p>
                                <textarea id="imageInput" rows="5" data-i18n-placeholder="img_desc_placeholder" placeholder="Áî®Ëá™ÁÑ∂Ë™ûË®ÄÊèèËø∞ÊÇ®ÊÉ≥Ë¶ÅÁöÑÁï´Èù¢..." style="width: 100%; padding: 15px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px; resize: vertical;"></textarea>
                            </div>

                            <!-- ÂèÉËÄÉË≥áÊñô‰∏äÂÇ≥ÂçÄ -->
                            <div class="form-group" style="background: linear-gradient(135deg, rgba(156, 39, 176, 0.05) 0%, rgba(233, 30, 99, 0.05) 100%); padding: 15px; border-radius: 10px; border: 1px dashed #9C27B0;">
                                <label style="color: #7B1FA2; font-size: 14px; margin-bottom: 10px; display: block;" data-i18n="ref_upload_label">üìé ÂèÉËÄÉË≥áÊñô (ÈÅ∏Â°´)</label>
                                <p style="color: #888; font-size: 12px; margin-bottom: 12px;" data-i18n="ref_upload_hint_image">‰∏äÂÇ≥ÂèÉËÄÉÂúñÁâáÊàñË≤º‰∏äÁ∂≤ÂùÄÔºåAI Â∞áÂàÜÊûêÈ¢®Ê†º/ÊßãÂúñÂæåÁîüÊàêÊõ¥Á≤æÊ∫ñÁöÑÊèêÁ§∫Ë©û</p>
                                
                                <!-- ‰∏äÂÇ≥ÂçÄÂüü -->
                                <div id="imageUploadZone" class="upload-drop-zone" 
                                     ondragover="handleDragOver(event, 'image')" 
                                     ondragleave="handleDragLeave(event, 'image')" 
                                     ondrop="handleDrop(event, 'image')"
                                     style="border: 2px dashed #CE93D8; border-radius: 10px; padding: 20px; text-align: center; background: #fff; transition: all 0.3s; cursor: pointer;"
                                     onclick="document.getElementById('imageFileInput').click()">
                                    <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                                        <span style="font-size: 32px;">üñºÔ∏è</span>
                                        <span style="color: #666; font-size: 13px;" data-i18n="ref_drop_hint">ÊãñÊîæÊ™îÊ°àÂà∞Ê≠§ËôïÔºåÊàñÈªûÊìä‰∏äÂÇ≥</span>
                                        <div style="display: flex; gap: 8px; flex-wrap: wrap; justify-content: center;">
                                            <span style="background: #F3E5F5; color: #7B1FA2; padding: 3px 8px; border-radius: 12px; font-size: 11px;">üñºÔ∏è JPG/PNG</span>
                                            <span style="background: #FCE4EC; color: #C2185B; padding: 3px 8px; border-radius: 12px; font-size: 11px;">üé® WEBP/GIF</span>
                                            <span style="background: #E8F5E9; color: #388E3C; padding: 3px 8px; border-radius: 12px; font-size: 11px;">üìÑ PDF</span>
                                            <span style="background: #E3F2FD; color: #1976D2; padding: 3px 8px; border-radius: 12px; font-size: 11px;">üìù Êñá‰ª∂</span>
                                        </div>
                                    </div>
                                    <input type="file" id="imageFileInput" multiple accept="image/*,.pdf,.doc,.docx,.md,.txt" style="display: none;" onchange="handleFileSelect(event, 'image')">
                                </div>
                                
                                <!-- Á∂≤ÂùÄËº∏ÂÖ• -->
                                <div style="margin-top: 12px; display: flex; gap: 8px;">
                                    <input type="text" id="imageUrlInput" placeholder="Ë≤º‰∏äÂèÉËÄÉÂúñÁâáÁ∂≤ÂùÄ (‰æãÂ¶Ç: https://example.com/image.jpg)..." style="flex: 1; padding: 10px 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 13px;" data-i18n-placeholder="ref_url_placeholder_image">
                                    <button type="button" onclick="addUrlReference('image')" style="padding: 10px 15px; background: #9C27B0; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 13px;">
                                        üîó <span data-i18n="ref_add_url">Âä†ÂÖ•</span>
                                    </button>
                                </div>
                                
                                <!-- Â∑≤‰∏äÂÇ≥È†ÖÁõÆÈ†êË¶Ω -->
                                <div id="imageUploadedItems" style="margin-top: 12px; display: none;">
                                    <div style="font-size: 12px; color: #666; margin-bottom: 8px;" data-i18n="ref_uploaded_items">üìã Â∑≤Âä†ÂÖ•ÁöÑÂèÉËÄÉË≥áÊñôÔºö</div>
                                    <div id="imageUploadedList" style="display: flex; flex-wrap: wrap; gap: 8px;"></div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="imageModel" data-i18n="img_model_label">ü§ñ ÁõÆÊ®ôÂúñÂÉèÊ®°Âûã</label>
                                <p style="color: #888; font-size: 13px; margin-bottom: 10px;" data-i18n="img_model_hint">ÈÅ∏ÊìáÊÇ®Ë¶Å‰ΩøÁî®ÁöÑ AI Áπ™ÂúñÂπ≥Âè∞ÔºåÁ≥ªÁµ±ÊúÉÁîüÊàêË©≤Âπ≥Âè∞Â∞àÂ±¨Ê†ºÂºèÁöÑÊèêÁ§∫Ë©û</p>
                                <select id="imageModel" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;" onchange="toggleCustomModelInput()">
                                    <option value="nanobanana" data-i18n="img_model_nanobanana">Nano Banana (FLUX)</option>
                                    <option value="gpt" data-i18n="img_model_gpt">GPT (DALL-E 3)</option>
                                    <option value="midjourney" data-i18n="img_model_mj">Midjourney (MJ)</option>
                                    <option value="custom" data-i18n="img_model_custom">Ëá™ÂÆöÁæ© Custom</option>
                                </select>
                                <input type="text" id="customModelName" data-i18n-placeholder="img_model_custom_placeholder" placeholder="Ëº∏ÂÖ•Ëá™ÂÆöÁæ©Ê®°ÂûãÂêçÁ®±ÊàñÂπ≥Âè∞..." style="display: none; margin-top: 10px; width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;">
                            </div>

                            <div class="form-group">
                                <label for="imageStyle" data-i18n="img_style_label">üñºÔ∏è ËóùË°ìÈ¢®Ê†º</label>
                                <select id="imageStyle" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;">
                                    <option value="photorealistic">ÂØ´ÂØ¶ÊîùÂΩ± Photorealistic</option>
                                    <option value="anime">ÂãïÊº´È¢®Ê†º Anime</option>
                                    <option value="oil-painting">Ê≤πÁï´È¢®Ê†º Oil Painting</option>
                                    <option value="watercolor">Ê∞¥ÂΩ©È¢®Ê†º Watercolor</option>
                                    <option value="3d-render">3D Ê∏≤Êüì 3D Render</option>
                                    <option value="cyberpunk">Ë≥ΩÂçöÈæêÂÖã Cyberpunk</option>
                                    <option value="minimalist">Ê•µÁ∞°È¢®Ê†º Minimalist</option>
                                    <option value="fantasy">Â•áÂπªÈ¢®Ê†º Fantasy</option>
                                    <option value="vintage">Âæ©Âè§È¢®Ê†º Vintage</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="imageRatio">üìê Áï´Èù¢ÊØî‰æã</label>
                                <select id="imageRatio" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;">
                                    <option value="1:1">1:1 (Ê≠£ÊñπÂΩ¢ - Instagram)</option>
                                    <option value="16:9">16:9 (ÂØ¨Ëû¢Âπï - YouTube)</option>
                                    <option value="9:16">9:16 (Áõ¥Âºè - Stories/Reels)</option>
                                    <option value="4:3">4:3 (ÂÇ≥Áµ±ÊØî‰æã)</option>
                                    <option value="3:2">3:2 (ÊîùÂΩ±Ê®ôÊ∫ñ)</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="imageQuality">‚ú® ÂìÅË≥™Ê®ôÁ±§</label>
                                <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 8px;">
                                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                        <input type="checkbox" id="imgQualityHD" checked> HD È´òÁï´Ë≥™
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                        <input type="checkbox" id="imgQuality8K"> 8K Ë∂ÖÈ´òÊ∏Ö
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                        <input type="checkbox" id="imgQualityDetail" checked> È´òÁ¥∞ÁØÄ
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                        <input type="checkbox" id="imgQualityLighting"> Â∞àÊ•≠ÂÖâÂΩ±
                                    </label>
                                </div>
                            </div>

                            <!-- ÈÄ≤ÈöéÈÅ∏È†ÖÂçÄÂ°ä -->
                            <div class="form-group" style="background: linear-gradient(135deg, rgba(156, 39, 176, 0.05) 0%, rgba(233, 30, 99, 0.05) 100%); padding: 15px; border-radius: 10px; border: 1px dashed #ccc;">
                                <label style="color: #666; font-size: 14px; margin-bottom: 12px; display: block;" data-i18n="img_advanced_options">‚öôÔ∏è ÈÄ≤ÈöéÈÅ∏È†Ö (ÈÅ∏Â°´)</label>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                    <!-- Áï´Êï∏/Ëø≠‰ª£Ê≠•Êï∏ -->
                                    <div>
                                        <label for="imageSteps" style="font-size: 13px; color: #555; margin-bottom: 5px; display: block;" data-i18n="img_steps_label">üîÑ Áï´Êï∏ Steps</label>
                                        <select id="imageSteps" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 13px;">
                                            <option value="" data-i18n="img_steps_default">È†êË®≠ (‰∏çÊåáÂÆö)</option>
                                            <option value="20">20 Ê≠• (Âø´ÈÄü)</option>
                                            <option value="30">30 Ê≠• (Ê®ôÊ∫ñ)</option>
                                            <option value="50">50 Ê≠• (Á≤æÁ¥∞)</option>
                                            <option value="75">75 Ê≠• (È´òÂìÅË≥™)</option>
                                            <option value="100">100 Ê≠• (Ê•µËá¥)</option>
                                            <option value="150">150 Ê≠• (Â∞àÊ•≠)</option>
                                        </select>
                                    </div>
                                    
                                    <!-- Ëº∏Âá∫ÂúñÁâáÊ†ºÂºè -->
                                    <div>
                                        <label for="imageFormat" style="font-size: 13px; color: #555; margin-bottom: 5px; display: block;" data-i18n="img_format_label">üìÅ Ëº∏Âá∫Ê†ºÂºè</label>
                                        <select id="imageFormat" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 13px;">
                                            <option value="" data-i18n="img_format_default">È†êË®≠ (‰∏çÊåáÂÆö)</option>
                                            <option value="png">PNG (ÁÑ°Êêç„ÄÅÈÄèÊòé)</option>
                                            <option value="jpg">JPG/JPEG (Â£ìÁ∏Æ)</option>
                                            <option value="webp">WebP (Á∂≤È†ÅÂÑ™Âåñ)</option>
                                            <option value="tiff">TIFF (Âç∞Âà∑ÂìÅË≥™)</option>
                                            <option value="bmp">BMP (ÁÑ°Â£ìÁ∏Æ)</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <button type="button" class="btn" onclick="generateImagePrompt()" id="imageGenerateBtn" style="width: 100%; padding: 15px; background: linear-gradient(135deg, #9C27B0 0%, #E91E63 100%); color: white; border: none; border-radius: 10px; font-size: 16px; font-weight: 600; cursor: pointer;">
                                üé® AI ÁîüÊàêÁπ™ÂúñÊåá‰ª§
                            </button>
                        </form>
                    </div>
                </div>

                <!-- Âè≥ÂÅ¥ÔºöÁµêÊûúËº∏Âá∫ÂçÄ -->
                <div class="output-panel">
                    <h2 class="panel-title">üéØ <span data-i18n="generated_prompt">ÁîüÊàêÁöÑÂ∞àÊ•≠ Prompt</span></h2>
                    
                    <div id="promptResult" style="max-height: 500px; overflow-y: auto; padding: 20px; background: #1e1e1e; border-radius: 10px; color: #d4d4d4; font-family: 'Consolas', 'Monaco', monospace; font-size: 14px; line-height: 1.6; white-space: pre-wrap;">
                        <p style="text-align: center; color: #888; padding: 40px;">
ÈÅ∏ÊìáÊ®°Âºè‰∏¶Â°´ÂØ´ÂèÉÊï∏ÂæåÔºåÈªûÊìäÁîüÊàêÊåâÈàïÁç≤ÂèñÂ∞àÊ•≠ Prompt
                        </p>
                    </div>

                    <!-- Â∑•ÂÖ∑ÊåâÈàïÂçÄÂüü -->
                    <div id="promptActions" style="display: none; margin-top: 20px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                        <button class="btn" onclick="copyPromptToClipboard()" style="padding: 12px 25px; background: linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 8px;">
                            üìã ‰∏ÄÈçµË§áË£Ω
                        </button>
                        <button class="btn" onclick="exportPromptToWord()" style="padding: 12px 25px; background: linear-gradient(135deg, #2b579a 0%, #4a7cc9 100%); color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 8px;">
                            üìÑ Â∞éÂá∫ Word
                        </button>
                    </div>

                    <!-- ÁãÄÊÖãÊèêÁ§∫ -->
                    <div id="promptStatus" style="margin-top: 15px; padding: 10px; border-radius: 8px; display: none; text-align: center;"></div>

                    <!-- ‰ΩøÁî®Ë™™Êòé -->
                    <div style="margin-top: 25px; padding: 20px; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 10px;">
                        <h4 style="color: #333; margin-bottom: 15px;">üí° ‰ΩøÁî®Ë™™Êòé</h4>
                        <ul style="color: #666; font-size: 13px; line-height: 1.8; padding-left: 20px;">
                            <li><strong>ÂïÜÊ•≠È°ßÂïèÊ®°Âºè</strong>ÔºöÈÄèÈÅé 4 Â±§Á¥öÈÅ∏ÂñÆÔºåÂ∞áÊ®°Á≥äÂïèÈ°åËΩâÂåñÁÇ∫Â∏∂ÊúâÂ∞àÊ•≠Ê®°ÂûãÁöÑÊåá‰ª§</li>
                            <li><strong>ËªüÈ´îÈñãÁôºÊ®°Âºè</strong>ÔºöËº∏ÂÖ•ÈúÄÊ±ÇÔºåAI Ëá™ÂãïÁîüÊàêÁµêÊßãÂåñ PRD ËàáÊäÄË°ìÊ£ßË¶èÊ†º</li>
                            <li><strong>Ë¶ñË¶∫Áπ™ÂúñÊ®°Âºè</strong>ÔºöÊèèËø∞Áï´Èù¢ÔºåAI ÁîüÊàê Midjourney/DALL-E Â∞àÁî®ÂèÉÊï∏ÂåñÊåá‰ª§</li>
                            <li>ÁîüÊàêÂæåÂèØ<strong>‰∏ÄÈçµË§áË£Ω</strong>Âà∞ ChatGPT„ÄÅGemini ÊàñÁπ™ÂúñÂ∑•ÂÖ∑‰ΩøÁî®</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <!-- End of Page 4 -->

        <!-- Page 5: Admin Console (ÁÆ°ÁêÜÂì°ÊéßÂà∂Âè∞) - Only visible to admins -->
        <div id="page5" class="page-content admin-only" style="display: none;">
            <div class="admin-console">
                <!-- Admin Console Header -->
                <div class="admin-console-header">
                    <h2 class="admin-title">üóÑÔ∏è <span data-i18n="admin_console_title">ÂæåÂè∞ÁÆ°ÁêÜÊéßÂà∂Âè∞</span></h2>
                    <div class="admin-header-actions">
                        <button class="btn-refresh" id="dbRefreshBtn" onclick="AdminConsole.refresh()">
                            üîÑ <span data-i18n="admin_refresh">ÈáçÊñ∞Êï¥ÁêÜ</span>
                        </button>
                    </div>
                </div>

                <!-- Admin Status Banner -->
                <div id="adminStatusBanner" class="admin-status-banner" style="display: none;">
                    <p>‚ö†Ô∏è <span data-i18n="admin_service_key_required">ÈúÄË¶Å Supabase Service Key ÊâçËÉΩÂü∑Ë°åÁÆ°ÁêÜÊìç‰Ωú</span></p>
                </div>

                <!-- Admin Console Tabs -->
                <div class="admin-tabs">
                    <button class="admin-tab active" onclick="switchAdminTab('users')">
                        üë• <span data-i18n="admin_tab_users">ÊúÉÂì°ÁÆ°ÁêÜ</span>
                    </button>
                    <button class="admin-tab" onclick="switchAdminTab('database')">
                        üóÉÔ∏è <span data-i18n="admin_tab_database">Ë≥áÊñôÂ∫´</span>
                    </button>
                    <button class="admin-tab" onclick="switchAdminTab('stats')">
                        üìä <span data-i18n="admin_tab_stats">Á≥ªÁµ±Áµ±Ë®à</span>
                    </button>
                </div>

                <!-- Users Management Panel -->
                <div id="adminUsersPanel" class="admin-panel active">
                    <!-- Pending Users Section -->
                    <div class="admin-section">
                        <h3 class="section-title">
                            ‚è≥ <span data-i18n="admin_pending_users">ÂæÖÂØ©Ê†∏Áî®Êà∂</span>
                            <span id="pendingCount" class="badge badge-warning">0</span>
                        </h3>
                        <div class="table-container">
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th data-i18n="admin_user_email">ÈõªÂ≠êÈÉµ‰ª∂</th>
                                        <th data-i18n="admin_user_created">Ë®ªÂÜäÊôÇÈñì</th>
                                        <th class="col-actions" data-i18n="admin_action">Êìç‰Ωú</th>
                                    </tr>
                                </thead>
                                <tbody id="pendingUsersBody">
                                    <tr>
                                        <td colspan="3" class="empty-cell" data-i18n="admin_no_pending">ÁõÆÂâçÊ≤íÊúâÂæÖÂØ©Ê†∏ÁöÑÁî®Êà∂</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- All Users Section -->
                    <div class="admin-section">
                        <h3 class="section-title">
                            üë• <span data-i18n="admin_all_users">ÊâÄÊúâÊúÉÂì°</span>
                            <span id="totalCount" class="badge badge-info">0</span>
                        </h3>
                        <div class="table-container">
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th data-i18n="admin_user_email">ÈõªÂ≠êÈÉµ‰ª∂</th>
                                        <th class="col-center" data-i18n="admin_user_role">ËßíËâ≤</th>
                                        <th class="col-center" data-i18n="admin_user_status">ÁãÄÊÖã</th>
                                        <th data-i18n="admin_user_created">Ë®ªÂÜäÊôÇÈñì</th>
                                        <th data-i18n="admin_user_last_login">ÊúÄÂæåÁôªÂÖ•</th>
                                        <th class="col-actions" data-i18n="admin_action">Êìç‰Ωú</th>
                                    </tr>
                                </thead>
                                <tbody id="allUsersBody">
                                    <tr>
                                        <td colspan="6" class="empty-cell" data-i18n="admin_no_users">ÁõÆÂâçÊ≤íÊúâÊúÉÂì°Ë≥áÊñô</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Database Panel -->
                <div id="adminDatabasePanel" class="admin-panel">
                    <div class="db-console-layout">
                        <!-- Left Sidebar - Table List -->
                        <div class="db-sidebar">
                            <div class="db-sidebar-header">
                                <h4>üìã Ë≥áÊñôË°®</h4>
                            </div>
                            <div id="dbTableList" class="db-table-list">
                                <div class="loading-text">ËºâÂÖ•‰∏≠...</div>
                            </div>
                        </div>

                        <!-- Right Content - Data Viewer -->
                        <div class="db-main">
                            <!-- Stats Overview -->
                            <div id="dbStatsContainer" class="db-stats">
                                <div class="stats-placeholder">
                                    <div class="placeholder-icon">üìä</div>
                                    <p>ÈÅ∏ÊìáÂ∑¶ÂÅ¥Ë≥áÊñôË°®‰ª•Ê™¢Ë¶ñË≥áÊñô</p>
                                </div>
                            </div>

                            <!-- Schema Info -->
                            <div id="dbSchemaInfo" class="db-schema"></div>

                            <!-- Data Table -->
                            <div id="dbDataContainer" class="db-data">
                                <div class="data-placeholder">
                                    <div class="placeholder-icon">üóÉÔ∏è</div>
                                    <p>Ë´ãÂæûÂ∑¶ÂÅ¥ÈÅ∏Êìá‰∏ÄÂÄãË≥áÊñôË°®</p>
                                </div>
                            </div>

                            <!-- Pagination -->
                            <div id="dbPagination" class="db-pagination"></div>
                        </div>
                    </div>
                </div>

                <!-- Stats Panel -->
                <div id="adminStatsPanel" class="admin-panel">
                    <div class="stats-dashboard">
                        <div id="systemStatsContainer" class="system-stats">
                            <div class="stats-loading">ËºâÂÖ•Áµ±Ë®àË≥áÊñô‰∏≠...</div>
                        </div>
                    </div>
                </div>

                <!-- Admin Loading Overlay -->
                <div id="adminLoading" class="admin-loading-overlay">
                    <div class="loading-content">
                        <div class="loading-spinner"></div>
                        <p>Loading...</p>
                    </div>
                </div>
            </div>
        </div>
        <!-- End of Page 5 -->

    </div>

    <script>
        let uploadedImagePath = null;
        let productAnalysis = null;
        let painPointsAnalysis = null;
        let generatedContent = null;
        
        const form = document.getElementById('productForm');
        const statusDiv = document.getElementById('status');
        const fileUpload = document.getElementById('imageUpload');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const generateScenariosBtn = document.getElementById('generateScenariosBtn');
        
        // File upload handling - Multi-image support
        let selectedFiles = [];
        
        fileUpload.addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            
            // Limit to maximum 5 files
            if (files.length > 5) {
                alert('ÊúÄÂ§öÂè™ËÉΩÈÅ∏Êìá5ÂºµÂúñÁâá');
                files.splice(5);
                
                // Reset the input to selected files
                const dt = new DataTransfer();
                files.forEach(file => dt.items.add(file));
                e.target.files = dt.files;
            }
            
            selectedFiles = files;
            updateFileUploadDisplay();
            updateImagePreview();
        });
        
        function updateFileUploadDisplay() {
            const uploadText = fileUpload.parentElement.querySelector('p');
            
            if (selectedFiles.length === 0) {
                uploadText.textContent = 'üì∏ ‰∏äÂÇ≥Áé©ÂÖ∑ÂúñÁâá (Upload toy images - ÊúÄÂ§ö5Âºµ)';
            } else if (selectedFiles.length === 1) {
                uploadText.textContent = `Â∑≤ÈÅ∏Êìá: ${selectedFiles[0].name}`;
            } else {
                uploadText.textContent = `Â∑≤ÈÅ∏Êìá: ${selectedFiles.length} ÂºµÂúñÁâá`;
            }
        }
        
        function updateImagePreview() {
            const previewContainer = document.getElementById('imagePreviewContainer');
            const countDisplay = document.getElementById('selectedImageCount');
            
            if (selectedFiles.length === 0) {
                previewContainer.classList.remove('show');
                countDisplay.style.display = 'none';
                return;
            }
            
            previewContainer.classList.add('show');
            countDisplay.style.display = 'block';
            countDisplay.textContent = `Â∑≤ÈÅ∏Êìá ${selectedFiles.length}/5 ÂºµÂúñÁâá`;
            
            let html = '<div class="image-preview-grid">';
            
            selectedFiles.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const previewItem = document.querySelector(`[data-file-index="${index}"]`);
                    if (previewItem) {
                        previewItem.querySelector('img').src = e.target.result;
                    }
                };
                reader.readAsDataURL(file);
                
                html += `
                    <div class="image-preview-item" data-file-index="${index}">
                        <img src="" alt="È†êË¶ΩÂúñÁâá ${index + 1}">
                        <button class="remove-btn" onclick="removeImage(${index})">√ó</button>
                    </div>
                `;
            });
            
            html += '</div>';
            previewContainer.innerHTML = html;
        }
        
        function removeImage(index) {
            selectedFiles.splice(index, 1);
            
            // Update the file input
            const dt = new DataTransfer();
            selectedFiles.forEach(file => dt.items.add(file));
            fileUpload.files = dt.files;
            
            updateFileUploadDisplay();
            updateImagePreview();
        }
        
        // Custom input box display/hide handling
        const modelNationalitySelect = document.getElementById('modelNationality');
        const customNationalityInput = document.getElementById('customNationalityInput');
        const modelCombinationSelect = document.getElementById('modelCombination');
        const customCombinationInput = document.getElementById('customCombinationInput');
        const sceneLocationSelect = document.getElementById('sceneLocation');
        const customLocationInput = document.getElementById('customLocationInput');
        
        if (modelNationalitySelect && customNationalityInput) {
            modelNationalitySelect.addEventListener('change', function() {
                if (this.value === 'custom') {
                    customNationalityInput.style.display = 'block';
                } else {
                    customNationalityInput.style.display = 'none';
                }
            });
        }
        
        if (modelCombinationSelect && customCombinationInput) {
            modelCombinationSelect.addEventListener('change', function() {
                if (this.value === 'custom') {
                    customCombinationInput.style.display = 'block';
                } else {
                    customCombinationInput.style.display = 'none';
                }
            });
        }
        
        if (sceneLocationSelect && customLocationInput) {
            sceneLocationSelect.addEventListener('change', function() {
                if (this.value === 'custom') {
                    customLocationInput.style.display = 'block';
                } else {
                    customLocationInput.style.display = 'none';
                }
            });
        }
        
        // Status display
        function showStatus(message, type) {
            statusDiv.innerHTML = message;
            statusDiv.className = `status ${type}`;
            statusDiv.style.display = 'block';
        }
        
        // Loading state management
        function setLoading(isLoading) {
            analyzeBtn.disabled = isLoading;
            if (isLoading) {
                analyzeBtn.innerHTML = '<span class="loading"></span>AI ÂàÜÊûê‰∏≠...';
            } else {
                analyzeBtn.innerHTML = 'üß† ÂàÜÊûêÁî¢ÂìÅ‰∏¶ÁîüÊàêÂÖßÂÆπ';
            }
        }
        
        // Main form submission
        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            setLoading(true);
            
            try {
                const formData = new FormData();
                const industryCategory = document.getElementById('industryCategory').value;
                const productName = document.getElementById('productName').value;
                const productDescription = document.getElementById('productDescription').value;
                const imageFiles = Array.from(document.getElementById('imageUpload').files);
                const language = document.getElementById('language').value;
                const generateImages = document.getElementById('generateImages').checked;
                
                // Áç≤ÂèñÂ†¥ÊôØÈ°ûÂûãÈÅ∏Êìá
                let scenarioType = 'Ë¶™Â≠ê‰∫íÂãï'; // È†êË®≠ÂÄº
                if (generateImages) {
                    const selectedScenario = document.querySelector('input[name="scenarioType"]:checked');
                    if (selectedScenario) {
                        scenarioType = selectedScenario.value;
                    }
                }
                
                // Áç≤ÂèñÊ®°ÁâπÂÖíÂíåÂ†¥ÊôØË®≠ÂÆö
                let modelNationality = 'taiwan';
                let modelCombination = 'parents_baby';
                let sceneLocation = 'park';
                if (generateImages) {
                    modelNationality = document.getElementById('modelNationality').value;
                    modelCombination = document.getElementById('modelCombination').value;
                    sceneLocation = document.getElementById('sceneLocation').value;
                    
                    // Use custom text if "custom" is selected
                    if (modelNationality === 'custom') {
                        const customText = document.getElementById('customNationalityText').value.trim();
                        if (customText) {
                            modelNationality = customText;
                        }
                    }
                    if (modelCombination === 'custom') {
                        const customText = document.getElementById('customCombinationText').value.trim();
                        if (customText) {
                            modelCombination = customText;
                        }
                    }
                    if (sceneLocation === 'custom') {
                        const customText = document.getElementById('customLocationText').value.trim();
                        if (customText) {
                            sceneLocation = customText;
                        }
                    }
                }
                
                // Get selected platforms
                const selectedPlatforms = Array.from(document.querySelectorAll('#platformsGroup input[type="checkbox"]:checked')).map(cb => cb.value);
                
                if (selectedPlatforms.length === 0) {
                    throw new Error('Ë´ãËá≥Â∞ëÈÅ∏Êìá‰∏ÄÂÄãÁõÆÊ®ôÂπ≥Âè∞');
                }
                
                // Step 1: Upload images if provided
                let uploadedImagePaths = [];
                if (imageFiles.length > 0) {
                    showStatus(`üì§ ‰∏äÂÇ≥ ${imageFiles.length} ÂºµÂúñÁâá‰∏≠...`, 'info');
                    const imageFormData = new FormData();
                    
                    // Append all image files
                    imageFiles.forEach((file, index) => {
                        imageFormData.append('images', file);
                    });
                    imageFormData.append('productName', productName);
                    imageFormData.append('productDescription', productDescription || '');
                    
                    const imageResponse = await fetch('/api/upload-image', {
                        method: 'POST',
                        body: imageFormData
                    });
                    
                    if (!imageResponse.ok) {
                        throw new Error('ÂúñÁâá‰∏äÂÇ≥Â§±Êïó');
                    }
                    
                    const imageResult = await imageResponse.json();
                    uploadedImagePaths = imageResult.paths || [];
                    uploadedImagePath = uploadedImagePaths[0]; // For backward compatibility
                }
                
                // Step 2: AI Product Analysis  
                if (uploadedImagePaths.length > 0 || productDescription) {
                    showStatus(`üß† AI Áî¢ÂìÅÂàÜÊûê‰∏≠... (${language})`, 'info');
                    console.log('üåê Selected language for analysis:', language);
                    
                    const analysisResponse = await AuthManager.authFetch('/api/analyze-product', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            imagePaths: uploadedImagePaths,
                            imagePath: uploadedImagePaths[0], // For backward compatibility
                            productInfo: {
                                name: productName,
                                description: productDescription,
                                industryCategory: industryCategory
                            },
                            language: language
                        })
                    });
                    
                    if (analysisResponse.ok) {
                        const analysisResult = await analysisResponse.json();
                        productAnalysis = analysisResult.productAnalysis;
                        painPointsAnalysis = analysisResult.painPointsAnalysis;
                        
                        displayAnalysisResults(productAnalysis, painPointsAnalysis);
                    } else {
                        showStatus('‚ö†Ô∏è AI ÂàÜÊûêÂ§±ÊïóÔºå‰ΩøÁî®Âü∫Á§éÊ®°ÂºèÁîüÊàêÂÖßÂÆπ', 'info');
                    }
                }
                
                // Step 3: Generate platform content
                showStatus('üéØ ÁîüÊàêÂ§öÂπ≥Âè∞ÂÖßÂÆπ‰∏≠...', 'info');
                
                const contentResponse = await AuthManager.authFetch('/api/generate-platform-content', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        productInfo: productAnalysis || {
                            name: productName,
                            description: productDescription,
                            productType: productName,
                            industryCategory: industryCategory
                        },
                        painPointsAnalysis: painPointsAnalysis || {},
                        platforms: selectedPlatforms,
                        language: language,
                        generateImages: generateImages,
                        scenarioType: scenarioType,
                        productImagePath: uploadedImagePath,
                        modelNationality: modelNationality,
                        modelCombination: modelCombination,
                        sceneLocation: sceneLocation
                    })
                });
                
                if (!contentResponse.ok) {
                    throw new Error('ÂÖßÂÆπÁîüÊàêÂ§±Êïó');
                }
                
                const contentResult = await contentResponse.json();
                generatedContent = contentResult.results;
                displayPlatformResults(contentResult.results);
                showStatus('‚úÖ Â§öÂπ≥Âè∞ÂÖßÂÆπÁîüÊàêÂÆåÊàêÔºÅ', 'success');
                
                // Show scenario generation and switch scenario buttons
                generateScenariosBtn.style.display = 'block';
                document.getElementById('switchScenarioBtn').style.display = 'block';
                
            } catch (error) {
                showStatus(`‚ùå ÈåØË™§: ${error.message}`, 'error');
            } finally {
                setLoading(false);
            }
        });
        
        // Scenario generation button handler
        generateScenariosBtn.addEventListener('click', async function() {
            if (!productAnalysis || !generatedContent) {
                showStatus('‚ö†Ô∏è Ë´ãÂÖàÂÆåÊàêÁî¢ÂìÅÂàÜÊûêÂíåÂÖßÂÆπÁîüÊàê', 'error');
                return;
            }
            
            try {
                showStatus('üé¨ AI ÁîüÊàêË°åÈä∑Â†¥ÊôØ‰∏≠...', 'info');
                generateScenariosBtn.disabled = true;
                generateScenariosBtn.innerHTML = '<span class="loading"></span>Â†¥ÊôØÁîüÊàê‰∏≠...';
                
                // ÈáçÊñ∞Áç≤ÂèñÂ†¥ÊôØÈ°ûÂûãÈÅ∏ÊìáÂíåÊ®°ÁâπÂÖíÂ†¥ÊôØË®≠ÂÆö
                let scenarioType = 'Ë¶™Â≠ê‰∫íÂãï'; // È†êË®≠ÂÄº
                let modelNationality = 'taiwan';
                let modelCombination = 'parents_baby';
                let sceneLocation = 'park';
                const generateImages = document.getElementById('generateImages').checked;
                if (generateImages) {
                    const selectedScenario = document.querySelector('input[name="scenarioType"]:checked');
                    if (selectedScenario) {
                        scenarioType = selectedScenario.value;
                    }
                    modelNationality = document.getElementById('modelNationality').value;
                    modelCombination = document.getElementById('modelCombination').value;
                    sceneLocation = document.getElementById('sceneLocation').value;
                    
                    // Use custom text if "custom" is selected
                    if (modelNationality === 'custom') {
                        const customText = document.getElementById('customNationalityText').value.trim();
                        if (customText) {
                            modelNationality = customText;
                        }
                    }
                    if (modelCombination === 'custom') {
                        const customText = document.getElementById('customCombinationText').value.trim();
                        if (customText) {
                            modelCombination = customText;
                        }
                    }
                    if (sceneLocation === 'custom') {
                        const customText = document.getElementById('customLocationText').value.trim();
                        if (customText) {
                            sceneLocation = customText;
                        }
                    }
                }
                
                const scenarioResponse = await AuthManager.authFetch('/api/generate-scenarios', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        productInfo: productAnalysis,
                        contentData: generatedContent,
                        productImagePath: uploadedImagePath,
                        scenarioType: scenarioType,
                        modelNationality: modelNationality,
                        modelCombination: modelCombination,
                        sceneLocation: sceneLocation
                    })
                });
                
                if (!scenarioResponse.ok) {
                    throw new Error('Â†¥ÊôØÁîüÊàêÂ§±Êïó');
                }
                
                const scenarioResult = await scenarioResponse.json();
                displayScenariosResults(scenarioResult.scenarios);
                showStatus('‚úÖ Ë°åÈä∑Â†¥ÊôØÁîüÊàêÂÆåÊàêÔºÅ', 'success');
                
            } catch (error) {
                showStatus(`‚ùå Â†¥ÊôØÁîüÊàêÈåØË™§: ${error.message}`, 'error');
            } finally {
                generateScenariosBtn.disabled = false;
                generateScenariosBtn.innerHTML = 'üé¨ ÁîüÊàêË°åÈä∑Â†¥ÊôØ';
            }
        });
        
        // Switch scenario button handler - Quick platform switching without re-entering product info
        const switchScenarioBtn = document.getElementById('switchScenarioBtn');
        switchScenarioBtn.addEventListener('click', async function() {
            if (!productAnalysis || !painPointsAnalysis) {
                showStatus('‚ö†Ô∏è Ë´ãÂÖàÂÆåÊàêÁî¢ÂìÅÂàÜÊûê', 'error');
                return;
            }
            
            try {
                // Get selected platforms
                const selectedPlatforms = Array.from(document.querySelectorAll('#platformsGroup input[type="checkbox"]:checked')).map(cb => cb.value);
                
                if (selectedPlatforms.length === 0) {
                    showStatus('‚ö†Ô∏è Ë´ãÈÅ∏ÊìáËá≥Â∞ë‰∏ÄÂÄãÁõÆÊ®ôÂπ≥Âè∞', 'error');
                    return;
                }
                
                const language = document.getElementById('language').value;
                const generateImages = document.getElementById('generateImages').checked;
                const industryCategory = document.getElementById('industryCategory').value;
                
                // Áç≤ÂèñÂ†¥ÊôØÈ°ûÂûãÈÅ∏ÊìáÂíåÊ®°ÁâπÂÖíÂ†¥ÊôØË®≠ÂÆö
                let scenarioType = 'Ë¶™Â≠ê‰∫íÂãï'; // È†êË®≠ÂÄº
                let modelNationality = 'taiwan';
                let modelCombination = 'parents_baby';
                let sceneLocation = 'park';
                if (generateImages) {
                    const selectedScenario = document.querySelector('input[name="scenarioType"]:checked');
                    if (selectedScenario) {
                        scenarioType = selectedScenario.value;
                    }
                    modelNationality = document.getElementById('modelNationality').value;
                    modelCombination = document.getElementById('modelCombination').value;
                    sceneLocation = document.getElementById('sceneLocation').value;
                    
                    // Use custom text if "custom" is selected
                    if (modelNationality === 'custom') {
                        const customText = document.getElementById('customNationalityText').value.trim();
                        if (customText) {
                            modelNationality = customText;
                        }
                    }
                    if (modelCombination === 'custom') {
                        const customText = document.getElementById('customCombinationText').value.trim();
                        if (customText) {
                            modelCombination = customText;
                        }
                    }
                    if (sceneLocation === 'custom') {
                        const customText = document.getElementById('customLocationText').value.trim();
                        if (customText) {
                            sceneLocation = customText;
                        }
                    }
                }
                
                showStatus('üîÑ ‰ΩøÁî®Áõ∏ÂêåÁî¢ÂìÅË≥áË®äÔºåÂàáÊèõÂπ≥Âè∞ÈáçÊñ∞ÁîüÊàêÂÖßÂÆπ...', 'info');
                switchScenarioBtn.disabled = true;
                switchScenarioBtn.innerHTML = '<span class="loading"></span>ÈáçÊñ∞ÁîüÊàê‰∏≠...';
                
                // Generate platform content with existing product analysis
                const contentResponse = await AuthManager.authFetch('/api/generate-platform-content', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        productInfo: productAnalysis,
                        painPointsAnalysis: painPointsAnalysis,
                        platforms: selectedPlatforms,
                        language: language,
                        generateImages: generateImages,
                        scenarioType: scenarioType,
                        productImagePath: uploadedImagePath,
                        modelNationality: modelNationality,
                        modelCombination: modelCombination,
                        sceneLocation: sceneLocation
                    })
                });
                
                if (!contentResponse.ok) {
                    throw new Error('ÂÖßÂÆπÁîüÊàêÂ§±Êïó');
                }
                
                const contentResult = await contentResponse.json();
                generatedContent = contentResult.results;
                displayPlatformResults(contentResult.results);
                showStatus('‚úÖ Â†¥ÊôØÂàáÊèõÊàêÂäüÔºÅÊñ∞Âπ≥Âè∞ÂÖßÂÆπÂ∑≤ÁîüÊàêÔºÅ', 'success');
                
            } catch (error) {
                showStatus(`‚ùå Â†¥ÊôØÂàáÊèõÈåØË™§: ${error.message}`, 'error');
            } finally {
                switchScenarioBtn.disabled = false;
                switchScenarioBtn.innerHTML = 'üîÑ ÂàáÊèõÂ†¥ÊôØÈáçÊñ∞ÁîüÊàê (ÂêåÁî¢ÂìÅ‰∏çÂêåÂπ≥Âè∞)';
            }
        });
        
        // Display AI analysis results
        function displayAnalysisResults(productAnalysis, painPointsAnalysis) {
            const resultsDiv = document.getElementById('analysisResults');
            
            let html = '<div class="analysis-section">';
            html += `<h4>üß∏ ${t('product_analysis_result')}</h4>`;
            
            if (productAnalysis.productType) {
                html += `<p><strong>${t('product_type')}:</strong> ${productAnalysis.productType}</p>`;
            }
            if (productAnalysis.ageRange) {
                html += `<p><strong>${t('age_range')}:</strong> ${productAnalysis.ageRange}</p>`;
            }
            if (productAnalysis.educationalValue) {
                // Handle array or string format
                const eduValue = Array.isArray(productAnalysis.educationalValue) 
                    ? productAnalysis.educationalValue.join('„ÄÅ') 
                    : productAnalysis.educationalValue;
                html += `<p><strong>${t('educational_value')}:</strong> ${eduValue}</p>`;
            }
            if (productAnalysis.features) {
                html += `<p><strong>${t('product_features')}:</strong> ${Array.isArray(productAnalysis.features) ? productAnalysis.features.join('„ÄÅ') : productAnalysis.features}</p>`;
            }
            if (productAnalysis.safetyFeatures) {
                html += `<p><strong>${t('safety_features')}:</strong> ${Array.isArray(productAnalysis.safetyFeatures) ? productAnalysis.safetyFeatures.join('„ÄÅ') : productAnalysis.safetyFeatures}</p>`;
            }
            if (productAnalysis.materials) {
                html += `<p><strong>${t('materials')}:</strong> ${productAnalysis.materials}</p>`;
            }
            if (productAnalysis.colors) {
                html += `<p><strong>${t('colors')}:</strong> ${Array.isArray(productAnalysis.colors) ? productAnalysis.colors.join('„ÄÅ') : productAnalysis.colors}</p>`;
            }
            if (productAnalysis.usageScenarios) {
                html += `<p><strong>${t('usage_scenarios')}:</strong> ${Array.isArray(productAnalysis.usageScenarios) ? productAnalysis.usageScenarios.join('„ÄÅ') : productAnalysis.usageScenarios}</p>`;
            }
            
            html += '</div>';
            
            if (painPointsAnalysis.painPoints) {
                html += '<div class="analysis-section">';
                html += `<h4>üí° ${t('identified_pain_points')}</h4>`;
                painPointsAnalysis.painPoints.forEach(pain => {
                    // Check if bilingual format (contains /) 
                    if (pain.category && pain.category.includes('/')) {
                        const [zhCategory, viCategory] = pain.category.split('/');
                        const [zhDesc, viDesc] = pain.description ? pain.description.split('/') : ['', ''];
                        const [zhTarget, viTarget] = pain.targetAudience ? pain.targetAudience.split('/') : ['', ''];
                        const [zhSeverity, viSeverity] = pain.severity ? pain.severity.split('/') : ['', ''];
                        
                        html += `<div class="pain-point bilingual-analysis">
                            <div class="language-section">
                                <h6 style="color: #d32f2f; margin-bottom: 5px;">üáπüáº</h6>
                                <strong>${zhCategory.trim()}:</strong> ${zhDesc.trim()}
                                <br><small style="color: #666;">${t('target')}: ${zhTarget.trim()} (${zhSeverity.trim()})</small>
                            </div>
                            <div class="language-section" style="margin-top: 8px;">
                                <h6 style="color: #1976d2; margin-bottom: 5px;">üáªüá≥</h6>
                                <strong>${viCategory.trim()}:</strong> ${viDesc.trim()}
                                <br><small style="color: #666;">${t('target')}: ${viTarget.trim()} (${viSeverity.trim()})</small>
                            </div>
                        </div>`;
                    } else {
                        html += `<div class="pain-point">
                            <strong>${pain.category}:</strong> ${pain.description}
                            <small style="color: #666;"> (${pain.severity})</small>
                        </div>`;
                    }
                });
                html += '</div>';
            }
            
            if (painPointsAnalysis.usageScenarios) {
                html += '<div class="analysis-section">';
                html += `<h4>üé¨ ${t('usage_scenario_suggestions')}</h4>`;
                painPointsAnalysis.usageScenarios.forEach(scenario => {
                    // Check if bilingual format
                    if (scenario.scenario && scenario.scenario.includes('/')) {
                        const scenarioParts = scenario.scenario.split('/');
                        const zhScenario = scenarioParts[0] || '';
                        const viScenario = scenarioParts[1] || scenarioParts[0] || '';
                        
                        const contextParts = scenario.context ? scenario.context.split('/') : ['', ''];
                        const zhContext = contextParts[0] || '';
                        const viContext = contextParts[1] || contextParts[0] || '';
                        
                        const benefitsParts = scenario.benefits ? scenario.benefits.split('/') : ['', ''];
                        const zhBenefits = benefitsParts[0] || '';
                        const viBenefits = benefitsParts[1] || benefitsParts[0] || '';
                        
                        const emotionsParts = scenario.emotions ? scenario.emotions.split('/') : ['', ''];
                        const zhEmotions = emotionsParts[0] || '';
                        const viEmotions = emotionsParts[1] || emotionsParts[0] || '';
                        
                        html += `<div class="scenario bilingual-analysis">
                            <div class="language-section">
                                <h6 style="color: #d32f2f; margin-bottom: 5px;">üáπüáº</h6>
                                <strong>${zhScenario.trim()}:</strong> ${zhContext.trim()}
                                <br><small style="color: #28a745;">${zhBenefits.trim()}</small>
                                <br><small style="color: #ff9800;">${t('emotions')}: ${zhEmotions.trim()}</small>
                            </div>
                            <div class="language-section" style="margin-top: 8px;">
                                <h6 style="color: #1976d2; margin-bottom: 5px;">üáªüá≥</h6>
                                <strong>${viScenario.trim()}:</strong> ${viContext.trim()}
                                <br><small style="color: #28a745;">${viBenefits.trim()}</small>
                                <br><small style="color: #ff9800;">${t('emotions')}: ${viEmotions.trim()}</small>
                            </div>
                        </div>`;
                    } else {
                        html += `<div class="scenario">
                            <strong>${scenario.scenario}:</strong> ${scenario.context}
                            <br><small style="color: #28a745;">${scenario.benefits}</small>
                        </div>`;
                    }
                });
                html += '</div>';
            }
            
            resultsDiv.innerHTML = html;
        }
        
        // ÂúñÁâá‰∏ãËºâÂäüËÉΩ
        function downloadFile(filePath, filename) {
            try {
                const downloadUrl = `/api/download-image?path=${encodeURIComponent(filePath)}`;
                const link = document.createElement('a');
                link.href = downloadUrl;
                link.download = filename || 'download';
                link.style.display = 'none';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                showStatus(`üì• Ê≠£Âú®‰∏ãËºâ: ${filename}`, 'info');
            } catch (error) {
                showStatus(`‚ùå ‰∏ãËºâÂ§±Êïó: ${error.message}`, 'error');
            }
        }

        // Display platform-specific results with download functionality
        function displayPlatformResults(results) {
            const resultsContainer = document.getElementById('resultsContainer');
            const platformResults = document.getElementById('platformResults');
            
            let html = '';
            
            Object.entries(results).forEach(([platform, result]) => {
                const config = result.platformConfig || {};
                const content = result.content;
                
                html += `<div class="platform-result">
                    <h3>
                        ${getPlatformIcon(platform)} ${config.displayName || platform.toUpperCase()}
                        ${result.status === 'success' ? '‚úÖ' : '‚ö†Ô∏è'}
                    </h3>`;
                
                if (result.status === 'success' && content) {
                    // Handle bilingual content format
                    if (typeof content.mainContent === 'object' && content.mainContent['zh-TW'] && content.mainContent['vi']) {
                        // Bilingual format
                        html += `<div class="content bilingual-content">
                            <div class="language-section">
                                <h5 style="color: #d32f2f; margin-bottom: 8px;">üáπüáº ÁπÅÈ´î‰∏≠Êñá</h5>
                                <div>${content.mainContent['zh-TW']}</div>
                            </div>
                            <div class="language-section" style="margin-top: 15px;">
                                <h5 style="color: #1976d2; margin-bottom: 8px;">üáªüá≥ Ti·∫øng Vi·ªát</h5>
                                <div>${content.mainContent['vi']}</div>
                            </div>
                        </div>`;
                        
                        // Bilingual hashtags
                        if (content.hashtags && typeof content.hashtags === 'object') {
                            html += `<div class="hashtags-bilingual">
                                <div style="margin-bottom: 8px;">
                                    <strong>üáπüáº:</strong> ${content.hashtags['zh-TW']?.join(' ') || ''}
                                </div>
                                <div>
                                    <strong>üáªüá≥:</strong> ${content.hashtags['vi']?.join(' ') || ''}
                                </div>
                            </div>`;
                        }
                        
                        // Bilingual CTA
                        if (content.cta && typeof content.cta === 'object') {
                            html += `<div style="margin-top: 10px;">
                                <div style="margin-bottom: 5px;"><strong>üáπüáº CTA:</strong> ${content.cta['zh-TW'] || ''}</div>
                                <div><strong>üáªüá≥ CTA:</strong> ${content.cta['vi'] || ''}</div>
                            </div>`;
                        }
                    } else {
                        // Standard single-language format
                        html += `<div class="content">${content.mainContent || content.rawContent}</div>`;
                        
                        if (content.hashtags && content.hashtags.length > 0) {
                            html += `<div class="hashtags">${content.hashtags.join(' ')}</div>`;
                        }
                        
                        if (content.cta) {
                            html += `<div style="margin-top: 10px;"><strong>CTA:</strong> ${content.cta}</div>`;
                        }
                    }
                    
                    // È°ØÁ§∫ÁîüÊàêÁöÑÂúñÁâáÊàñË®≠Ë®àÊèèËø∞ÔºàÂ∏∂‰∏ãËºâÂäüËÉΩÔºâ
                    if (result.generatedImageDescription) {
                        html += `<div style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 8px;">`;
                        
                        if (result.isRealImage) {
                            html += `
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <strong>üé® AI ÁîüÊàêÂúñÁâá:</strong>
                                    <button onclick="downloadFile('${result.path}', '${platform}_generated_image.png')" 
                                            class="btn btn-small" style="background: #4CAF50; color: white; padding: 5px 10px; border: none; border-radius: 4px; cursor: pointer;">
                                        üì• ‰∏ãËºâÂúñÁâá
                                    </button>
                                </div>
                                <small style="color: #1976d2;">‚úÖ ÁúüÂØ¶ AI ÂúñÁâáÂ∑≤ÁîüÊàê (${Math.round(result.size/1024)}KB)</small>`;
                        } else {
                            html += `
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <strong>üìã Â∞àÊ•≠Ë®≠Ë®àË¶èÊ†º:</strong>
                                    <button onclick="downloadFile('${result.path}', '${platform}_design_spec.md')" 
                                            class="btn btn-small" style="background: #2196F3; color: white; padding: 5px 10px; border: none; border-radius: 4px; cursor: pointer;">
                                        üì• ‰∏ãËºâË¶èÊ†º
                                    </button>
                                </div>
                                <small style="color: #666;">üìù ÂèØÁî®ÊñºÂ∞àÊ•≠Ë®≠Ë®àÂ∑•ÂÖ∑ (DALL-E, Midjourney, Stable Diffusion)</small>`;
                        }
                        
                        html += `</div>`;
                    }
                } else {
                    html += `<div class="content" style="color: #dc3545;">
                        ÈåØË™§: ${result.error}
                        <br>ÂÇôÁî®ÂÖßÂÆπ: ${result.fallback}
                    </div>`;
                }
                
                html += '</div>';
            });
            
            platformResults.innerHTML = html;
            resultsContainer.style.display = 'block';
        }
        
        function getPlatformIcon(platform) {
            const icons = {
                shopee: 'üõí',
                tiktok: 'üéµ',
                instagram: 'üì∏',
                facebook: 'üëç'
            };
            return icons[platform] || 'üì±';
        }
        
        // Display scenarios results with download functionality
        function displayScenariosResults(scenarios) {
            const scenariosContainer = document.getElementById('scenariosContainer');
            const scenarioResults = document.getElementById('scenarioResults');
            
            let html = '';
            
            scenarios.forEach((scenario, index) => {
                html += `<div class="platform-result" style="margin-bottom: 25px;">
                    <h3 style="color: #4a90e2;">
                        üé¨ Â†¥ÊôØ ${scenario.scenarioIndex}: ${scenario.name}
                        ${scenario.imageError ? '‚ö†Ô∏è' : '‚úÖ'}
                    </h3>
                    
                    <div style="margin-bottom: 15px;">
                        <h4 style="color: #333; margin-bottom: 8px;">üìù Â†¥ÊôØÊèèËø∞</h4>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                            ${scenario.description}
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                            <div>
                                <strong>üí≠ ÊÉÖÊÑüÊ∞õÂúç:</strong> ${scenario.emotion}<br>
                                <strong>üéØ ÈÅ©ÂêàÂπ≥Âè∞:</strong> ${scenario.suitablePlatforms?.join(', ') || 'ÈÄöÁî®'}
                            </div>
                            <div>
                                <strong>üé® Ë¶ñË¶∫ÈáçÈªû:</strong> ${scenario.visualFocus}
                            </div>
                        </div>
                    </div>`;
                
                if (scenario.imageDescription) {
                    html += `<div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4 style="color: #1976d2; margin-bottom: 10px;">üñºÔ∏è ÂúñÁâáË®≠Ë®àÊèèËø∞</h4>
                        <div style="white-space: pre-wrap; font-size: 14px; line-height: 1.6;">
                            ${scenario.imageDescription}
                        </div>
                    </div>`;
                }
                
                // È°ØÁ§∫ÁîüÊàêÁöÑÂúñÁâáÊàñË®≠Ë®àÊåáÂ∞éÔºàÂ∏∂‰∏ãËºâÂäüËÉΩÔºâ
                if (scenario.isRealImage && scenario.path) {
                    html += `<div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 10px;">
                            <h4 style="color: #2e7d2e; margin: 0;">üé® AI ÁîüÊàêÂ†¥ÊôØÂúñÁâá</h4>
                            <button onclick="downloadFile('${scenario.path}', 'scenario_${scenario.scenarioIndex}_${scenario.name.replace(/[^a-zA-Z0-9]/g, '_')}.png')" 
                                    class="btn btn-small" style="background: #4CAF50; color: white; padding: 8px 15px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">
                                üì• ‰∏ãËºâÂ†¥ÊôØÂúñÁâá
                            </button>
                        </div>
                        <p style="color: #2e7d2e; margin: 0;">‚úÖ ÁúüÂØ¶ AI ÂúñÁâáÂ∑≤ÁîüÊàê (${Math.round(scenario.size/1024)}KB)</p>
                    </div>`;
                } else if (scenario.designGuidePath || scenario.path) {
                    const filePath = scenario.designGuidePath || scenario.path;
                    const fileName = `scenario_${scenario.scenarioIndex}_${scenario.name.replace(/[^a-zA-Z0-9]/g, '_')}_guide.md`;
                    
                    html += `<div style="background: #f3e5f5; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 10px;">
                            <h4 style="color: #7b1fa2; margin: 0;">üìã Â∞àÊ•≠Ë®≠Ë®àÊåáÂ∞éÊñá‰ª∂</h4>
                            <button onclick="downloadFile('${filePath}', '${fileName}')" 
                                    class="btn btn-small" style="background: #9C27B0; color: white; padding: 8px 15px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">
                                üì• ‰∏ãËºâË®≠Ë®àÊåáÂ∞é
                            </button>
                        </div>
                        <p style="color: #666; font-size: 14px; margin: 0;">üìù ÂåÖÂê´ÂÆåÊï¥Ë®≠Ë®àË¶èÊ†ºÔºåÂèØÁî®ÊñºÂ∞àÊ•≠Ë®≠Ë®àÂ∑•ÂÖ∑ (DALL-E, Midjourney, Stable Diffusion)</p>
                    </div>`;
                }
                
                if (scenario.imageError) {
                    html += `<div style="background: #ffebee; padding: 15px; border-radius: 8px; border-left: 4px solid #f44336;">
                        <strong style="color: #d32f2f;">ÂúñÁâáÁîüÊàêÈåØË™§:</strong> ${scenario.imageError}
                    </div>`;
                }
                
                html += '</div>';
            });
            
            scenarioResults.innerHTML = html;
            scenariosContainer.style.display = 'block';
        }
        
        // Toggle scenario options based on generateImages checkbox
        function toggleScenarioOptions() {
            const generateImages = document.getElementById('generateImages').checked;
            const modelSceneOptionsGroup = document.getElementById('modelSceneOptionsGroup');
            const scenarioOptionsGroup = document.getElementById('scenarioOptionsGroup');
            
            if (generateImages) {
                modelSceneOptionsGroup.style.display = 'block';
                scenarioOptionsGroup.style.display = 'block';
            } else {
                modelSceneOptionsGroup.style.display = 'none';
                scenarioOptionsGroup.style.display = 'none';
            }
        }

        // Load brand configuration and populate UI
        async function loadBrandConfig() {
            try {
                const response = await fetch('/api/config');
                const config = await response.json();
                
                // Update brand elements
                const logoElement = document.getElementById('brandLogo');
                logoElement.src = config.brand.logoPath;
                logoElement.alt = `${config.brand.name} Logo`;
                logoElement.style.display = 'block';
                // brandTitle and brandSlogan now use data-i18n attributes for automatic translation
                // Title and slogan will be updated by updatePageLanguage() function
                document.title = `${config.brand.name} Multi-Platform Content Generator`;
                
                // Populate platforms
                const platformsGroup = document.getElementById('platformsGroup');
                platformsGroup.innerHTML = '';
                config.platforms.forEach(platform => {
                    const item = document.createElement('div');
                    item.className = 'checkbox-item';
                    item.innerHTML = `
                        <input type="checkbox" id="platform_${platform.value}" value="${platform.value}" checked>
                        <label for="platform_${platform.value}">${platform.label}</label>
                    `;
                    platformsGroup.appendChild(item);
                });
                
                console.log('Brand configuration loaded:', config);
            } catch (error) {
                console.error('Failed to load brand configuration:', error);
            }
        }
        
        // Initialize app
        fetch('/api/health')
            .then(response => response.json())
            .then(data => {
                console.log('API Status:', data);
                return loadBrandConfig();
            })
            .catch(error => {
                console.error('API connection failed:', error);
            });
        
        // ==================== Page 2: AI Âª£ÂëäÈ°ßÂïèÂäüËÉΩ ====================
        
        // ÂàÜÈ†ÅÂàáÊèõÂáΩÊï∏
        function switchPage(pageId) {
            // Èö±ËóèÊâÄÊúâÈ†ÅÈù¢
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.remove('active');
            });
            
            // ÁßªÈô§ÊâÄÊúâÊåâÈàïÁöÑ active ÁãÄÊÖã
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // È°ØÁ§∫ÈÅ∏‰∏≠ÁöÑÈ†ÅÈù¢
            document.getElementById(pageId).classList.add('active');
            
            // Ë®≠ÁΩÆÂ∞çÊáâÊåâÈàïÁÇ∫ active
            event.target.classList.add('active');
        }
        
        // Page 2 Ê™îÊ°à‰∏äÂÇ≥ËôïÁêÜ
        let selectedAdsFiles = [];
        const adsFileUpload = document.getElementById('adsFileUpload');
        
        if (adsFileUpload) {
            adsFileUpload.addEventListener('change', function(e) {
                const files = Array.from(e.target.files);
                
                // ÈôêÂà∂ÊúÄÂ§ö 10 ÂÄãÊ™îÊ°à
                if (files.length > 10) {
                    alert('ÊúÄÂ§öÂè™ËÉΩÈÅ∏Êìá10ÂÄãÊ™îÊ°à');
                    files.splice(10);
                    
                    const dt = new DataTransfer();
                    files.forEach(file => dt.items.add(file));
                    e.target.files = dt.files;
                }
                
                selectedAdsFiles = files;
                displayAdsFilePreview(files);
            });
        }
        
        // È°ØÁ§∫ Page 2 Ê™îÊ°àÈ†êË¶Ω
        function displayAdsFilePreview(files) {
            const container = document.getElementById('adsFilePreviewContainer');
            const countDiv = document.getElementById('selectedAdsFileCount');
            
            if (files.length === 0) {
                container.style.display = 'none';
                countDiv.style.display = 'none';
                return;
            }
            
            container.innerHTML = '';
            container.classList.add('show');
            countDiv.style.display = 'block';
            countDiv.textContent = `Â∑≤ÈÅ∏Êìá ${files.length} ÂÄãÊ™îÊ°à`;
            
            const grid = document.createElement('div');
            grid.className = 'image-preview-grid';
            
            files.forEach((file, index) => {
                const item = document.createElement('div');
                item.className = 'image-preview-item';
                
                // Ê†πÊìöÊ™îÊ°àÈ°ûÂûãÈ°ØÁ§∫‰∏çÂêåÂúñÁ§∫
                let fileIcon = 'üìÑ';
                if (file.type.startsWith('image/')) {
                    fileIcon = 'üñºÔ∏è';
                } else if (file.type.includes('pdf')) {
                    fileIcon = 'üìï';
                } else if (file.type.includes('sheet') || file.type.includes('excel')) {
                    fileIcon = 'üìä';
                } else if (file.type.includes('word') || file.type.includes('document')) {
                    fileIcon = 'üìù';
                }
                
                item.innerHTML = `
                    <div style="padding: 15px; text-align: center; background: #f0f0f0; height: 100px; display: flex; flex-direction: column; justify-content: center;">
                        <div style="font-size: 32px;">${fileIcon}</div>
                        <div style="font-size: 10px; margin-top: 5px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${file.name}</div>
                    </div>
                    <button class="remove-btn" onclick="removeAdsFile(${index})">√ó</button>
                `;
                
                grid.appendChild(item);
            });
            
            container.appendChild(grid);
        }
        
        // ÁßªÈô§ Page 2 Ê™îÊ°à
        function removeAdsFile(index) {
            selectedAdsFiles.splice(index, 1);
            
            const dt = new DataTransfer();
            selectedAdsFiles.forEach(file => dt.items.add(file));
            document.getElementById('adsFileUpload').files = dt.files;
            
            displayAdsFilePreview(selectedAdsFiles);
        }
        
        // Page 2 Ë°®ÂñÆÊèê‰∫§ËôïÁêÜ
        const adsAnalysisForm = document.getElementById('adsAnalysisForm');
        if (adsAnalysisForm) {
            adsAnalysisForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const brandName = document.getElementById('brandName').value.trim();
                const productName = document.getElementById('adProductName').value.trim();
                const coreProduct = document.getElementById('coreProduct').value.trim();
                const targetMarket = document.getElementById('targetMarket').value.trim();
                
                // Áç≤ÂèñÈÅ∏‰∏≠ÁöÑÂπ≥Âè∞
                const selectedPlatforms = Array.from(document.querySelectorAll('input[name="adsPlatform"]:checked'))
                    .map(cb => cb.value);
                
                // Ê™¢Êü•ÊòØÂê¶Êúâ‰ªª‰ΩïÂèØÂàÜÊûêÁöÑË≥áË®äÔºàÊ™îÊ°àÊàñÊñáÂ≠óË≥áË®äÔºâ
                const hasFiles = selectedAdsFiles.length > 0;
                const hasTextInfo = brandName || productName || coreProduct || targetMarket;
                const hasPlatformSelection = selectedPlatforms.length > 0;
                
                if (!hasFiles && !hasTextInfo) {
                    alert('Ë´ãËá≥Â∞ë‰∏äÂÇ≥Ê™îÊ°àÊàñÂ°´ÂØ´ÂìÅÁâå/Áî¢ÂìÅË≥áË®äÔºåAI ÊâçËÉΩÈÄ≤Ë°åÂàÜÊûê');
                    return;
                }
                
                if (!hasPlatformSelection) {
                    alert('Ë´ãËá≥Â∞ëÈÅ∏Êìá‰∏ÄÂÄãÂª£ÂëäÂπ≥Âè∞');
                    return;
                }
                
                const statusDiv = document.getElementById('adsStatus');
                const resultsDiv = document.getElementById('adsAnalysisResults');
                const analyzeBtn = document.getElementById('analyzeAdsBtn');
                
                // È°ØÁ§∫ËºâÂÖ•ÁãÄÊÖã
                analyzeBtn.disabled = true;
                analyzeBtn.textContent = 'üîÑ ÂàÜÊûê‰∏≠...';
                statusDiv.innerHTML = '<p style="color: #87CEEB;">‚è≥ Ê≠£Âú®‰∏äÂÇ≥Ê™îÊ°à‰∏¶ÂàÜÊûêÂª£ÂëäË≥áÊñô...</p>';
                
                try {
                    // Ê∫ñÂÇôË°®ÂñÆÊï∏Êìö
                    const formData = new FormData();
                    formData.append('brandName', brandName);
                    formData.append('productName', productName);
                    formData.append('coreProduct', coreProduct);
                    formData.append('targetMarket', targetMarket);
                    formData.append('platforms', JSON.stringify(selectedPlatforms));
                    formData.append('language', currentLanguage); // Ê∑ªÂä†Áï∂ÂâçË™ûË®Ä
                    
                    // Ê∑ªÂä†ÊâÄÊúâÊ™îÊ°à
                    selectedAdsFiles.forEach((file, index) => {
                        formData.append('files', file);
                    });
                    
                    // ÁôºÈÄÅÂà∞ÂæåÁ´Ø API
                    const response = await AuthManager.authFetch('/api/analyze-ads', {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (!response.ok) {
                        throw new Error('ÂàÜÊûêË´ãÊ±ÇÂ§±Êïó');
                    }
                    
                    const result = await response.json();
                    
                    // È°ØÁ§∫ÂàÜÊûêÁµêÊûú
                    displayAdsAnalysisResults(result);
                    
                    // ‰øùÂ≠òÂàÜÊûê‰∏ä‰∏ãÊñá‰æõÂ∞çË©±‰ΩøÁî®
                    analysisContext = {
                        brandNeedSummary: result.brandNeedSummary,
                        performanceInsight: result.performanceInsight,
                        creativeStrategy: result.creativeStrategy,
                        optimizationPlan: result.optimizationPlan,
                        advertisingReviewReport: result.advertisingReviewReport
                    };
                    
                    // È°ØÁ§∫Âª∫Ë≠∞ÂïèÈ°åÂíåÂ∞çË©±Ë¶ñÁ™ó
                    if (result.suggestedQuestions && result.suggestedQuestions.length > 0) {
                        showSuggestedQuestions(result.suggestedQuestions);
                    }
                    
                    // È°ØÁ§∫Â∞çË©±Ë¶ñÁ™ó
                    document.getElementById('chatAdvisorContainer').classList.add('active');
                    
                    statusDiv.innerHTML = '<p style="color: #28a745;">‚úÖ ÂàÜÊûêÂÆåÊàêÔºÅÊÇ®ÂèØ‰ª•Âú®‰∏ãÊñπÂ∞çË©±Ë¶ñÁ™óÂêë AI È°ßÂïèÊèêÂïè„ÄÇ</p>';
                    document.getElementById('reportActions').style.display = 'block';
                    
                } catch (error) {
                    console.error('ÂàÜÊûêÈåØË™§:', error);
                    statusDiv.innerHTML = '<p style="color: #dc3545;">‚ùå ÂàÜÊûêÂ§±ÊïóÔºåË´ãÁ®çÂæåÂÜçË©¶</p>';
                } finally {
                    analyzeBtn.disabled = false;
                    analyzeBtn.textContent = 'üß† ÈñãÂßãÂàÜÊûê (Start Analysis)';
                }
            });
        }
        
        // È°ØÁ§∫Âª£ÂëäÂàÜÊûêÁµêÊûú
        function displayAdsAnalysisResults(result) {
            const resultsDiv = document.getElementById('adsAnalysisResults');
            
            let html = '<div style="text-align: left;">';
            
            // 1. Brand Need Summary
            if (result.brandNeedSummary) {
                html += `
                    <div style="margin-bottom: 25px; padding: 20px; background: #f8f9fa; border-left: 4px solid #87CEEB; border-radius: 8px;">
                        <h3 style="color: #87CEEB; margin-bottom: 10px;">üìå Brand Need Summary (ÂìÅÁâåÈúÄÊ±ÇÊëòË¶Å)</h3>
                        <p style="white-space: pre-wrap; line-height: 1.6;">${result.brandNeedSummary}</p>
                    </div>
                `;
            }
            
            // 2. Performance Insight
            if (result.performanceInsight) {
                html += `
                    <div style="margin-bottom: 25px; padding: 20px; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 8px;">
                        <h3 style="color: #ffc107; margin-bottom: 10px;">üìä Performance Insight (ÊïàËÉΩÊ¥ûÂØü)</h3>
                        <p style="white-space: pre-wrap; line-height: 1.6;">${result.performanceInsight}</p>
                    </div>
                `;
            }
            
            // 3. Creative Strategy
            if (result.creativeStrategy) {
                html += `
                    <div style="margin-bottom: 25px; padding: 20px; background: #d1ecf1; border-left: 4px solid #17a2b8; border-radius: 8px;">
                        <h3 style="color: #17a2b8; margin-bottom: 10px;">üé® Creative Strategy (ÂâµÊÑèÁ≠ñÁï•)</h3>
                        <p style="white-space: pre-wrap; line-height: 1.6;">${result.creativeStrategy}</p>
                    </div>
                `;
            }
            
            // 4. Optimization Plan
            if (result.optimizationPlan) {
                html += `
                    <div style="margin-bottom: 25px; padding: 20px; background: #d4edda; border-left: 4px solid #28a745; border-radius: 8px;">
                        <h3 style="color: #28a745; margin-bottom: 10px;">üöÄ Optimization Plan (ÂÑ™ÂåñË®àÂäÉ)</h3>
                        <p style="white-space: pre-wrap; line-height: 1.6;">${result.optimizationPlan}</p>
                    </div>
                `;
            }
            
            // 5. Advertising Review Report
            if (result.advertisingReviewReport) {
                html += `
                    <div style="margin-bottom: 25px; padding: 20px; background: #f8d7da; border-left: 4px solid #dc3545; border-radius: 8px;">
                        <h3 style="color: #dc3545; margin-bottom: 10px;">üìù Advertising Review Report (Âª£ÂëäÊ™¢Ë¶ñÂ†±Âëä)</h3>
                        <p style="white-space: pre-wrap; line-height: 1.6;">${result.advertisingReviewReport}</p>
                    </div>
                `;
            }
            
            html += '</div>';
            resultsDiv.innerHTML = html;
        }
        
        // PDF ÂåØÂá∫ÂäüËÉΩ
        function exportPDF() {
            window.print();
        }
        
        // ÈáçÊñ∞ÂàÜÊûêÂäüËÉΩ
        function reanalyze() {
            document.getElementById('adsAnalysisResults').innerHTML = `
                <p style="text-align: center; color: #666; padding: 40px;">
                    ‰∏äÂÇ≥Âª£ÂëäË≥áÊñô‰∏¶ÈªûÊìäÂàÜÊûêÊåâÈàïÈñãÂßã AI Êô∫ÊÖßÂàÜÊûê
                </p>
            `;
            document.getElementById('reportActions').style.display = 'none';
            document.getElementById('adsStatus').innerHTML = '';
        }
        
        // ==================== Ë™ûË®ÄÂàáÊèõÂäüËÉΩ ====================
        
        function toggleLanguageMenu() {
            const menu = document.getElementById('languageMenu');
            menu.classList.toggle('active');
        }
        
        function selectLanguage(lang) {
            switchLanguage(lang);
            const menu = document.getElementById('languageMenu');
            menu.classList.remove('active');
            
            // Êõ¥Êñ∞ÈÅ∏‰∏≠ÁãÄÊÖã
            document.querySelectorAll('.language-option').forEach(option => {
                option.classList.remove('active');
            });
            event.target.classList.add('active');
        }
        
        // ÈªûÊìäÂ§ñÈÉ®ÈóúÈñâË™ûË®ÄÈÅ∏ÂñÆ
        document.addEventListener('click', function(event) {
            const languageSwitcher = document.querySelector('.language-switcher');
            if (languageSwitcher && !languageSwitcher.contains(event.target)) {
                document.getElementById('languageMenu').classList.remove('active');
            }
        });
        
        // ==================== Â∞çË©±ÂäüËÉΩ ====================
        
        let chatHistory = [];
        let chatFiles = [];
        let analysisContext = null; // ÂÑ≤Â≠òÂàÜÊûêÁµêÊûú‰ΩúÁÇ∫Â∞çË©±‰∏ä‰∏ãÊñá
        
        // Ê™îÊ°à‰∏äÂÇ≥ËôïÁêÜ
        const chatFileUpload = document.getElementById('chatFileUpload');
        if (chatFileUpload) {
            chatFileUpload.addEventListener('change', function(e) {
                chatFiles = Array.from(e.target.files);
                displayChatFilePreview();
            });
        }
        
        function displayChatFilePreview() {
            const container = document.getElementById('chatFilePreview');
            if (chatFiles.length === 0) {
                container.innerHTML = '';
                return;
            }
            
            container.innerHTML = chatFiles.map((file, index) => `
                <div class="chat-file-item">
                    üìé ${file.name}
                    <span class="chat-file-remove" onclick="removeChatFile(${index})">√ó</span>
                </div>
            `).join('');
        }
        
        function removeChatFile(index) {
            chatFiles.splice(index, 1);
            displayChatFilePreview();
        }
        
        // ÁôºÈÄÅÂ∞çË©±Ë®äÊÅØ
        async function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message && chatFiles.length === 0) {
                alert('Ë´ãËº∏ÂÖ•ÂïèÈ°åÊàñ‰∏äÂÇ≥Ê™îÊ°à');
                return;
            }
            
            // È°ØÁ§∫Áî®Êà∂Ë®äÊÅØ
            if (message) {
                addChatMessage('user', message);
            }
            if (chatFiles.length > 0) {
                addChatMessage('user', `üìé Â∑≤‰∏äÂÇ≥ ${chatFiles.length} ÂÄãÊ™îÊ°à`);
            }
            
            input.value = '';
            const sendBtn = document.getElementById('chatSendBtn');
            sendBtn.disabled = true;
            
            // È°ØÁ§∫ËºâÂÖ•‰∏≠
            const loadingId = 'loading-' + Date.now();
            addChatMessage('ai', 'Ê≠£Âú®ÊÄùËÄÉ‰∏≠...', loadingId);
            
            try {
                // Ê∫ñÂÇôË°®ÂñÆÊï∏Êìö
                const formData = new FormData();
                formData.append('message', message);
                formData.append('chatHistory', JSON.stringify(chatHistory));
                formData.append('language', currentLanguage); // Ê∑ªÂä†Áï∂ÂâçË™ûË®Ä
                if (analysisContext) {
                    formData.append('analysisContext', JSON.stringify(analysisContext));
                }
                
                // Ê∑ªÂä†Ê™îÊ°à
                chatFiles.forEach(file => {
                    formData.append('files', file);
                });
                
                // ÁôºÈÄÅË´ãÊ±Ç
                const response = await AuthManager.authFetch('/api/chat-with-advisor', {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (data.success) {
                    // ÁßªÈô§ËºâÂÖ•Ë®äÊÅØ
                    document.getElementById(loadingId)?.remove();
                    
                    // È°ØÁ§∫AIÂõûË¶Ü
                    addChatMessage('ai', data.response);
                    
                    // Êõ¥Êñ∞Â∞çË©±Ê≠∑Âè≤
                    chatHistory.push({
                        role: 'user',
                        content: message,
                        hasFiles: chatFiles.length > 0
                    });
                    chatHistory.push({
                        role: 'assistant',
                        content: data.response
                    });
                    
                    // Ê∏ÖÁ©∫Ê™îÊ°à
                    chatFiles = [];
                    displayChatFilePreview();
                } else {
                    throw new Error(data.error || 'Â∞çË©±Â§±Êïó');
                }
            } catch (error) {
                console.error('Â∞çË©±ÈåØË™§:', error);
                document.getElementById(loadingId)?.remove();
                addChatMessage('ai', 'Êä±Ê≠âÔºåÁôºÁîüÈåØË™§Ôºö' + error.message);
            } finally {
                sendBtn.disabled = false;
            }
        }
        
        // Ê∑ªÂä†Â∞çË©±Ë®äÊÅØÂà∞ÁïåÈù¢
        function addChatMessage(role, content, messageId = null) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${role}`;
            if (messageId) messageDiv.id = messageId;
            
            const avatar = role === 'ai' ? 'ü§ñ' : 'üë§';
            
            messageDiv.innerHTML = `
                <div class="chat-message-avatar">${avatar}</div>
                <div class="chat-message-content">${content}</div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        // È°ØÁ§∫Âª∫Ë≠∞ÂïèÈ°å
        function showSuggestedQuestions(questions) {
            const container = document.getElementById('suggestedQuestionsList');
            const questionsDiv = document.getElementById('suggestedQuestions');
            
            container.innerHTML = questions.map((q, index) => `
                <button class="suggested-question-btn" onclick="askSuggestedQuestion('${q.replace(/'/g, "\\'")}')">
                    ${index + 1}. ${q}
                </button>
            `).join('');
            
            questionsDiv.style.display = 'block';
        }
        
        // ÈªûÊìäÂª∫Ë≠∞ÂïèÈ°å
        function askSuggestedQuestion(question) {
            document.getElementById('chatInput').value = question;
            sendChatMessage();
            document.getElementById('suggestedQuestions').style.display = 'none';
        }
        
        // Enter ÁôºÈÄÅË®äÊÅØ
        const chatInput = document.getElementById('chatInput');
        if (chatInput) {
            chatInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendChatMessage();
                }
            });
        }
    </script>

    <!-- Page 3: AI Ë™≤Á®ãÁ∑®ËºØÂ∞àÂÆ∂ JavaScript -->
    <script>
        // ÂÑ≤Â≠òÁîüÊàêÁöÑË™≤Á®ãÊï∏Êìö
        let generatedCourseData = null;

        // ‰∏ªÈ°åÈÅ∏È†ÖÔºàÊ†πÊìöÁßëÂà•ÂãïÊÖãÊõ¥Êñ∞Ôºâ
        const topicOptions = {
            social: ['ÂÆ∂Â∫≠', '‰∫§ÈÄöÂ∑•ÂÖ∑', 'Á§æÊúÉËßíËâ≤', 'ÊñáÂåñÁØÄÊó•', 'ÂÆâÂÖ®ÊïôËÇ≤'],
            science: ['ÂãïÁâ©', 'Ê§çÁâ©', 'Âú∞ÁêÉ', 'Â§©Ê∞£', '‰∫îÊÑü'],
            math: ['Âä†Ê≥ï', 'Ê∏õÊ≥ï', 'ÂΩ¢ÁãÄ', 'ÊôÇÈñì', 'Â∫¶Èáè'],
            language: ['Â≠óÊØç', 'Ë©ûÂΩô', 'ËÅΩË™™ËÆÄÂØ´', 'Áü≠ÁØáÊïÖ‰∫ã'],
            art: ['È°èËâ≤', 'Á∑öÊ¢ù', 'Ââµ‰Ωú', 'Èü≥Ê®ÇÁØÄÂ•è']
        };

        // ËôïÁêÜÂπ¥ÈΩ°ÈÅ∏ÊìáËÆäÂåñ
        function handleAgeChange() {
            const ageSelect = document.getElementById('targetAge');
            const customInput = document.getElementById('customAgeText');
            
            if (ageSelect.value === 'custom') {
                customInput.style.display = 'block';
            } else {
                customInput.style.display = 'none';
            }
        }

        // ËôïÁêÜÁßëÂà•ÈÅ∏ÊìáËÆäÂåñ
        function handleCategoryChange() {
            const categorySelect = document.getElementById('category');
            const customInput = document.getElementById('customCategoryText');
            
            if (categorySelect.value === 'custom') {
                customInput.style.display = 'block';
            } else {
                customInput.style.display = 'none';
            }
        }

        // Êõ¥Êñ∞‰∏ªÈ°åÈÅ∏È†ÖÔºàÊ†πÊìöÁßëÂà•Ôºâ
        function updateTopicOptions() {
            const category = document.getElementById('category').value;
            const topicSelect = document.getElementById('topic');
            
            // Ê∏ÖÁ©∫ÁèæÊúâÈÅ∏È†Ö
            topicSelect.innerHTML = '';
            
            if (category === 'custom') {
                // Â¶ÇÊûúÊòØËá™ÂÆöÁæ©ÁßëÂà•ÔºåÈ°ØÁ§∫ÈÄöÁî®ÈÅ∏È†Ö
                topicSelect.innerHTML = '<option value="custom">Ëá™ÂÆöÁæ© (Custom)</option>';
                document.getElementById('customTopicText').style.display = 'block';
            } else if (topicOptions[category]) {
                // Ê†πÊìöÁßëÂà•Ê∑ªÂä†Â∞çÊáâ‰∏ªÈ°å
                topicOptions[category].forEach(topic => {
                    const option = document.createElement('option');
                    option.value = topic;
                    option.textContent = topic;
                    topicSelect.appendChild(option);
                });
                
                // Ê∑ªÂä†Ëá™ÂÆöÁæ©ÈÅ∏È†Ö
                const customOption = document.createElement('option');
                customOption.value = 'custom';
                customOption.textContent = 'Ëá™ÂÆöÁæ© (Custom)';
                topicSelect.appendChild(customOption);
                
                document.getElementById('customTopicText').style.display = 'none';
            }
        }

        // ËôïÁêÜ‰∏ªÈ°åÈÅ∏ÊìáËÆäÂåñ
        function handleTopicChange() {
            const topicSelect = document.getElementById('topic');
            const customInput = document.getElementById('customTopicText');
            
            if (topicSelect.value === 'custom') {
                customInput.style.display = 'block';
            } else {
                customInput.style.display = 'none';
            }
        }

        // ËôïÁêÜÊôÇÈï∑ÈÅ∏ÊìáËÆäÂåñ
        function handleDurationChange() {
            const durationSelect = document.getElementById('duration');
            const customInput = document.getElementById('customDurationText');
            
            if (durationSelect.value === 'custom') {
                customInput.style.display = 'block';
            } else {
                customInput.style.display = 'none';
            }
        }

        // ËôïÁêÜÈ¢®Ê†ºÈÅ∏ÊìáËÆäÂåñ
        function handleStyleChange() {
            const styleSelect = document.getElementById('style');
            const customInput = document.getElementById('customStyleText');
            
            if (styleSelect.value === 'custom') {
                customInput.style.display = 'block';
            } else {
                customInput.style.display = 'none';
            }
        }

        // ÁîüÊàêË™≤Á®ãÂÖßÂÆπ
        async function generateCourse() {
            const btn = document.getElementById('generateCourseBtn');
            const preview = document.getElementById('coursePreview');
            const status = document.getElementById('courseStatus');
            
            // Áç≤ÂèñË°®ÂñÆÊï∏Êìö
            let targetAge = document.getElementById('targetAge').value;
            if (targetAge === 'custom') {
                const customAge = document.getElementById('customAgeText').value;
                targetAge = customAge || '6-8'; // ÈªòË™çÂÄº
            }

            let category = document.getElementById('category').value;
            if (category === 'custom') {
                const customCategory = document.getElementById('customCategoryText').value.trim();
                category = customCategory || 'social';
            }

            let topic = document.getElementById('topic').value;
            if (topic === 'custom') {
                const customTopic = document.getElementById('customTopicText').value.trim();
                topic = customTopic || '‰∏ªÈ°å';
            }

            let duration = document.getElementById('duration').value;
            if (duration === 'custom') {
                const customDuration = document.getElementById('customDurationText').value;
                duration = customDuration || '60';
            }

            let style = document.getElementById('style').value;
            if (style === 'custom') {
                const customStyle = document.getElementById('customStyleText').value.trim();
                style = customStyle || 'story-based';
            }

            const outputTypesCheckboxes = document.querySelectorAll('input[name="outputTypes"]:checked');
            const outputTypes = Array.from(outputTypesCheckboxes).map(cb => cb.value);

            if (outputTypes.length === 0) {
                alert('Ë´ãËá≥Â∞ëÈÅ∏Êìá‰∏ÄÁ®ÆËº∏Âá∫Ê†ºÂºè');
                return;
            }

            const language = document.getElementById('courseLanguage').value;
            const includeImages = document.getElementById('includeImages').value;

            // È°ØÁ§∫ÁîüÊàê‰∏≠ÁãÄÊÖã
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span> ÁîüÊàê‰∏≠...';
            
            status.style.display = 'block';
            status.className = 'info';
            status.innerHTML = 'ü§ñ AI Ê≠£Âú®ÁîüÊàêË™≤Á®ãÂÖßÂÆπÔºåË´ãÁ®çÂÄô...';
            
            preview.innerHTML = '<p style="text-align: center; padding: 40px;"><span class="loading"></span><br>AI ÁîüÊàê‰∏≠...</p>';

            try {
                const response = await AuthManager.authFetch('/api/generate-course', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        targetAge,
                        category,
                        topic,
                        duration,
                        style,
                        outputTypes,
                        language,
                        includeImages
                    })
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.message || 'Ë™≤Á®ãÁîüÊàêÂ§±Êïó');
                }

                // ‰øùÂ≠òË™≤Á®ãÊï∏Êìö
                generatedCourseData = data.course;

                // È°ØÁ§∫Ë™≤Á®ãÂÖßÂÆπ
                displayCourseContent(data.course);

                // È°ØÁ§∫‰∏ãËºâÊåâÈàï
                document.getElementById('downloadActions').style.display = 'flex';

                status.className = 'success';
                status.innerHTML = '‚úÖ Ë™≤Á®ãÂÖßÂÆπÁîüÊàêÊàêÂäüÔºÅ';

            } catch (error) {
                console.error('Course generation error:', error);
                status.className = 'error';
                status.innerHTML = `‚ùå ÈåØË™§: ${error.message}`;
                preview.innerHTML = `<p style="text-align: center; color: #d32f2f; padding: 40px;">ÁîüÊàêÂ§±Êïó: ${error.message}</p>`;
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'üéì ÁîüÊàêË™≤Á®ã Generate Course';
            }
        }

        // È°ØÁ§∫Ë™≤Á®ãÂÖßÂÆπ
        function displayCourseContent(course) {
            const preview = document.getElementById('coursePreview');
            
            console.log('üìä Course data:', course);
            console.log('üé® Images data:', course.images);
            
            // Â∞áMarkdownÊ†ºÂºèÁöÑÂÖßÂÆπËΩâÊèõÁÇ∫HTMLÈ°ØÁ§∫
            const contentHTML = formatCourseContent(course.content);
            
            // Ê∫ñÂÇôÂúñÁâáHTMLÔºàÂ¶ÇÊûúÊúâÁöÑË©±Ôºâ
            let imagesHTML = '';
            if (course.images && course.images.length > 0) {
                console.log(`‚úÖ Found ${course.images.length} images`);
                imagesHTML = '<div style="margin: 20px 0;"><h3 style="color: #444; margin-bottom: 15px;">üé® AI ÁîüÊàêÊèíÂúñ</h3>';
                course.images.forEach((img, index) => {
                    console.log(`Image ${index + 1}:`, img.downloadUrl);
                    imagesHTML += `
                        <div style="margin: 15px 0; text-align: center;">
                            <img src="${img.downloadUrl}" alt="Ë™≤Á®ãÊèíÂúñ ${index + 1}" 
                                 style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);" 
                                 onerror="console.error('Failed to load image:', '${img.downloadUrl}')" />
                            <p style="color: #666; font-size: 12px; margin-top: 5px;">ÊèíÂúñ ${index + 1}</p>
                        </div>
                    `;
                });
                imagesHTML += '</div>';
            } else {
                console.warn('‚ùå No images found in course data');
            }
            
            preview.innerHTML = `
                <div style="background: white; padding: 20px; border-radius: 10px;">
                    <h2 style="color: #333; border-bottom: 2px solid #87CEEB; padding-bottom: 10px;">
                        ${course.title}
                    </h2>
                    ${imagesHTML}
                    <div style="margin-top: 20px; line-height: 1.8;">
                        ${contentHTML}
                    </div>
                </div>
            `;
        }

        // Ê†ºÂºèÂåñË™≤Á®ãÂÖßÂÆπÔºàÁ∞°ÂåñÁâàMarkdownËΩâHTMLÔºâ
        function formatCourseContent(content) {
            let html = content
                // Ê®ôÈ°åËΩâÊèõ
                .replace(/^### (.+)$/gm, '<h4 style="color: #555; margin-top: 20px;">$1</h4>')
                .replace(/^## (.+)$/gm, '<h3 style="color: #444; margin-top: 25px;">$1</h3>')
                .replace(/^# (.+)$/gm, '<h2 style="color: #333; margin-top: 30px;">$1</h2>')
                // Á≤óÈ´î
                .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
                // ÂàóË°®È†Ö
                .replace(/^[-*] (.+)$/gm, '<li style="margin-left: 20px;">$1</li>')
                // ÊèõË°å
                .replace(/\n\n/g, '<br><br>');
            
            return html;
        }

        // ‰∏ãËºâWordÊñáÊ™î
        async function downloadWord() {
            if (!generatedCourseData) {
                alert('Ë´ãÂÖàÁîüÊàêË™≤Á®ãÂÖßÂÆπ');
                return;
            }

            const status = document.getElementById('courseStatus');
            status.style.display = 'block';
            status.className = 'info';
            status.innerHTML = 'üìÑ Ê≠£Âú®ÁîüÊàê Word ÊñáÊ™î...';

            try {
                const response = await fetch('/api/export-document', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        courseData: generatedCourseData,
                        format: 'word'
                    })
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.message || 'Word Â∞éÂá∫Â§±Êïó');
                }

                // ‰∏ãËºâÊñá‰ª∂
                window.location.href = data.downloadUrl;

                status.className = 'success';
                status.innerHTML = '‚úÖ Word ÊñáÊ™îÂ∑≤ÁîüÊàêÔºåÊ≠£Âú®‰∏ãËºâ...';

            } catch (error) {
                console.error('Word export error:', error);
                status.className = 'error';
                status.innerHTML = `‚ùå ÈåØË™§: ${error.message}`;
            }
        }

        // ‰∏ãËºâPDFÊñáÊ™î
        async function downloadPDF() {
            if (!generatedCourseData) {
                alert('Ë´ãÂÖàÁîüÊàêË™≤Á®ãÂÖßÂÆπ');
                return;
            }

            const status = document.getElementById('courseStatus');
            status.style.display = 'block';
            status.className = 'info';
            status.innerHTML = 'üìï Ê≠£Âú®ÁîüÊàê PDF ÊñáÊ™î...';

            try {
                const response = await fetch('/api/export-document', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        courseData: generatedCourseData,
                        format: 'pdf'
                    })
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.message || 'PDF Â∞éÂá∫Â§±Êïó');
                }

                // ‰∏ãËºâÊñá‰ª∂
                window.location.href = data.downloadUrl;

                status.className = 'success';
                status.innerHTML = '‚úÖ PDF ÊñáÊ™îÂ∑≤ÁîüÊàêÔºåÊ≠£Âú®‰∏ãËºâ...';

            } catch (error) {
                console.error('PDF export error:', error);
                status.className = 'error';
                status.innerHTML = `‚ùå ÈåØË™§: ${error.message}`;
            }
        }

        // ==================== Page 4: BizPrompt Architect Pro ====================
        
        // Áï∂ÂâçÁîüÊàêÁöÑ Prompt ÂÖßÂÆπ
        let currentGeneratedPrompt = '';
        let currentPromptMode = 'business';

        // ÂïÜÊ•≠È°ßÂïèÊ®°ÂºèÁöÑÂ±§Á¥öÊï∏Êìö - Êï¥ÂêàÁî®Êà∂ÁâπÂÆöË°åÊ•≠ÈúÄÊ±Ç
        const bizData = {
            // ==================== Áî®Êà∂Ê†∏ÂøÉË°åÊ•≠ ====================
            ecommerce: {
                label: 'biz_domain_ecommerce',
                industries: {
                    'fashion-footwear': { label: 'biz_ind_fashion_footwear', roles: ['ecom-manager', 'fashion-buyer', 'visual-merchandiser', 'product-stylist', 'category-manager', 'custom'] },
                    'mother-baby': { label: 'biz_ind_mother_baby', roles: ['baby-product-manager', 'parent-community', 'safety-specialist', 'content-creator', 'kol-manager', 'custom'] },
                    'pet-industry': { label: 'biz_ind_pet', roles: ['pet-product-manager', 'pet-community', 'vet-consultant', 'pet-content', 'pet-influencer', 'custom'] },
                    'art-toy': { label: 'biz_ind_art_toy', roles: ['toy-designer', 'ip-manager', 'collector-community', 'limited-edition', 'collab-manager', 'custom'] },
                    'tiktok-shop': { label: 'biz_ind_tiktok_shop', roles: ['tiktok-operator', 'live-host', 'short-video', 'affiliate-tiktok', 'tiktok-ads', 'custom'] },
                    'shopee': { label: 'biz_ind_shopee', roles: ['shopee-operator', 'shopee-ads', 'flash-sale', 'shopee-live', 'seller-support', 'custom'] },
                    'fb-marketplace': { label: 'biz_ind_fb_marketplace', roles: ['fb-shop-manager', 'fb-ads-specialist', 'community-sales', 'messenger-sales', 'fb-live', 'custom'] },
                    'custom': { label: 'biz_custom', roles: ['custom'] }
                }
            },
            marketing: {
                label: 'biz_domain_marketing',
                industries: {
                    'seo-geo': { label: 'biz_ind_seo_geo', roles: ['seo-specialist', 'geo-specialist', 'local-seo', 'technical-seo', 'content-seo', 'custom'] },
                    'social-marketing': { label: 'biz_ind_social_marketing', roles: ['social-media', 'influencer-manager', 'community-manager', 'content-marketer', 'viral-specialist', 'custom'] },
                    'performance': { label: 'biz_ind_performance', roles: ['performance-marketer', 'paid-media', 'growth-hacker', 'conversion-optimizer', 'marketing-analyst', 'custom'] },
                    'brand-marketing': { label: 'biz_ind_brand_marketing', roles: ['brand-manager', 'brand-strategist', 'creative-director', 'campaign-manager', 'pr-specialist', 'custom'] },
                    'content-marketing': { label: 'biz_ind_content_marketing', roles: ['content-strategist', 'copywriter', 'video-producer', 'podcast-host', 'newsletter-manager', 'custom'] },
                    'custom': { label: 'biz_custom', roles: ['custom'] }
                }
            },
            product: {
                label: 'biz_domain_product',
                industries: {
                    'fashion-product': { label: 'biz_ind_fashion_product', roles: ['fashion-pm', 'trend-analyst', 'sourcing-manager', 'quality-controller', 'supply-chain', 'custom'] },
                    'baby-product': { label: 'biz_ind_baby_product', roles: ['baby-pm', 'safety-pm', 'parent-researcher', 'packaging-designer', 'compliance-pm', 'custom'] },
                    'pet-product': { label: 'biz_ind_pet_product', roles: ['pet-pm', 'pet-nutritionist', 'pet-safety', 'pet-ux', 'pet-innovation', 'custom'] },
                    'toy-product': { label: 'biz_ind_toy_product', roles: ['toy-pm', 'play-researcher', 'ip-developer', 'manufacturing-pm', 'collector-pm', 'custom'] },
                    'tech-product': { label: 'biz_ind_tech_product', roles: ['pm', 'senior-pm', 'product-lead', 'technical-pm', 'platform-pm', 'custom'] },
                    'custom': { label: 'biz_custom', roles: ['custom'] }
                }
            },
            design: {
                label: 'biz_domain_design',
                industries: {
                    'product-design': { label: 'biz_ind_product_design', roles: ['industrial-designer', 'cad-engineer', '3d-modeler', 'prototype-specialist', 'material-designer', 'custom'] },
                    'fashion-design': { label: 'biz_ind_fashion_design', roles: ['fashion-designer', 'pattern-maker', 'textile-designer', 'accessory-designer', 'footwear-designer', 'custom'] },
                    'toy-design': { label: 'biz_ind_toy_design', roles: ['toy-sculptor', 'character-designer', 'packaging-designer', 'color-specialist', 'articulation-designer', 'custom'] },
                    'ux-ui': { label: 'biz_ind_ux_ui', roles: ['ux-designer', 'ui-designer', 'interaction-designer', 'design-system', 'user-researcher', 'custom'] },
                    'graphic-design': { label: 'biz_ind_graphic_design', roles: ['graphic-designer', 'brand-designer', 'motion-designer', 'illustration', 'print-designer', 'custom'] },
                    'custom': { label: 'biz_custom', roles: ['custom'] }
                }
            },
            development: {
                label: 'biz_domain_development',
                industries: {
                    'vibe-coding': { label: 'biz_ind_vibe_coding', roles: ['vibe-developer', 'ai-pair-programmer', 'prompt-engineer', 'rapid-prototyper', 'no-code-builder', 'custom'] },
                    'web-dev': { label: 'biz_ind_web_dev', roles: ['frontend-dev', 'backend-dev', 'fullstack-dev', 'web-architect', 'devops', 'custom'] },
                    'mobile-dev': { label: 'biz_ind_mobile_dev', roles: ['ios-dev', 'android-dev', 'react-native', 'flutter-dev', 'mobile-architect', 'custom'] },
                    'ai-ml': { label: 'biz_ind_ai_ml', roles: ['ml-engineer', 'data-scientist', 'ai-researcher', 'mlops-engineer', 'nlp-specialist', 'custom'] },
                    'ecommerce-dev': { label: 'biz_ind_ecommerce_dev', roles: ['shopify-dev', 'woocommerce-dev', 'api-integrator', 'payment-specialist', 'erp-developer', 'custom'] },
                    'custom': { label: 'biz_custom', roles: ['custom'] }
                }
            },
            strategy: {
                label: 'biz_domain_strategy',
                industries: {
                    'ecom-strategy': { label: 'biz_ind_ecom_strategy', roles: ['ecom-strategist', 'marketplace-analyst', 'pricing-strategist', 'expansion-manager', 'omnichannel-lead', 'custom'] },
                    'brand-strategy': { label: 'biz_ind_brand_strategy', roles: ['brand-strategist', 'positioning-expert', 'competitive-analyst', 'market-researcher', 'trend-forecaster', 'custom'] },
                    'growth-strategy': { label: 'biz_ind_growth_strategy', roles: ['growth-strategist', 'acquisition-lead', 'retention-lead', 'monetization-lead', 'partnerships-lead', 'custom'] },
                    'consulting': { label: 'biz_ind_consulting', roles: ['strategy-consultant', 'management-consultant', 'digital-consultant', 'change-manager', 'process-consultant', 'custom'] },
                    'startup': { label: 'biz_ind_startup', roles: ['founder', 'coo', 'business-dev', 'chief-strategy', 'venture-partner', 'custom'] },
                    'custom': { label: 'biz_custom', roles: ['custom'] }
                }
            },
            finance: {
                label: 'biz_domain_finance',
                industries: {
                    'ecom-finance': { label: 'biz_ind_ecom_finance', roles: ['ecom-controller', 'marketplace-analyst', 'payment-ops', 'fraud-analyst', 'revenue-ops', 'custom'] },
                    'corporate-finance': { label: 'biz_ind_corporate_finance', roles: ['cfo', 'fp-analyst', 'controller', 'treasury-manager', 'investor-relations', 'custom'] },
                    'accounting': { label: 'biz_ind_accounting', roles: ['auditor', 'tax-advisor', 'bookkeeper', 'management-accountant', 'compliance-officer', 'custom'] },
                    'investment': { label: 'biz_ind_investment', roles: ['analyst', 'portfolio-manager', 'research-analyst', 'quant-analyst', 'risk-manager', 'custom'] },
                    'business-finance': { label: 'biz_ind_business_finance', roles: ['budget-analyst', 'cost-analyst', 'profitability-analyst', 'cash-flow-manager', 'financial-planner', 'custom'] },
                    'custom': { label: 'biz_custom', roles: ['custom'] }
                }
            },
            hr: {
                label: 'biz_domain_hr',
                industries: {
                    'talent-acquisition': { label: 'biz_ind_talent_acquisition', roles: ['recruiter', 'hr-manager', 'sourcing-specialist', 'employer-branding', 'campus-recruiter', 'custom'] },
                    'org-development': { label: 'biz_ind_org_development', roles: ['od-specialist', 'hr-bp', 'culture-manager', 'engagement-specialist', 'change-consultant', 'custom'] },
                    'compensation': { label: 'biz_ind_compensation', roles: ['comp-analyst', 'benefits-specialist', 'total-rewards', 'payroll-manager', 'equity-admin', 'custom'] },
                    'learning': { label: 'biz_ind_learning', roles: ['learning-designer', 'training-manager', 'leadership-coach', 'lms-admin', 'performance-consultant', 'custom'] },
                    'hr-tech': { label: 'biz_ind_hr_tech', roles: ['hris-analyst', 'people-analytics', 'hr-systems', 'digital-hr', 'ai-hr-specialist', 'custom'] },
                    'custom': { label: 'biz_custom', roles: ['custom'] }
                }
            }
        };

        // ËßíËâ≤Â∞çÊáâÁöÑÊ°ÜÊû∂/Ê®°Âûã - Êì¥Â±ïÁâàÔºàÊØèÂÄãËßíËâ≤Ëá≥Â∞ë5ÂÄãÊ°ÜÊû∂ÈÅ∏È†Ö+Ëá™ÂÆöÁæ©Ôºâ
        const roleFrameworks = {
            // Marketing roles
            'growth-hacker': ['AARRR', 'North Star Metric', 'Growth Loop', 'Viral Coefficient', 'Activation Funnel', 'custom'],
            'content-marketer': ['Content Pillar', 'Topic Cluster', 'Editorial Calendar', 'Content Matrix', 'SEO Strategy', 'custom'],
            'demand-gen': ['Lead Scoring', 'MQL/SQL', 'Funnel Optimization', 'ABM Strategy', 'Nurture Workflow', 'custom'],
            'seo-specialist': ['Keyword Research', 'Technical SEO Audit', 'Link Building', 'Content Gap Analysis', 'SERP Analysis', 'custom'],
            'marketing-analyst': ['Marketing Mix Model', 'Attribution Analysis', 'Customer Segmentation', 'Campaign ROI', 'Cohort Analysis', 'custom'],
            'performance-marketer': ['ROAS Optimization', 'Attribution Model', 'LTV:CAC', 'Budget Allocation', 'Creative Testing', 'custom'],
            'brand-manager': ['Brand Equity Model', 'Brand Architecture', 'Positioning Map', 'Brand Pyramid', 'Competitive Mapping', 'custom'],
            'social-media': ['Content Calendar', 'Engagement Strategy', 'Influencer Matrix', 'Community Playbook', 'Crisis Management', 'custom'],
            'affiliate-manager': ['Commission Structure', 'Partner Recruitment', 'Performance Tracking', 'Affiliate Tier System', 'Payout Optimization', 'custom'],
            'crm-specialist': ['Customer Journey Map', 'Lifecycle Marketing', 'Personalization Engine', 'Retention Strategy', 'Win-back Campaign', 'custom'],
            'product-marketer': ['GTM Strategy', 'Competitive Analysis', 'Messaging Framework', 'Launch Playbook', 'Sales Enablement', 'custom'],
            'acquisition': ['CAC Analysis', 'Channel Mix', 'Conversion Funnel', 'Paid Media Strategy', 'Growth Experiments', 'custom'],
            'retention': ['Cohort Analysis', 'Churn Prediction', 'Retention Hooks', 'Customer Health Score', 'Engagement Loops', 'custom'],
            'compliance-marketer': ['Regulatory Compliance', 'Risk Assessment', 'Approval Workflow', 'Audit Trail', 'Policy Framework', 'custom'],
            'partnership-manager': ['Partner Ecosystem', 'Co-marketing Strategy', 'Revenue Share Model', 'Integration Roadmap', 'Partner Success', 'custom'],
            'healthcare-marketer': ['Patient Journey', 'HCP Engagement', 'Compliance Framework', 'Outcomes Marketing', 'Digital Health Strategy', 'custom'],
            'patient-acquisition': ['Referral Network', 'Community Outreach', 'Patient Funnel', 'Reputation Management', 'Appointment Optimization', 'custom'],
            'medical-writer': ['Clinical Documentation', 'Regulatory Writing', 'Patient Education', 'Scientific Communication', 'Content Validation', 'custom'],
            'pharma-marketer': ['KOL Engagement', 'Clinical Trial Marketing', 'Formulary Strategy', 'Multichannel Marketing', 'Compliance Protocol', 'custom'],
            'health-educator': ['Health Literacy Framework', 'Behavior Change Model', 'Community Education', 'Digital Health Tools', 'Outcome Measurement', 'custom'],
            'edu-marketer': ['Enrollment Funnel', 'Student Journey', 'Campus Marketing', 'Alumni Engagement', 'Program Promotion', 'custom'],
            'enrollment-specialist': ['Admission Strategy', 'Yield Optimization', 'Scholarship Framework', 'Application Process', 'Student Retention', 'custom'],
            'alumni-relations': ['Alumni Network', 'Giving Strategy', 'Event Planning', 'Mentorship Program', 'Career Services', 'custom'],
            'content-developer': ['Curriculum Design', 'Learning Objectives', 'Assessment Framework', 'Content Mapping', 'Accessibility Standards', 'custom'],
            'community-manager': ['Community Guidelines', 'Engagement Playbook', 'Moderation Framework', 'Growth Strategy', 'Member Journey', 'custom'],
            // Strategy roles
            'strategy-consultant': ['SWOT', 'Porter Five Forces', 'BCG Matrix', 'McKinsey 7S', 'Value Chain Analysis', 'custom'],
            'management-consultant': ['MECE', 'Hypothesis-driven', 'Issue Tree', 'Pyramid Principle', 'Change Management', 'custom'],
            'digital-consultant': ['Digital Maturity Model', 'Technology Roadmap', 'Digital Transformation', 'Agile Methodology', 'Innovation Framework', 'custom'],
            'change-manager': ['ADKAR Model', 'Kotter 8-Step', 'Change Impact Assessment', 'Stakeholder Analysis', 'Resistance Management', 'custom'],
            'process-consultant': ['Lean Six Sigma', 'Process Mapping', 'Value Stream Analysis', 'Kaizen', 'BPR Framework', 'custom'],
            'founder': ['Lean Canvas', 'Business Model Canvas', 'OKR', 'MVP Strategy', 'Pitch Deck Framework', 'custom'],
            'coo': ['Operations Framework', 'Process Optimization', 'KPI Dashboard', 'Resource Planning', 'Operational Excellence', 'custom'],
            'business-dev': ['Partnership Framework', 'Deal Structure', 'Revenue Model', 'Market Entry Strategy', 'Channel Strategy', 'custom'],
            'chief-strategy': ['Corporate Strategy', 'M&A Framework', 'Portfolio Management', 'Strategic Planning', 'Competitive Intelligence', 'custom'],
            'venture-partner': ['Due Diligence', 'Portfolio Strategy', 'Value Creation', 'Exit Planning', 'Syndication Strategy', 'custom'],
            'corporate-strategist': ['Ansoff Matrix', 'Value Chain', 'Scenario Planning', 'Blue Ocean Strategy', 'Core Competency Analysis', 'custom'],
            'biz-analyst': ['Data Analysis', 'Business Case', 'ROI Model', 'Requirements Gathering', 'Gap Analysis', 'custom'],
            'transformation-lead': ['Transformation Roadmap', 'Change Readiness', 'Digital Strategy', 'Operating Model', 'Culture Transformation', 'custom'],
            'innovation-manager': ['Design Thinking', 'Innovation Funnel', 'Open Innovation', 'Technology Scouting', 'Intrapreneurship', 'custom'],
            'market-intelligence': ['Competitive Analysis', 'Market Sizing', 'Trend Analysis', 'Customer Intelligence', 'Strategic Foresight', 'custom'],
            'pe-analyst': ['LBO Model', 'Deal Screening', 'Industry Analysis', 'Investment Thesis', 'Financial Modeling', 'custom'],
            'due-diligence': ['Commercial DD', 'Financial DD', 'Operational DD', 'Legal DD', 'Technology DD', 'custom'],
            'portfolio-ops': ['Value Creation Plan', 'Performance Monitoring', 'Best Practice Sharing', 'Exit Readiness', 'Management Assessment', 'custom'],
            'deal-sourcing': ['Deal Flow Management', 'Relationship Building', 'Market Mapping', 'Proprietary Sourcing', 'Intermediary Network', 'custom'],
            'value-creation': ['100-Day Plan', 'Revenue Enhancement', 'Cost Optimization', 'Digital Enablement', 'Organizational Design', 'custom'],
            'policy-analyst': ['Policy Analysis Framework', 'Impact Assessment', 'Stakeholder Mapping', 'Regulatory Analysis', 'Policy Recommendation', 'custom'],
            'program-manager': ['Program Governance', 'Benefits Realization', 'Risk Management', 'Resource Allocation', 'Performance Metrics', 'custom'],
            'public-affairs': ['Government Relations', 'Advocacy Strategy', 'Public Communication', 'Coalition Building', 'Issue Management', 'custom'],
            'regulatory-advisor': ['Compliance Framework', 'Regulatory Strategy', 'Risk Assessment', 'Policy Interpretation', 'Regulatory Filing', 'custom'],
            'strategic-planner': ['Long-term Planning', 'Scenario Analysis', 'Resource Allocation', 'Performance Framework', 'Strategic Alignment', 'custom'],
            // Sales roles
            'account-exec': ['SPIN Selling', 'Challenger Sale', 'MEDDIC', 'Solution Selling', 'Value Selling', 'custom'],
            'sales-engineer': ['Solution Selling', 'Technical Demo', 'POC Framework', 'Technical Discovery', 'Integration Planning', 'custom'],
            'sales-manager': ['Pipeline Management', 'Forecast Model', 'Territory Planning', 'Team Coaching', 'Sales Enablement', 'custom'],
            'enterprise-sales': ['Strategic Account Planning', 'Executive Alignment', 'Complex Deal Strategy', 'Procurement Navigation', 'Multi-threading', 'custom'],
            'channel-manager': ['Partner Program', 'Channel Strategy', 'Partner Enablement', 'Deal Registration', 'Channel Conflict Resolution', 'custom'],
            'retail-sales': ['Customer Engagement', 'Upselling Strategy', 'Visual Merchandising', 'Customer Loyalty', 'In-store Experience', 'custom'],
            'inside-sales': ['Call Scripts', 'Lead Qualification', 'CRM Management', 'Email Sequences', 'Virtual Selling', 'custom'],
            'telesales': ['Objection Handling', 'Script Optimization', 'Call Metrics', 'Appointment Setting', 'Follow-up Strategy', 'custom'],
            'showroom-manager': ['Floor Planning', 'Staff Scheduling', 'Customer Flow', 'Display Strategy', 'Sales Training', 'custom'],
            'customer-success': ['Onboarding Framework', 'Health Score', 'Expansion Strategy', 'Churn Prevention', 'QBR Process', 'custom'],
            'sdr': ['Outbound Prospecting', 'Cold Calling', 'Email Cadence', 'Social Selling', 'Lead Qualification', 'custom'],
            'bdr': ['Inbound Qualification', 'Lead Routing', 'Discovery Calls', 'Meeting Booking', 'Handoff Process', 'custom'],
            'account-manager': ['Account Planning', 'Relationship Building', 'Renewal Strategy', 'Cross-sell Framework', 'Customer Advocacy', 'custom'],
            'renewal-specialist': ['Renewal Playbook', 'At-risk Identification', 'Negotiation Strategy', 'Contract Management', 'Pricing Strategy', 'custom'],
            'solution-architect': ['Technical Design', 'Solution Mapping', 'Architecture Review', 'Integration Strategy', 'Scalability Planning', 'custom'],
            'real-estate-agent': ['Property Valuation', 'Market Analysis', 'Client Matching', 'Negotiation Strategy', 'Closing Process', 'custom'],
            'property-consultant': ['Investment Analysis', 'Portfolio Strategy', 'Market Trends', 'Due Diligence', 'Asset Management', 'custom'],
            'leasing-specialist': ['Lease Negotiation', 'Tenant Screening', 'Rent Optimization', 'Lease Renewal', 'Property Marketing', 'custom'],
            'investment-advisor': ['Investment Strategy', 'Risk Assessment', 'Portfolio Diversification', 'Market Timing', 'Exit Strategy', 'custom'],
            'development-sales': ['Pre-sale Strategy', 'Project Marketing', 'Buyer Qualification', 'Contract Negotiation', 'Settlement Process', 'custom'],
            'wholesale-rep': ['Territory Management', 'Dealer Relations', 'Volume Pricing', 'Inventory Management', 'Trade Shows', 'custom'],
            'key-account': ['Strategic Account Management', 'JBP Planning', 'Category Management', 'Trade Terms', 'Promotional Planning', 'custom'],
            'distributor-manager': ['Distribution Network', 'Partner Performance', 'Inventory Optimization', 'Market Coverage', 'Distributor Development', 'custom'],
            'trade-marketing': ['Trade Promotions', 'Retail Execution', 'POS Materials', 'Category Strategy', 'Shopper Marketing', 'custom'],
            'territory-manager': ['Territory Planning', 'Route Optimization', 'Coverage Strategy', 'Performance Tracking', 'Market Penetration', 'custom'],
            // Product roles
            'pm': ['PRD Template', 'User Story Mapping', 'Prioritization Matrix', 'Sprint Planning', 'Feature Specification', 'custom'],
            'senior-pm': ['Product Strategy', 'Roadmap Planning', 'Stakeholder Management', 'Go-to-Market', 'Competitive Positioning', 'custom'],
            'product-lead': ['Product Vision', 'Team Alignment', 'Metrics Framework', 'Portfolio Management', 'Innovation Pipeline', 'custom'],
            'technical-pm': ['Technical Requirements', 'API Strategy', 'System Architecture', 'Performance Optimization', 'Security Requirements', 'custom'],
            'platform-pm': ['Platform Strategy', 'Developer Experience', 'API Design', 'Ecosystem Development', 'Integration Framework', 'custom'],
            'consumer-pm': ['User Research', 'A/B Testing', 'Feature Prioritization', 'User Journey', 'Engagement Metrics', 'custom'],
            'ux-researcher': ['User Interview', 'Usability Testing', 'Survey Design', 'Persona Development', 'Journey Mapping', 'custom'],
            'growth-pm': ['Growth Experiments', 'Funnel Analysis', 'Activation Metrics', 'Retention Strategy', 'Viral Loops', 'custom'],
            'mobile-pm': ['Mobile UX', 'App Store Optimization', 'Push Strategy', 'Mobile Analytics', 'Cross-platform Strategy', 'custom'],
            'product-analyst': ['Product Analytics', 'Feature Adoption', 'User Segmentation', 'Funnel Analysis', 'Cohort Analysis', 'custom'],
            'enterprise-pm': ['Enterprise Requirements', 'Security Compliance', 'Integration Strategy', 'SLA Management', 'Customer Success', 'custom'],
            'api-pm': ['API Design', 'Developer Portal', 'Rate Limiting', 'Versioning Strategy', 'Documentation', 'custom'],
            'integration-pm': ['Integration Architecture', 'Partner API', 'Webhook Strategy', 'Data Mapping', 'Error Handling', 'custom'],
            'partner-pm': ['Partner Requirements', 'White-label Strategy', 'Co-development', 'Partner Success', 'Revenue Sharing', 'custom'],
            'product-ops': ['Product Operations', 'Process Optimization', 'Tool Management', 'Data Governance', 'Cross-functional Alignment', 'custom'],
            'hardware-pm': ['Hardware Requirements', 'Manufacturing Process', 'Supply Chain', 'Quality Assurance', 'Product Lifecycle', 'custom'],
            'iot-pm': ['IoT Architecture', 'Device Management', 'Connectivity Strategy', 'Edge Computing', 'Security Framework', 'custom'],
            'embedded-pm': ['Embedded Systems', 'Firmware Strategy', 'Hardware-Software Integration', 'Real-time Requirements', 'Power Management', 'custom'],
            'manufacturing-liaison': ['Manufacturing Process', 'Quality Control', 'Cost Optimization', 'Supplier Management', 'Production Planning', 'custom'],
            'quality-pm': ['Quality Framework', 'Testing Strategy', 'Defect Management', 'Quality Metrics', 'Continuous Improvement', 'custom'],
            'data-pm': ['Data Strategy', 'Data Pipeline', 'Data Quality', 'Data Governance', 'Analytics Platform', 'custom'],
            'ml-pm': ['ML Pipeline', 'Model Development', 'MLOps', 'Feature Engineering', 'Model Monitoring', 'custom'],
            'analytics-pm': ['Analytics Strategy', 'BI Tools', 'Dashboard Design', 'Self-service Analytics', 'Data Democratization', 'custom'],
            'bi-product-manager': ['BI Architecture', 'Reporting Framework', 'KPI Definition', 'Data Visualization', 'Insight Generation', 'custom'],
            'data-strategy': ['Data Architecture', 'Data Monetization', 'Data Partnerships', 'Privacy Framework', 'Data Ethics', 'custom'],
            // Finance roles
            'analyst': ['DCF Model', 'Comparable Analysis', 'Risk Assessment', 'Financial Modeling', 'Valuation Methods', 'custom'],
            'portfolio-manager': ['Asset Allocation', 'Risk Management', 'Performance Attribution', 'Rebalancing Strategy', 'Factor Investing', 'custom'],
            'research-analyst': ['Equity Research', 'Industry Analysis', 'Company Valuation', 'Investment Thesis', 'Earnings Model', 'custom'],
            'quant-analyst': ['Quantitative Models', 'Statistical Analysis', 'Algorithmic Trading', 'Risk Models', 'Backtesting', 'custom'],
            'risk-manager': ['Risk Framework', 'VaR Analysis', 'Stress Testing', 'Risk Reporting', 'Hedging Strategy', 'custom'],
            'cfo': ['Financial Planning', 'Capital Structure', 'Investor Relations', 'Treasury Management', 'Strategic Finance', 'custom'],
            'fp-analyst': ['Budget Planning', 'Variance Analysis', 'Forecasting', 'Financial Reporting', 'Business Partnering', 'custom'],
            'controller': ['Financial Controls', 'Close Process', 'Compliance', 'Audit Management', 'Policy Development', 'custom'],
            'treasury-manager': ['Cash Management', 'Liquidity Planning', 'FX Management', 'Banking Relations', 'Working Capital', 'custom'],
            'investor-relations': ['Investor Communication', 'Earnings Guidance', 'Shareholder Analysis', 'IR Strategy', 'ESG Reporting', 'custom'],
            'relationship-manager': ['Client Relationship', 'Needs Assessment', 'Product Recommendation', 'Portfolio Review', 'Client Retention', 'custom'],
            'credit-analyst': ['Credit Assessment', 'Risk Rating', 'Financial Analysis', 'Covenant Monitoring', 'Credit Policy', 'custom'],
            'trade-finance': ['Trade Products', 'LC Documentation', 'Risk Mitigation', 'Working Capital', 'Supply Chain Finance', 'custom'],
            'private-banker': ['Wealth Planning', 'Investment Advisory', 'Tax Planning', 'Estate Planning', 'Family Governance', 'custom'],
            'loan-officer': ['Loan Origination', 'Underwriting', 'Documentation', 'Compliance', 'Collection Strategy', 'custom'],
            'actuary': ['Actuarial Modeling', 'Pricing Strategy', 'Reserve Calculation', 'Risk Assessment', 'Regulatory Reporting', 'custom'],
            'underwriter': ['Risk Selection', 'Policy Pricing', 'Capacity Management', 'Treaty Negotiation', 'Claims Analysis', 'custom'],
            'claims-analyst': ['Claims Assessment', 'Fraud Detection', 'Settlement Strategy', 'Subrogation', 'Claims Reserve', 'custom'],
            'product-actuary': ['Product Development', 'Pricing Model', 'Profit Testing', 'Regulatory Filing', 'Market Analysis', 'custom'],
            'risk-assessor': ['Risk Evaluation', 'Site Inspection', 'Risk Recommendation', 'Loss Prevention', 'Risk Reporting', 'custom'],
            'auditor': ['Audit Planning', 'Internal Controls', 'Risk-based Audit', 'Audit Reporting', 'Remediation Tracking', 'custom'],
            'tax-advisor': ['Tax Planning', 'Compliance Strategy', 'Tax Optimization', 'Transfer Pricing', 'Tax Controversy', 'custom'],
            'forensic-accountant': ['Fraud Investigation', 'Litigation Support', 'Asset Tracing', 'Expert Testimony', 'Compliance Investigation', 'custom'],
            'management-accountant': ['Cost Accounting', 'Performance Analysis', 'Decision Support', 'Process Improvement', 'Management Reporting', 'custom'],
            'compliance-officer': ['Compliance Program', 'Regulatory Monitoring', 'Policy Development', 'Training Program', 'Incident Management', 'custom'],
            // HR roles
            'recruiter': ['Talent Pipeline', 'Employer Branding', 'Interview Framework', 'Sourcing Strategy', 'Candidate Experience', 'custom'],
            'hr-manager': ['Performance Management', 'Compensation Strategy', 'HR Analytics', 'Employee Relations', 'Policy Development', 'custom'],
            'sourcing-specialist': ['Talent Sourcing', 'Boolean Search', 'Talent Mapping', 'Pipeline Development', 'Market Intelligence', 'custom'],
            'employer-branding': ['EVP Development', 'Brand Strategy', 'Content Marketing', 'Social Media', 'Candidate Engagement', 'custom'],
            'campus-recruiter': ['Campus Strategy', 'University Relations', 'Internship Program', 'Event Planning', 'Early Talent', 'custom'],
            'od-specialist': ['Organization Design', 'Culture Assessment', 'Change Readiness', 'Team Effectiveness', 'Leadership Development', 'custom'],
            'hr-bp': ['Business Partnering', 'Workforce Planning', 'Talent Review', 'Succession Planning', 'Employee Engagement', 'custom'],
            'culture-manager': ['Culture Strategy', 'Values Activation', 'Employee Experience', 'Culture Measurement', 'Behavior Change', 'custom'],
            'engagement-specialist': ['Engagement Survey', 'Action Planning', 'Recognition Program', 'Communication Strategy', 'Wellbeing Initiative', 'custom'],
            'change-consultant': ['Change Strategy', 'Stakeholder Engagement', 'Communication Plan', 'Training Design', 'Adoption Measurement', 'custom'],
            'comp-analyst': ['Compensation Analysis', 'Market Benchmarking', 'Pay Equity', 'Salary Structure', 'Incentive Design', 'custom'],
            'benefits-specialist': ['Benefits Design', 'Vendor Management', 'Open Enrollment', 'Compliance', 'Employee Communication', 'custom'],
            'total-rewards': ['Total Rewards Strategy', 'Executive Compensation', 'Global Mobility', 'Recognition Framework', 'Rewards Philosophy', 'custom'],
            'payroll-manager': ['Payroll Processing', 'Compliance', 'Tax Reporting', 'System Management', 'Process Improvement', 'custom'],
            'equity-admin': ['Equity Programs', 'Stock Administration', 'Compliance Reporting', 'Participant Communication', 'System Management', 'custom'],
            'learning-designer': ['Instructional Design', 'Learning Experience', 'Content Development', 'Assessment Design', 'Learning Technology', 'custom'],
            'training-manager': ['Training Strategy', 'Needs Analysis', 'Program Delivery', 'Vendor Management', 'ROI Measurement', 'custom'],
            'leadership-coach': ['Executive Coaching', 'Leadership Assessment', 'Development Planning', 'Team Coaching', 'Succession Coaching', 'custom'],
            'lms-admin': ['LMS Management', 'Content Curation', 'Reporting Analytics', 'User Experience', 'Integration Management', 'custom'],
            'performance-consultant': ['Performance Analysis', 'Intervention Design', 'Process Improvement', 'Change Management', 'Measurement Strategy', 'custom'],
            'hris-analyst': ['System Administration', 'Data Management', 'Reporting', 'Process Automation', 'Integration', 'custom'],
            'people-analytics': ['Workforce Analytics', 'Predictive Modeling', 'Dashboard Development', 'Insight Generation', 'Data Storytelling', 'custom'],
            'hr-systems': ['System Implementation', 'Vendor Selection', 'Change Management', 'Data Migration', 'User Training', 'custom'],
            'digital-hr': ['Digital Transformation', 'Employee Experience', 'Process Automation', 'Self-service Portal', 'Chatbot Development', 'custom'],
            'ai-hr-specialist': ['AI Applications', 'ML in HR', 'Predictive Analytics', 'Automation Strategy', 'Ethical AI', 'custom'],
            // ==================== Áî®Êà∂Ë°åÊ•≠ËßíËâ≤ - E-commerce ====================
            'ecom-manager': ['Marketplace Strategy', 'Inventory Management', 'Pricing Optimization', 'Seller Performance', 'Platform Analytics', 'custom'],
            'fashion-buyer': ['Trend Forecasting', 'Vendor Negotiation', 'Seasonal Planning', 'Assortment Strategy', 'Margin Management', 'custom'],
            'visual-merchandiser': ['Display Strategy', 'Product Styling', 'Store Layout', 'Brand Presentation', 'Customer Flow', 'custom'],
            'product-stylist': ['Product Photography', 'Lifestyle Styling', 'Brand Aesthetics', 'Content Direction', 'Trend Interpretation', 'custom'],
            'category-manager': ['Category Strategy', 'Assortment Planning', 'Pricing Strategy', 'Vendor Management', 'Performance Analysis', 'custom'],
            'baby-product-manager': ['Safety Compliance', 'Age-appropriate Design', 'Parent Education', 'Product Testing', 'Regulatory Standards', 'custom'],
            'parent-community': ['Community Building', 'Parent Engagement', 'Content Strategy', 'Expert Partnerships', 'Support Groups', 'custom'],
            'safety-specialist': ['Safety Standards', 'Testing Protocols', 'Certification Process', 'Risk Assessment', 'Compliance Audit', 'custom'],
            'content-creator': ['Content Strategy', 'Video Production', 'Social Media', 'Influencer Collaboration', 'Brand Storytelling', 'custom'],
            'kol-manager': ['KOL Identification', 'Partnership Negotiation', 'Campaign Management', 'ROI Measurement', 'Relationship Building', 'custom'],
            'pet-product-manager': ['Pet Health Focus', 'Species-specific Design', 'Quality Standards', 'Vet Consultation', 'Product Testing', 'custom'],
            'pet-community': ['Pet Parent Engagement', 'Educational Content', 'Community Events', 'Expert Network', 'User Stories', 'custom'],
            'vet-consultant': ['Health Advisory', 'Product Validation', 'Nutrition Guidance', 'Safety Review', 'Expert Content', 'custom'],
            'pet-content': ['Pet Photography', 'Educational Videos', 'Care Guides', 'Product Reviews', 'Social Content', 'custom'],
            'pet-influencer': ['Influencer Partnerships', 'Brand Ambassadors', 'Campaign Strategy', 'Content Collaboration', 'Engagement Analytics', 'custom'],
            'toy-designer': ['Character Design', 'Articulation Design', 'Material Selection', 'Manufacturing Specs', 'Collectibility Features', 'custom'],
            'ip-manager': ['IP Development', 'Licensing Strategy', 'Brand Protection', 'Collaboration Management', 'Revenue Optimization', 'custom'],
            'collector-community': ['Collector Engagement', 'Limited Edition Strategy', 'Community Events', 'Resale Market', 'Authenticity Programs', 'custom'],
            'limited-edition': ['Drop Strategy', 'Scarcity Marketing', 'Pre-order Management', 'Launch Events', 'Exclusivity Programs', 'custom'],
            'collab-manager': ['Artist Partnerships', 'Brand Collaborations', 'Co-creation Process', 'Contract Negotiation', 'Launch Coordination', 'custom'],
            'tiktok-operator': ['TikTok Shop Management', 'Algorithm Optimization', 'Content Strategy', 'Affiliate Program', 'Performance Analytics', 'custom'],
            'live-host': ['Live Streaming', 'Audience Engagement', 'Product Demonstration', 'Sales Conversion', 'Follower Growth', 'custom'],
            'short-video': ['Video Production', 'Trend Riding', 'Hook Creation', 'Editing Techniques', 'Viral Strategy', 'custom'],
            'affiliate-tiktok': ['Affiliate Recruitment', 'Commission Structure', 'Performance Tracking', 'Relationship Management', 'Campaign Optimization', 'custom'],
            'tiktok-ads': ['TikTok Ads Manager', 'Creative Testing', 'Audience Targeting', 'Budget Optimization', 'Conversion Tracking', 'custom'],
            'shopee-operator': ['Shopee Seller Center', 'Listing Optimization', 'Promotional Tools', 'Order Management', 'Customer Service', 'custom'],
            'shopee-ads': ['Shopee Ads', 'Keyword Bidding', 'Product Boost', 'Discovery Ads', 'ROI Optimization', 'custom'],
            'flash-sale': ['Flash Deal Strategy', 'Inventory Planning', 'Pricing Strategy', 'Promotional Calendar', 'Performance Analysis', 'custom'],
            'shopee-live': ['Shopee Live', 'Streaming Schedule', 'Product Showcase', 'Viewer Engagement', 'Sales Conversion', 'custom'],
            'seller-support': ['Seller Performance', 'Policy Compliance', 'Issue Resolution', 'Rating Management', 'Account Health', 'custom'],
            'fb-shop-manager': ['Facebook Shop', 'Catalog Management', 'Checkout Optimization', 'Customer Engagement', 'Performance Tracking', 'custom'],
            'fb-ads-specialist': ['Facebook Ads Manager', 'Audience Building', 'Creative Testing', 'Conversion Campaigns', 'Pixel Optimization', 'custom'],
            'community-sales': ['Facebook Groups', 'Community Engagement', 'Social Selling', 'Trust Building', 'Group Management', 'custom'],
            'messenger-sales': ['Messenger Commerce', 'Chatbot Strategy', 'Quick Replies', 'Order Management', 'Customer Follow-up', 'custom'],
            'fb-live': ['Facebook Live', 'Live Shopping', 'Audience Interaction', 'Product Demos', 'Engagement Strategy', 'custom'],
            // ==================== Marketing - SEO/GEO ====================
            'geo-specialist': ['Local SEO', 'Google Business Profile', 'Location Strategy', 'Review Management', 'Citation Building', 'custom'],
            'local-seo': ['Local Keywords', 'Map Pack Optimization', 'Local Landing Pages', 'NAP Consistency', 'Local Link Building', 'custom'],
            'technical-seo': ['Site Architecture', 'Core Web Vitals', 'Schema Markup', 'Crawl Optimization', 'Site Speed', 'custom'],
            'content-seo': ['Keyword Research', 'Content Optimization', 'Topic Clusters', 'Search Intent', 'Featured Snippets', 'custom'],
            'influencer-manager': ['Influencer Identification', 'Campaign Planning', 'Contract Negotiation', 'Performance Tracking', 'Relationship Management', 'custom'],
            'viral-specialist': ['Viral Content Strategy', 'Trend Surfing', 'Shareable Content', 'Engagement Hooks', 'Platform Optimization', 'custom'],
            'paid-media': ['Paid Media Strategy', 'Channel Mix', 'Budget Allocation', 'Bid Strategy', 'Creative Testing', 'custom'],
            'conversion-optimizer': ['CRO Strategy', 'A/B Testing', 'Landing Page Optimization', 'User Flow Analysis', 'Conversion Funnel', 'custom'],
            'brand-strategist': ['Brand Positioning', 'Brand Architecture', 'Messaging Framework', 'Visual Identity', 'Brand Guidelines', 'custom'],
            'creative-director': ['Creative Strategy', 'Campaign Concepts', 'Art Direction', 'Brand Expression', 'Creative Brief', 'custom'],
            'campaign-manager': ['Campaign Planning', 'Execution Management', 'Timeline Coordination', 'Budget Management', 'Results Reporting', 'custom'],
            'pr-specialist': ['Media Relations', 'Press Release', 'Crisis Communication', 'Reputation Management', 'Influencer PR', 'custom'],
            'content-strategist': ['Content Strategy', 'Content Audit', 'Content Calendar', 'Channel Strategy', 'Performance Metrics', 'custom'],
            'copywriter': ['Copywriting', 'Brand Voice', 'Ad Copy', 'Product Description', 'Email Copy', 'custom'],
            'video-producer': ['Video Strategy', 'Production Planning', 'Post-production', 'Distribution Strategy', 'Video Analytics', 'custom'],
            'podcast-host': ['Podcast Strategy', 'Guest Booking', 'Episode Planning', 'Audience Growth', 'Monetization', 'custom'],
            'newsletter-manager': ['Newsletter Strategy', 'List Building', 'Content Curation', 'Engagement Optimization', 'Deliverability', 'custom'],
            // ==================== Product - Industry Specific ====================
            'fashion-pm': ['Fashion Product Lifecycle', 'Trend Integration', 'Size/Fit Optimization', 'Color Strategy', 'Material Innovation', 'custom'],
            'trend-analyst': ['Trend Research', 'Forecast Reports', 'Consumer Insights', 'Market Analysis', 'Competitive Tracking', 'custom'],
            'sourcing-manager': ['Supplier Management', 'Cost Negotiation', 'Quality Control', 'Lead Time Optimization', 'Sustainability Sourcing', 'custom'],
            'quality-controller': ['Quality Standards', 'Inspection Process', 'Defect Analysis', 'Supplier Audit', 'Continuous Improvement', 'custom'],
            'supply-chain': ['Supply Chain Strategy', 'Logistics Optimization', 'Inventory Management', 'Demand Planning', 'Risk Management', 'custom'],
            'baby-pm': ['Baby Product Safety', 'Age Segmentation', 'Parent Research', 'Development Milestones', 'Regulatory Compliance', 'custom'],
            'safety-pm': ['Safety Testing', 'Certification Process', 'Risk Assessment', 'Recall Prevention', 'Safety Standards', 'custom'],
            'parent-researcher': ['Parent Insights', 'User Testing', 'Focus Groups', 'Journey Mapping', 'Pain Point Analysis', 'custom'],
            'packaging-designer': ['Package Design', 'Shelf Impact', 'Sustainability', 'Unboxing Experience', 'Cost Optimization', 'custom'],
            'compliance-pm': ['Regulatory Compliance', 'Certification Management', 'Documentation', 'Audit Preparation', 'Policy Updates', 'custom'],
            'pet-pm': ['Pet Product Development', 'Species Research', 'Safety Testing', 'Vet Collaboration', 'Customer Feedback', 'custom'],
            'pet-nutritionist': ['Nutrition Formulation', 'Ingredient Sourcing', 'Health Claims', 'Regulatory Compliance', 'Quality Testing', 'custom'],
            'pet-safety': ['Pet Safety Standards', 'Material Testing', 'Choking Hazard Assessment', 'Durability Testing', 'Toxicity Screening', 'custom'],
            'pet-ux': ['Pet User Experience', 'Behavioral Testing', 'Owner Feedback', 'Usage Patterns', 'Design Iteration', 'custom'],
            'pet-innovation': ['Pet Tech Innovation', 'Smart Products', 'Connected Devices', 'Health Monitoring', 'App Integration', 'custom'],
            'toy-pm': ['Toy Development', 'Play Testing', 'Safety Compliance', 'Manufacturing Specs', 'Cost Management', 'custom'],
            'play-researcher': ['Play Patterns', 'Child Development', 'Educational Value', 'Engagement Testing', 'Age Appropriateness', 'custom'],
            'ip-developer': ['IP Creation', 'Character Development', 'Story Building', 'Brand Extension', 'Licensing Prep', 'custom'],
            'manufacturing-pm': ['Manufacturing Process', 'Vendor Management', 'Production Planning', 'Cost Control', 'Quality Assurance', 'custom'],
            'collector-pm': ['Collector Market', 'Limited Edition Strategy', 'Authenticity Features', 'Resale Value', 'Community Engagement', 'custom'],
            // ==================== Design ====================
            'industrial-designer': ['Product Design', 'CAD Modeling', 'Prototyping', 'Material Selection', 'Manufacturing Design', 'custom'],
            'cad-engineer': ['CAD Software', 'Technical Drawing', '3D Modeling', 'Design Validation', 'Manufacturing Specs', 'custom'],
            '3d-modeler': ['3D Modeling', 'Rendering', 'Animation', 'Texture Mapping', 'Model Optimization', 'custom'],
            'prototype-specialist': ['Rapid Prototyping', '3D Printing', 'Mock-up Creation', 'Testing Coordination', 'Iteration Management', 'custom'],
            'material-designer': ['Material Selection', 'Sustainable Materials', 'Cost Analysis', 'Supplier Sourcing', 'Quality Testing', 'custom'],
            'fashion-designer': ['Fashion Design', 'Collection Development', 'Trend Interpretation', 'Technical Sketching', 'Fabric Selection', 'custom'],
            'pattern-maker': ['Pattern Development', 'Grading', 'Fit Analysis', 'Technical Specs', 'Production Patterns', 'custom'],
            'textile-designer': ['Textile Design', 'Print Development', 'Fabric Innovation', 'Color Stories', 'Surface Design', 'custom'],
            'accessory-designer': ['Accessory Design', 'Hardware Selection', 'Material Innovation', 'Trend Research', 'Production Specs', 'custom'],
            'footwear-designer': ['Footwear Design', 'Last Development', 'Material Selection', 'Comfort Engineering', 'Production Specs', 'custom'],
            'toy-sculptor': ['Sculpture Design', 'Character Modeling', 'Articulation Design', 'Material Consideration', 'Production Ready', 'custom'],
            'character-designer': ['Character Creation', 'Visual Development', 'Style Guide', 'Personality Design', 'Brand Consistency', 'custom'],
            'color-specialist': ['Color Theory', 'Color Matching', 'Trend Colors', 'Production Colors', 'Color Management', 'custom'],
            'articulation-designer': ['Joint Design', 'Movement Range', 'Play Pattern', 'Durability Testing', 'Assembly Design', 'custom'],
            'ux-designer': ['User Experience', 'Wireframing', 'Prototyping', 'User Testing', 'Design Systems', 'custom'],
            'ui-designer': ['Interface Design', 'Visual Design', 'Component Library', 'Responsive Design', 'Design Specs', 'custom'],
            'interaction-designer': ['Interaction Patterns', 'Animation Design', 'Micro-interactions', 'User Flows', 'Gesture Design', 'custom'],
            'design-system': ['Design System', 'Component Library', 'Documentation', 'Governance', 'Adoption Strategy', 'custom'],
            'user-researcher': ['User Research', 'Usability Testing', 'Interview Techniques', 'Survey Design', 'Insight Synthesis', 'custom'],
            'graphic-designer': ['Graphic Design', 'Layout Design', 'Typography', 'Color Theory', 'Visual Hierarchy', 'custom'],
            'brand-designer': ['Brand Identity', 'Logo Design', 'Brand Guidelines', 'Visual System', 'Brand Applications', 'custom'],
            'motion-designer': ['Motion Graphics', 'Animation', 'Video Effects', 'Storytelling', 'After Effects', 'custom'],
            'illustration': ['Illustration', 'Character Art', 'Digital Painting', 'Vector Art', 'Style Development', 'custom'],
            'print-designer': ['Print Design', 'Packaging', 'Editorial Design', 'Production Files', 'Print Specs', 'custom'],
            // ==================== Development - Vibe Coding ====================
            'vibe-developer': ['AI-assisted Coding', 'Rapid Development', 'Prompt Engineering', 'Code Generation', 'Iterative Building', 'custom'],
            'ai-pair-programmer': ['AI Pair Programming', 'Code Review', 'Bug Fixing', 'Feature Implementation', 'Learning Loop', 'custom'],
            'prompt-engineer': ['Prompt Design', 'Context Optimization', 'Output Control', 'Chain of Thought', 'Few-shot Learning', 'custom'],
            'rapid-prototyper': ['Quick Prototyping', 'MVP Development', 'Iteration Speed', 'User Feedback Loop', 'Feature Prioritization', 'custom'],
            'no-code-builder': ['No-code Tools', 'Workflow Automation', 'App Building', 'Integration Setup', 'Rapid Deployment', 'custom'],
            'frontend-dev': ['Frontend Development', 'React/Vue/Angular', 'CSS/Styling', 'Performance', 'Accessibility', 'custom'],
            'backend-dev': ['Backend Development', 'API Design', 'Database Design', 'Security', 'Scalability', 'custom'],
            'fullstack-dev': ['Full Stack', 'End-to-end Development', 'Architecture', 'Deployment', 'DevOps', 'custom'],
            'web-architect': ['System Architecture', 'Scalability', 'Security Architecture', 'Tech Stack Selection', 'Performance Design', 'custom'],
            'devops': ['CI/CD', 'Infrastructure as Code', 'Containerization', 'Monitoring', 'Cloud Services', 'custom'],
            'ios-dev': ['iOS Development', 'Swift', 'SwiftUI', 'App Store', 'Performance', 'custom'],
            'android-dev': ['Android Development', 'Kotlin', 'Jetpack Compose', 'Play Store', 'Performance', 'custom'],
            'react-native': ['React Native', 'Cross-platform', 'Native Modules', 'Performance', 'App Store', 'custom'],
            'flutter-dev': ['Flutter', 'Dart', 'Cross-platform', 'Widget Design', 'Performance', 'custom'],
            'mobile-architect': ['Mobile Architecture', 'Cross-platform Strategy', 'Performance', 'Security', 'Scalability', 'custom'],
            'ml-engineer': ['Machine Learning', 'Model Training', 'Feature Engineering', 'MLOps', 'Model Deployment', 'custom'],
            'data-scientist': ['Data Analysis', 'Statistical Modeling', 'Python/R', 'Visualization', 'Business Insights', 'custom'],
            'ai-researcher': ['AI Research', 'Paper Implementation', 'Model Innovation', 'Experiment Design', 'Benchmarking', 'custom'],
            'mlops-engineer': ['MLOps', 'Model Pipeline', 'Monitoring', 'A/B Testing', 'Model Versioning', 'custom'],
            'nlp-specialist': ['NLP', 'Text Processing', 'Language Models', 'Sentiment Analysis', 'Chatbots', 'custom'],
            'shopify-dev': ['Shopify Development', 'Theme Customization', 'App Development', 'Liquid', 'Checkout Extension', 'custom'],
            'woocommerce-dev': ['WooCommerce', 'WordPress', 'Plugin Development', 'Theme Customization', 'Payment Gateway', 'custom'],
            'api-integrator': ['API Integration', 'Third-party Services', 'Webhook Management', 'Data Sync', 'Error Handling', 'custom'],
            'payment-specialist': ['Payment Gateway', 'Checkout Flow', 'Security Compliance', 'Multi-currency', 'Fraud Prevention', 'custom'],
            'erp-developer': ['ERP Integration', 'Inventory Sync', 'Order Management', 'Data Migration', 'System Automation', 'custom'],
            // ==================== Strategy ====================
            'ecom-strategist': ['E-commerce Strategy', 'Marketplace Analysis', 'Growth Planning', 'Channel Strategy', 'P&L Optimization', 'custom'],
            'marketplace-analyst': ['Marketplace Analysis', 'Competitive Intelligence', 'Pricing Analysis', 'Category Trends', 'Performance Metrics', 'custom'],
            'pricing-strategist': ['Pricing Strategy', 'Dynamic Pricing', 'Competitor Analysis', 'Margin Optimization', 'Promotional Pricing', 'custom'],
            'expansion-manager': ['Market Expansion', 'New Channel Entry', 'Localization Strategy', 'Partnership Development', 'Launch Planning', 'custom'],
            'omnichannel-lead': ['Omnichannel Strategy', 'Channel Integration', 'Customer Journey', 'Unified Commerce', 'Inventory Visibility', 'custom'],
            'positioning-expert': ['Brand Positioning', 'Competitive Differentiation', 'Value Proposition', 'Target Segmentation', 'Messaging Strategy', 'custom'],
            'competitive-analyst': ['Competitive Analysis', 'Market Mapping', 'SWOT Analysis', 'Strategy Monitoring', 'Opportunity Identification', 'custom'],
            'market-researcher': ['Market Research', 'Consumer Insights', 'Survey Design', 'Data Analysis', 'Trend Identification', 'custom'],
            'trend-forecaster': ['Trend Forecasting', 'Future Planning', 'Scenario Analysis', 'Innovation Spotting', 'Consumer Behavior', 'custom'],
            'growth-strategist': ['Growth Strategy', 'Acquisition Planning', 'Retention Strategy', 'Expansion Planning', 'Metrics Framework', 'custom'],
            'acquisition-lead': ['Customer Acquisition', 'Channel Strategy', 'CAC Optimization', 'Conversion Funnel', 'Growth Experiments', 'custom'],
            'retention-lead': ['Customer Retention', 'Loyalty Programs', 'Churn Prevention', 'Engagement Strategy', 'LTV Optimization', 'custom'],
            'monetization-lead': ['Monetization Strategy', 'Revenue Model', 'Pricing Optimization', 'Product Bundling', 'Value Capture', 'custom'],
            'partnerships-lead': ['Partnership Strategy', 'Business Development', 'Alliance Management', 'Revenue Sharing', 'Integration Planning', 'custom'],
            // ==================== Finance - E-commerce ====================
            'ecom-controller': ['E-commerce Finance', 'Marketplace Accounting', 'Revenue Recognition', 'Fee Analysis', 'Profitability Tracking', 'custom'],
            'payment-ops': ['Payment Operations', 'Settlement Management', 'Chargeback Handling', 'Payment Method Analysis', 'Fee Optimization', 'custom'],
            'fraud-analyst': ['Fraud Detection', 'Risk Assessment', 'Chargeback Analysis', 'Prevention Strategy', 'Pattern Recognition', 'custom'],
            'revenue-ops': ['Revenue Operations', 'Billing Management', 'Subscription Analytics', 'Revenue Forecasting', 'Process Optimization', 'custom'],
            'bookkeeper': ['Bookkeeping', 'Transaction Recording', 'Account Reconciliation', 'Financial Statements', 'Tax Preparation', 'custom'],
            'budget-analyst': ['Budget Analysis', 'Variance Reporting', 'Cost Control', 'Forecast Modeling', 'Resource Allocation', 'custom'],
            'cost-analyst': ['Cost Analysis', 'Cost Allocation', 'Profitability Analysis', 'Cost Reduction', 'Activity-based Costing', 'custom'],
            'profitability-analyst': ['Profitability Analysis', 'Product Margin', 'Channel Profitability', 'Customer Profitability', 'Pricing Analysis', 'custom'],
            'cash-flow-manager': ['Cash Flow Management', 'Working Capital', 'Liquidity Planning', 'Cash Forecasting', 'Collection Optimization', 'custom'],
            'financial-planner': ['Financial Planning', 'Business Planning', 'Scenario Analysis', 'Long-term Forecasting', 'Strategic Finance', 'custom'],
            'custom': ['SWOT Analysis', 'Business Model Canvas', 'OKR Framework', 'Design Thinking', 'Lean Methodology', 'custom']
        };

        // ËßíËâ≤Ê®ôÁ±§Êò†Â∞Ñ - ‰ΩøÁî®ÁøªË≠ØÈçµÂÄº
        const roleLabels = {
            // Marketing roles
            'growth-hacker': 'biz_role_growth_hacker',
            'content-marketer': 'biz_role_content_marketer',
            'demand-gen': 'biz_role_demand_gen',
            'seo-specialist': 'biz_role_seo_specialist',
            'marketing-analyst': 'biz_role_marketing_analyst',
            'performance-marketer': 'biz_role_performance_marketer',
            'brand-manager': 'biz_role_brand_manager',
            'social-media': 'biz_role_social_media',
            'affiliate-manager': 'biz_role_affiliate_manager',
            'crm-specialist': 'biz_role_crm_specialist',
            'product-marketer': 'biz_role_product_marketer',
            'acquisition': 'biz_role_acquisition',
            'retention': 'biz_role_retention',
            'compliance-marketer': 'biz_role_compliance_marketer',
            'partnership-manager': 'biz_role_partnership_manager',
            'healthcare-marketer': 'biz_role_healthcare_marketer',
            'patient-acquisition': 'biz_role_patient_acquisition',
            'medical-writer': 'biz_role_medical_writer',
            'pharma-marketer': 'biz_role_pharma_marketer',
            'health-educator': 'biz_role_health_educator',
            'edu-marketer': 'biz_role_edu_marketer',
            'enrollment-specialist': 'biz_role_enrollment_specialist',
            'alumni-relations': 'biz_role_alumni_relations',
            'content-developer': 'biz_role_content_developer',
            'community-manager': 'biz_role_community_manager',
            // Strategy roles
            'strategy-consultant': 'biz_role_strategy_consultant',
            'management-consultant': 'biz_role_management_consultant',
            'digital-consultant': 'biz_role_digital_consultant',
            'change-manager': 'biz_role_change_manager',
            'process-consultant': 'biz_role_process_consultant',
            'founder': 'biz_role_founder',
            'coo': 'biz_role_coo',
            'business-dev': 'biz_role_business_dev',
            'chief-strategy': 'biz_role_chief_strategy',
            'venture-partner': 'biz_role_venture_partner',
            'corporate-strategist': 'biz_role_corporate_strategist',
            'biz-analyst': 'biz_role_biz_analyst',
            'transformation-lead': 'biz_role_transformation_lead',
            'innovation-manager': 'biz_role_innovation_manager',
            'market-intelligence': 'biz_role_market_intelligence',
            'pe-analyst': 'biz_role_pe_analyst',
            'due-diligence': 'biz_role_due_diligence',
            'portfolio-ops': 'biz_role_portfolio_ops',
            'deal-sourcing': 'biz_role_deal_sourcing',
            'value-creation': 'biz_role_value_creation',
            'policy-analyst': 'biz_role_policy_analyst',
            'program-manager': 'biz_role_program_manager',
            'public-affairs': 'biz_role_public_affairs',
            'regulatory-advisor': 'biz_role_regulatory_advisor',
            'strategic-planner': 'biz_role_strategic_planner',
            // Sales roles
            'account-exec': 'biz_role_account_exec',
            'sales-engineer': 'biz_role_sales_engineer',
            'sales-manager': 'biz_role_sales_manager',
            'enterprise-sales': 'biz_role_enterprise_sales',
            'channel-manager': 'biz_role_channel_manager',
            'retail-sales': 'biz_role_retail_sales',
            'inside-sales': 'biz_role_inside_sales',
            'telesales': 'biz_role_telesales',
            'showroom-manager': 'biz_role_showroom_manager',
            'customer-success': 'biz_role_customer_success',
            'sdr': 'biz_role_sdr',
            'bdr': 'biz_role_bdr',
            'account-manager': 'biz_role_account_manager',
            'renewal-specialist': 'biz_role_renewal_specialist',
            'solution-architect': 'biz_role_solution_architect',
            'real-estate-agent': 'biz_role_real_estate_agent',
            'property-consultant': 'biz_role_property_consultant',
            'leasing-specialist': 'biz_role_leasing_specialist',
            'investment-advisor': 'biz_role_investment_advisor',
            'development-sales': 'biz_role_development_sales',
            'wholesale-rep': 'biz_role_wholesale_rep',
            'key-account': 'biz_role_key_account',
            'distributor-manager': 'biz_role_distributor_manager',
            'trade-marketing': 'biz_role_trade_marketing',
            'territory-manager': 'biz_role_territory_manager',
            // Product roles
            'pm': 'biz_role_pm',
            'senior-pm': 'biz_role_senior_pm',
            'product-lead': 'biz_role_product_lead',
            'technical-pm': 'biz_role_technical_pm',
            'platform-pm': 'biz_role_platform_pm',
            'consumer-pm': 'biz_role_consumer_pm',
            'ux-researcher': 'biz_role_ux_researcher',
            'growth-pm': 'biz_role_growth_pm',
            'mobile-pm': 'biz_role_mobile_pm',
            'product-analyst': 'biz_role_product_analyst',
            'enterprise-pm': 'biz_role_enterprise_pm',
            'api-pm': 'biz_role_api_pm',
            'integration-pm': 'biz_role_integration_pm',
            'partner-pm': 'biz_role_partner_pm',
            'product-ops': 'biz_role_product_ops',
            'hardware-pm': 'biz_role_hardware_pm',
            'iot-pm': 'biz_role_iot_pm',
            'embedded-pm': 'biz_role_embedded_pm',
            'manufacturing-liaison': 'biz_role_manufacturing_liaison',
            'quality-pm': 'biz_role_quality_pm',
            'data-pm': 'biz_role_data_pm',
            'ml-pm': 'biz_role_ml_pm',
            'analytics-pm': 'biz_role_analytics_pm',
            'bi-product-manager': 'biz_role_bi_product_manager',
            'data-strategy': 'biz_role_data_strategy',
            // Finance roles
            'analyst': 'biz_role_analyst',
            'portfolio-manager': 'biz_role_portfolio_manager',
            'research-analyst': 'biz_role_research_analyst',
            'quant-analyst': 'biz_role_quant_analyst',
            'risk-manager': 'biz_role_risk_manager',
            'cfo': 'biz_role_cfo',
            'fp-analyst': 'biz_role_fp_analyst',
            'controller': 'biz_role_controller',
            'treasury-manager': 'biz_role_treasury_manager',
            'investor-relations': 'biz_role_investor_relations',
            'relationship-manager': 'biz_role_relationship_manager',
            'credit-analyst': 'biz_role_credit_analyst',
            'trade-finance': 'biz_role_trade_finance',
            'private-banker': 'biz_role_private_banker',
            'loan-officer': 'biz_role_loan_officer',
            'actuary': 'biz_role_actuary',
            'underwriter': 'biz_role_underwriter',
            'claims-analyst': 'biz_role_claims_analyst',
            'product-actuary': 'biz_role_product_actuary',
            'risk-assessor': 'biz_role_risk_assessor',
            'auditor': 'biz_role_auditor',
            'tax-advisor': 'biz_role_tax_advisor',
            'forensic-accountant': 'biz_role_forensic_accountant',
            'management-accountant': 'biz_role_management_accountant',
            'compliance-officer': 'biz_role_compliance_officer',
            // HR roles
            'recruiter': 'biz_role_recruiter',
            'hr-manager': 'biz_role_hr_manager',
            'sourcing-specialist': 'biz_role_sourcing_specialist',
            'employer-branding': 'biz_role_employer_branding',
            'campus-recruiter': 'biz_role_campus_recruiter',
            'od-specialist': 'biz_role_od_specialist',
            'hr-bp': 'biz_role_hr_bp',
            'culture-manager': 'biz_role_culture_manager',
            'engagement-specialist': 'biz_role_engagement_specialist',
            'change-consultant': 'biz_role_change_consultant',
            'comp-analyst': 'biz_role_comp_analyst',
            'benefits-specialist': 'biz_role_benefits_specialist',
            'total-rewards': 'biz_role_total_rewards',
            'payroll-manager': 'biz_role_payroll_manager',
            'equity-admin': 'biz_role_equity_admin',
            'learning-designer': 'biz_role_learning_designer',
            'training-manager': 'biz_role_training_manager',
            'leadership-coach': 'biz_role_leadership_coach',
            'lms-admin': 'biz_role_lms_admin',
            'performance-consultant': 'biz_role_performance_consultant',
            'hris-analyst': 'biz_role_hris_analyst',
            'people-analytics': 'biz_role_people_analytics',
            'hr-systems': 'biz_role_hr_systems',
            'digital-hr': 'biz_role_digital_hr',
            'ai-hr-specialist': 'biz_role_ai_hr_specialist',
            // ==================== Áî®Êà∂Ë°åÊ•≠ËßíËâ≤ - E-commerce ====================
            'ecom-manager': 'biz_role_ecom_manager',
            'fashion-buyer': 'biz_role_fashion_buyer',
            'visual-merchandiser': 'biz_role_visual_merchandiser',
            'product-stylist': 'biz_role_product_stylist',
            'category-manager': 'biz_role_category_manager',
            'baby-product-manager': 'biz_role_baby_product_manager',
            'parent-community': 'biz_role_parent_community',
            'safety-specialist': 'biz_role_safety_specialist',
            'content-creator': 'biz_role_content_creator',
            'kol-manager': 'biz_role_kol_manager',
            'pet-product-manager': 'biz_role_pet_product_manager',
            'pet-community': 'biz_role_pet_community',
            'vet-consultant': 'biz_role_vet_consultant',
            'pet-content': 'biz_role_pet_content',
            'pet-influencer': 'biz_role_pet_influencer',
            'toy-designer': 'biz_role_toy_designer',
            'ip-manager': 'biz_role_ip_manager',
            'collector-community': 'biz_role_collector_community',
            'limited-edition': 'biz_role_limited_edition',
            'collab-manager': 'biz_role_collab_manager',
            'tiktok-operator': 'biz_role_tiktok_operator',
            'live-host': 'biz_role_live_host',
            'short-video': 'biz_role_short_video',
            'affiliate-tiktok': 'biz_role_affiliate_tiktok',
            'tiktok-ads': 'biz_role_tiktok_ads',
            'shopee-operator': 'biz_role_shopee_operator',
            'shopee-ads': 'biz_role_shopee_ads',
            'flash-sale': 'biz_role_flash_sale',
            'shopee-live': 'biz_role_shopee_live',
            'seller-support': 'biz_role_seller_support',
            'fb-shop-manager': 'biz_role_fb_shop_manager',
            'fb-ads-specialist': 'biz_role_fb_ads_specialist',
            'community-sales': 'biz_role_community_sales',
            'messenger-sales': 'biz_role_messenger_sales',
            'fb-live': 'biz_role_fb_live',
            // ==================== Marketing - SEO/GEO ====================
            'geo-specialist': 'biz_role_geo_specialist',
            'local-seo': 'biz_role_local_seo',
            'technical-seo': 'biz_role_technical_seo',
            'content-seo': 'biz_role_content_seo',
            'influencer-manager': 'biz_role_influencer_manager',
            'viral-specialist': 'biz_role_viral_specialist',
            'paid-media': 'biz_role_paid_media',
            'conversion-optimizer': 'biz_role_conversion_optimizer',
            'brand-strategist': 'biz_role_brand_strategist',
            'creative-director': 'biz_role_creative_director',
            'campaign-manager': 'biz_role_campaign_manager',
            'pr-specialist': 'biz_role_pr_specialist',
            'content-strategist': 'biz_role_content_strategist',
            'copywriter': 'biz_role_copywriter',
            'video-producer': 'biz_role_video_producer',
            'podcast-host': 'biz_role_podcast_host',
            'newsletter-manager': 'biz_role_newsletter_manager',
            // ==================== Product - Industry Specific ====================
            'fashion-pm': 'biz_role_fashion_pm',
            'trend-analyst': 'biz_role_trend_analyst',
            'sourcing-manager': 'biz_role_sourcing_manager',
            'quality-controller': 'biz_role_quality_controller',
            'supply-chain': 'biz_role_supply_chain',
            'baby-pm': 'biz_role_baby_pm',
            'safety-pm': 'biz_role_safety_pm',
            'parent-researcher': 'biz_role_parent_researcher',
            'packaging-designer': 'biz_role_packaging_designer',
            'compliance-pm': 'biz_role_compliance_pm',
            'pet-pm': 'biz_role_pet_pm',
            'pet-nutritionist': 'biz_role_pet_nutritionist',
            'pet-safety': 'biz_role_pet_safety',
            'pet-ux': 'biz_role_pet_ux',
            'pet-innovation': 'biz_role_pet_innovation',
            'toy-pm': 'biz_role_toy_pm',
            'play-researcher': 'biz_role_play_researcher',
            'ip-developer': 'biz_role_ip_developer',
            'manufacturing-pm': 'biz_role_manufacturing_pm',
            'collector-pm': 'biz_role_collector_pm',
            // ==================== Design ====================
            'industrial-designer': 'biz_role_industrial_designer',
            'cad-engineer': 'biz_role_cad_engineer',
            '3d-modeler': 'biz_role_3d_modeler',
            'prototype-specialist': 'biz_role_prototype_specialist',
            'material-designer': 'biz_role_material_designer',
            'fashion-designer': 'biz_role_fashion_designer',
            'pattern-maker': 'biz_role_pattern_maker',
            'textile-designer': 'biz_role_textile_designer',
            'accessory-designer': 'biz_role_accessory_designer',
            'footwear-designer': 'biz_role_footwear_designer',
            'toy-sculptor': 'biz_role_toy_sculptor',
            'character-designer': 'biz_role_character_designer',
            'color-specialist': 'biz_role_color_specialist',
            'articulation-designer': 'biz_role_articulation_designer',
            'ux-designer': 'biz_role_ux_designer',
            'ui-designer': 'biz_role_ui_designer',
            'interaction-designer': 'biz_role_interaction_designer',
            'design-system': 'biz_role_design_system',
            'user-researcher': 'biz_role_user_researcher',
            'graphic-designer': 'biz_role_graphic_designer',
            'brand-designer': 'biz_role_brand_designer',
            'motion-designer': 'biz_role_motion_designer',
            'illustration': 'biz_role_illustration',
            'print-designer': 'biz_role_print_designer',
            // ==================== Development ====================
            'vibe-developer': 'biz_role_vibe_developer',
            'ai-pair-programmer': 'biz_role_ai_pair_programmer',
            'prompt-engineer': 'biz_role_prompt_engineer',
            'rapid-prototyper': 'biz_role_rapid_prototyper',
            'no-code-builder': 'biz_role_no_code_builder',
            'frontend-dev': 'biz_role_frontend_dev',
            'backend-dev': 'biz_role_backend_dev',
            'fullstack-dev': 'biz_role_fullstack_dev',
            'web-architect': 'biz_role_web_architect',
            'devops': 'biz_role_devops',
            'ios-dev': 'biz_role_ios_dev',
            'android-dev': 'biz_role_android_dev',
            'react-native': 'biz_role_react_native',
            'flutter-dev': 'biz_role_flutter_dev',
            'mobile-architect': 'biz_role_mobile_architect',
            'ml-engineer': 'biz_role_ml_engineer',
            'data-scientist': 'biz_role_data_scientist',
            'ai-researcher': 'biz_role_ai_researcher',
            'mlops-engineer': 'biz_role_mlops_engineer',
            'nlp-specialist': 'biz_role_nlp_specialist',
            'shopify-dev': 'biz_role_shopify_dev',
            'woocommerce-dev': 'biz_role_woocommerce_dev',
            'api-integrator': 'biz_role_api_integrator',
            'payment-specialist': 'biz_role_payment_specialist',
            'erp-developer': 'biz_role_erp_developer',
            // ==================== Strategy ====================
            'ecom-strategist': 'biz_role_ecom_strategist',
            'marketplace-analyst': 'biz_role_marketplace_analyst',
            'pricing-strategist': 'biz_role_pricing_strategist',
            'expansion-manager': 'biz_role_expansion_manager',
            'omnichannel-lead': 'biz_role_omnichannel_lead',
            'positioning-expert': 'biz_role_positioning_expert',
            'competitive-analyst': 'biz_role_competitive_analyst',
            'market-researcher': 'biz_role_market_researcher',
            'trend-forecaster': 'biz_role_trend_forecaster',
            'growth-strategist': 'biz_role_growth_strategist',
            'acquisition-lead': 'biz_role_acquisition_lead',
            'retention-lead': 'biz_role_retention_lead',
            'monetization-lead': 'biz_role_monetization_lead',
            'partnerships-lead': 'biz_role_partnerships_lead',
            // ==================== Finance - E-commerce ====================
            'ecom-controller': 'biz_role_ecom_controller',
            'payment-ops': 'biz_role_payment_ops',
            'fraud-analyst': 'biz_role_fraud_analyst',
            'revenue-ops': 'biz_role_revenue_ops',
            'bookkeeper': 'biz_role_bookkeeper',
            'budget-analyst': 'biz_role_budget_analyst',
            'cost-analyst': 'biz_role_cost_analyst',
            'profitability-analyst': 'biz_role_profitability_analyst',
            'cash-flow-manager': 'biz_role_cash_flow_manager',
            'financial-planner': 'biz_role_financial_planner',
            'custom': 'biz_custom'
        };
        
        // Áç≤ÂèñÁøªË≠ØÊñáÊú¨ÁöÑËºîÂä©ÂáΩÊï∏
        function getTranslatedLabel(key) {
            return typeof t === 'function' ? t(key) : key;
        }

        // ‰∏âÊÖãÂàáÊèõÂáΩÊï∏
        function switchPromptMode(mode) {
            currentPromptMode = mode;
            
            // Êõ¥Êñ∞ Tab ÊåâÈàïÊ®£Âºè
            document.querySelectorAll('.mode-tab').forEach(tab => {
                tab.style.background = 'white';
                tab.style.color = '#87CEEB';
            });
            
            const activeTab = document.getElementById('modeTab' + mode.charAt(0).toUpperCase() + mode.slice(1));
            if (activeTab) {
                activeTab.style.background = 'linear-gradient(135deg, #87CEEB 0%, #FFB6C1 100%)';
                activeTab.style.color = 'white';
            }
            
            // ÂàáÊèõÈ°ØÁ§∫ÁöÑÊ®°ÂºèÂçÄÂ°ä
            document.querySelectorAll('.prompt-mode').forEach(modeDiv => {
                modeDiv.style.display = 'none';
            });
            
            document.getElementById(mode + 'Mode').style.display = 'block';
            
            // Ê∏ÖÁ©∫ÁµêÊûúÂçÄ
            document.getElementById('promptResult').innerHTML = `<p style="text-align: center; color: #888; padding: 40px;">ÈÅ∏ÊìáÊ®°Âºè‰∏¶Â°´ÂØ´ÂèÉÊï∏ÂæåÔºåÈªûÊìäÁîüÊàêÊåâÈàïÁç≤ÂèñÂ∞àÊ•≠ Prompt</p>`;
            document.getElementById('promptActions').style.display = 'none';
        }

        // Êõ¥Êñ∞Ë°åÊ•≠ÈÅ∏È†Ö
        function updateBizIndustry() {
            const domain = document.getElementById('bizDomain').value;
            const industrySelect = document.getElementById('bizIndustry');
            const customInput = document.getElementById('bizDomainCustom');
            
            // ËôïÁêÜËá™ÂÆöÁæ© - L1 ÈÅ∏ÊìáËá™ÂÆöÁæ©ÊôÇÔºåL2-L4 ÂÖ®ÈÉ®ÂàáÊèõÁÇ∫Ëá™ÂÆöÁæ©Ê®°Âºè
            if (domain === 'custom') {
                customInput.style.display = 'block';
                // Èö±Ëóè L2 ‰∏ãÊãâÈÅ∏ÂñÆÔºåÈ°ØÁ§∫ L2 Ëá™ÂÆöÁæ©Ëº∏ÂÖ•
                industrySelect.style.display = 'none';
                document.getElementById('bizIndustryCustom').style.display = 'block';
                // Èö±Ëóè L3 ‰∏ãÊãâÈÅ∏ÂñÆÔºåÈ°ØÁ§∫ L3 Ëá™ÂÆöÁæ©Ëº∏ÂÖ•
                document.getElementById('bizRole').style.display = 'none';
                document.getElementById('bizRoleCustom').style.display = 'block';
                // Èö±Ëóè L4 ‰∏ãÊãâÈÅ∏ÂñÆÔºåÈ°ØÁ§∫ L4 Ëá™ÂÆöÁæ©Ëº∏ÂÖ•
                document.getElementById('bizFramework').style.display = 'none';
                document.getElementById('bizFrameworkCustom').style.display = 'block';
            } else {
                customInput.style.display = 'none';
                // ÊÅ¢Âæ© L2-L4 ‰∏ãÊãâÈÅ∏ÂñÆ
                industrySelect.style.display = 'block';
                document.getElementById('bizIndustryCustom').style.display = 'none';
                document.getElementById('bizRole').style.display = 'block';
                document.getElementById('bizRoleCustom').style.display = 'none';
                document.getElementById('bizFramework').style.display = 'block';
                document.getElementById('bizFrameworkCustom').style.display = 'none';
            }
            
            // ÈáçÁΩÆÂæåÁ∫åÈÅ∏È†Ö
            industrySelect.innerHTML = '<option value="">-- ' + getTranslatedLabel('biz_select_industry') + ' --</option>';
            document.getElementById('bizRole').innerHTML = '<option value="">-- ' + getTranslatedLabel('biz_select_industry_first') + ' --</option>';
            document.getElementById('bizFramework').innerHTML = '<option value="">-- ' + getTranslatedLabel('biz_select_role_first') + ' --</option>';
            
            if (domain && domain !== 'custom' && bizData[domain]) {
                const industries = bizData[domain].industries;
                for (const [key, value] of Object.entries(industries)) {
                    const option = document.createElement('option');
                    option.value = key;
                    option.textContent = getTranslatedLabel(value.label);
                    industrySelect.appendChild(option);
                }
            }
        }

        // Êõ¥Êñ∞ËßíËâ≤ÈÅ∏È†Ö
        function updateBizRole() {
            const domain = document.getElementById('bizDomain').value;
            const industry = document.getElementById('bizIndustry').value;
            const roleSelect = document.getElementById('bizRole');
            const customInput = document.getElementById('bizIndustryCustom');
            
            // L2 ÈÅ∏ÊìáËá™ÂÆöÁæ©ÊôÇÔºåL3-L4 ‰πüÂàáÊèõÁÇ∫Ëá™ÂÆöÁæ©Ê®°Âºè
            if (industry === 'custom') {
                customInput.style.display = 'block';
                // Èö±Ëóè L3 ‰∏ãÊãâÈÅ∏ÂñÆÔºåÈ°ØÁ§∫ L3 Ëá™ÂÆöÁæ©Ëº∏ÂÖ•
                roleSelect.style.display = 'none';
                document.getElementById('bizRoleCustom').style.display = 'block';
                // Èö±Ëóè L4 ‰∏ãÊãâÈÅ∏ÂñÆÔºåÈ°ØÁ§∫ L4 Ëá™ÂÆöÁæ©Ëº∏ÂÖ•
                document.getElementById('bizFramework').style.display = 'none';
                document.getElementById('bizFrameworkCustom').style.display = 'block';
            } else {
                customInput.style.display = 'none';
                // ÊÅ¢Âæ© L3-L4 ‰∏ãÊãâÈÅ∏ÂñÆ
                roleSelect.style.display = 'block';
                document.getElementById('bizRoleCustom').style.display = 'none';
                document.getElementById('bizFramework').style.display = 'block';
                document.getElementById('bizFrameworkCustom').style.display = 'none';
            }
            
            roleSelect.innerHTML = '<option value="">-- ' + getTranslatedLabel('biz_select_role') + ' --</option>';
            document.getElementById('bizFramework').innerHTML = '<option value="">-- ' + getTranslatedLabel('biz_select_role_first') + ' --</option>';
            
            if (domain && industry && domain !== 'custom' && industry !== 'custom' && bizData[domain]?.industries[industry]) {
                const roles = bizData[domain].industries[industry].roles;
                roles.forEach(role => {
                    const option = document.createElement('option');
                    option.value = role;
                    option.textContent = getTranslatedLabel(roleLabels[role]) || role;
                    roleSelect.appendChild(option);
                });
            }
        }

        // Êõ¥Êñ∞Ê°ÜÊû∂ÈÅ∏È†Ö
        function updateBizFramework() {
            const domain = document.getElementById('bizDomain').value;
            const industry = document.getElementById('bizIndustry').value;
            const role = document.getElementById('bizRole').value;
            const frameworkSelect = document.getElementById('bizFramework');
            const customInput = document.getElementById('bizRoleCustom');
            
            // L3 ÈÅ∏ÊìáËá™ÂÆöÁæ©ÊôÇÔºåL4 ‰πüÂàáÊèõÁÇ∫Ëá™ÂÆöÁæ©Ê®°Âºè
            if (role === 'custom') {
                customInput.style.display = 'block';
                // Èö±Ëóè L4 ‰∏ãÊãâÈÅ∏ÂñÆÔºåÈ°ØÁ§∫ L4 Ëá™ÂÆöÁæ©Ëº∏ÂÖ•
                frameworkSelect.style.display = 'none';
                document.getElementById('bizFrameworkCustom').style.display = 'block';
            } else {
                customInput.style.display = 'none';
                // ÊÅ¢Âæ© L4 ‰∏ãÊãâÈÅ∏ÂñÆ
                frameworkSelect.style.display = 'block';
                document.getElementById('bizFrameworkCustom').style.display = 'none';
            }
            
            frameworkSelect.innerHTML = '<option value="">-- ' + getTranslatedLabel('biz_select_framework') + ' --</option>';
            
            if (role && role !== 'custom' && roleFrameworks[role]) {
                roleFrameworks[role].forEach(framework => {
                    const option = document.createElement('option');
                    option.value = framework;
                    if (framework === 'custom') {
                        option.textContent = getTranslatedLabel('biz_custom');
                    } else {
                        const fwKey = 'biz_fw_' + framework.toLowerCase().replace(/[^a-z0-9]+/g, '_').replace(/_+/g, '_').replace(/^_|_$/g, '');
                        option.textContent = getTranslatedLabel(fwKey) || framework;
                    }
                    frameworkSelect.appendChild(option);
                });
            }
        }

        // ËôïÁêÜÊ°ÜÊû∂ÈÅ∏ÊìáËÆäÂåñ
        function handleFrameworkChange() {
            const framework = document.getElementById('bizFramework').value;
            const customInput = document.getElementById('bizFrameworkCustom');
            
            if (framework === 'custom') {
                customInput.style.display = 'block';
            } else {
                customInput.style.display = 'none';
            }
        }

        // ÁîüÊàêÂïÜÊ•≠ Prompt (‰ΩøÁî® AI Ê∑±Â∫¶ÁîüÊàê)
        async function generateBusinessPrompt() {
            const domainValue = document.getElementById('bizDomain').value;
            const industryValue = document.getElementById('bizIndustry').value;
            const roleValue = document.getElementById('bizRole').value;
            const frameworkValue = document.getElementById('bizFramework').value;
            
            // Âà§Êñ∑ÊòØÂê¶ËôïÊñºËá™ÂÆöÁæ©Ê®°ÂºèÔºàL1 ÈÅ∏Êìá custom ÊôÇÔºåL2-L4 ÈÉΩÊòØËá™ÂÆöÁæ©Ëº∏ÂÖ•Ôºâ
            const isL1Custom = domainValue === 'custom';
            const isL2Custom = industryValue === 'custom' || isL1Custom;
            const isL3Custom = roleValue === 'custom' || isL2Custom;
            
            // Áç≤ÂèñÂêÑÂ±§Á¥öÁöÑÂÄº
            let domain, industry, role, framework;
            
            if (isL1Custom) {
                domain = document.getElementById('bizDomainCustom').value;
                industry = document.getElementById('bizIndustryCustom').value;
                role = document.getElementById('bizRoleCustom').value;
                framework = document.getElementById('bizFrameworkCustom').value;
            } else {
                domain = getTranslatedLabel(bizData[domainValue]?.label) || domainValue;
                
                if (isL2Custom) {
                    industry = document.getElementById('bizIndustryCustom').value;
                    role = document.getElementById('bizRoleCustom').value;
                    framework = document.getElementById('bizFrameworkCustom').value;
                } else {
                    industry = document.getElementById('bizIndustry').options[document.getElementById('bizIndustry').selectedIndex]?.text || '';
                    
                    if (isL3Custom) {
                        role = document.getElementById('bizRoleCustom').value;
                        framework = document.getElementById('bizFrameworkCustom').value;
                    } else {
                        role = getTranslatedLabel(roleLabels[roleValue]) || roleValue;
                        
                        if (frameworkValue === 'custom') {
                            framework = document.getElementById('bizFrameworkCustom').value;
                        } else {
                            // ÂèñÂæóÁøªË≠ØÂæåÁöÑÊ°ÜÊû∂ÂêçÁ®±
                            const fwKey = 'biz_fw_' + frameworkValue.toLowerCase().replace(/[^a-z0-9]+/g, '_').replace(/_+/g, '_').replace(/^_|_$/g, '');
                            framework = getTranslatedLabel(fwKey) || frameworkValue;
                        }
                    }
                }
            }
            
            const context = document.getElementById('bizContext').value;

            if (!domain || !industry || !role || !framework) {
                showPromptStatus(getTranslatedLabel('biz_fill_all_fields'), 'error');
                return;
            }

            // È°ØÁ§∫ AI ËôïÁêÜ‰∏≠ÁãÄÊÖã
            const btn = document.getElementById('bizGenerateBtn');
            btn.disabled = true;
            btn.innerHTML = 'ü§ñ AI Ê∑±Â∫¶ÊÄùËÄÉ‰∏≠...';
            showPromptStatus('üîÑ AI Ê≠£Âú®ÂàÜÊûêÊÇ®ÁöÑÂ∞àÊ•≠ËÉåÊôØ‰∏¶ÁîüÊàêÊ∑±Â∫¶ Prompt...', 'info');

            try {
                const response = await AuthManager.authFetch('/api/refine-prompt', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        mode: 'business',
                        domain: domain,
                        industry: industry,
                        role: role,
                        framework: framework,
                        context: context
                    })
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.message || 'AI ËôïÁêÜÂ§±Êïó');
                }

                currentGeneratedPrompt = data.refinedPrompt;
                displayPromptResult(currentGeneratedPrompt);
                showPromptStatus('‚úÖ AI Â∑≤ÁîüÊàêÂ∞àÊ•≠Á¥ö System PromptÔºÅ', 'success');

            } catch (error) {
                console.error('Business prompt generation error:', error);
                showPromptStatus('‚ùå ' + error.message, 'error');
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'üöÄ ' + getTranslatedLabel('biz_generate_prompt');
            }
        }

        // ÁîüÊàêËªüÈ´îÈñãÁôº Prompt (Ë™øÁî® AI)
        async function generateCodingPrompt() {
            const input = document.getElementById('codingInput').value;
            const platform = document.getElementById('codingPlatform').value;
            const complexity = document.getElementById('codingComplexity').value;

            if (!input.trim()) {
                showPromptStatus('Ë´ãËº∏ÂÖ•ÊÇ®ÁöÑËªüÈ´îÈúÄÊ±ÇÊèèËø∞', 'error');
                return;
            }

            const btn = document.getElementById('codingGenerateBtn');
            btn.disabled = true;
            btn.innerHTML = 'üîÑ AI ËôïÁêÜ‰∏≠...';

            try {
                const references = await prepareReferencesForAPI('coding');
                
                const response = await AuthManager.authFetch('/api/refine-prompt', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        mode: 'coding',
                        input: input,
                        platform: platform,
                        complexity: complexity,
                        references: references
                    })
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.message || 'AI ËôïÁêÜÂ§±Êïó');
                }

                currentGeneratedPrompt = data.refinedPrompt;
                displayPromptResult(currentGeneratedPrompt);
                showPromptStatus('‚úÖ PRD Â∑≤ÁîüÊàêÔºÅÂèØË§áË£Ω‰ΩøÁî®Êñº Gemini / ChatGPT', 'success');

            } catch (error) {
                console.error('Coding prompt error:', error);
                showPromptStatus(`‚ùå ÈåØË™§: ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'ü§ñ AI ËΩâË≠ØÁÇ∫ÁµêÊßãÂåñ PRD';
            }
        }

        // ÁîüÊàêË¶ñË¶∫Áπ™Âúñ Prompt (Ë™øÁî® AI)
        function toggleCustomModelInput() {
            const modelSelect = document.getElementById('imageModel');
            const customInput = document.getElementById('customModelName');
            if (modelSelect.value === 'custom') {
                customInput.style.display = 'block';
            } else {
                customInput.style.display = 'none';
                customInput.value = '';
            }
        }

        // ==================== ÂèÉËÄÉË≥áÊñô‰∏äÂÇ≥ÂäüËÉΩ ====================
        const uploadedReferences = {
            coding: [],
            image: []
        };

        function handleDragOver(event, mode) {
            event.preventDefault();
            event.stopPropagation();
            const zone = document.getElementById(mode + 'UploadZone');
            zone.style.borderColor = mode === 'coding' ? '#2196F3' : '#9C27B0';
            zone.style.background = mode === 'coding' ? '#E3F2FD' : '#F3E5F5';
        }

        function handleDragLeave(event, mode) {
            event.preventDefault();
            event.stopPropagation();
            const zone = document.getElementById(mode + 'UploadZone');
            zone.style.borderColor = mode === 'coding' ? '#90CAF9' : '#CE93D8';
            zone.style.background = '#fff';
        }

        function handleDrop(event, mode) {
            event.preventDefault();
            event.stopPropagation();
            handleDragLeave(event, mode);
            
            const files = event.dataTransfer.files;
            if (files.length > 0) {
                processFiles(files, mode);
            }
        }

        function handleFileSelect(event, mode) {
            const files = event.target.files;
            if (files.length > 0) {
                processFiles(files, mode);
            }
        }

        async function processFiles(files, mode) {
            for (let file of files) {
                const fileType = getFileType(file);
                const fileData = {
                    type: 'file',
                    fileType: fileType,
                    name: file.name,
                    size: file.size,
                    file: file
                };

                if (fileType === 'image') {
                    fileData.preview = await readFileAsDataURL(file);
                }

                uploadedReferences[mode].push(fileData);
            }
            updateUploadedList(mode);
        }

        function readFileAsDataURL(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => resolve(e.target.result);
                reader.onerror = (e) => reject(e);
                reader.readAsDataURL(file);
            });
        }

        function getFileType(file) {
            const ext = file.name.split('.').pop().toLowerCase();
            const mimeType = file.type;

            if (mimeType.startsWith('image/') || ['jpg', 'jpeg', 'png', 'gif', 'webp', 'bmp', 'svg'].includes(ext)) {
                return 'image';
            } else if (ext === 'pdf' || mimeType === 'application/pdf') {
                return 'pdf';
            } else if (['doc', 'docx'].includes(ext) || mimeType.includes('word')) {
                return 'word';
            } else if (['xls', 'xlsx'].includes(ext) || mimeType.includes('excel') || mimeType.includes('spreadsheet')) {
                return 'excel';
            } else if (['ppt', 'pptx'].includes(ext) || mimeType.includes('presentation')) {
                return 'ppt';
            } else if (ext === 'md') {
                return 'markdown';
            } else {
                return 'text';
            }
        }

        function addUrlReference(mode) {
            const inputId = mode + 'UrlInput';
            const urlInput = document.getElementById(inputId);
            const url = urlInput.value.trim();

            if (!url) {
                alert('Ë´ãËº∏ÂÖ•ÊúâÊïàÁöÑÁ∂≤ÂùÄ');
                return;
            }

            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                alert('Ë´ãËº∏ÂÖ•ÂÆåÊï¥ÁöÑÁ∂≤ÂùÄ (http:// Êàñ https://)');
                return;
            }

            const urlData = {
                type: 'url',
                url: url,
                name: url.length > 40 ? url.substring(0, 40) + '...' : url
            };

            uploadedReferences[mode].push(urlData);
            urlInput.value = '';
            updateUploadedList(mode);
        }

        function updateUploadedList(mode) {
            const container = document.getElementById(mode + 'UploadedItems');
            const list = document.getElementById(mode + 'UploadedList');
            const refs = uploadedReferences[mode];

            if (refs.length === 0) {
                container.style.display = 'none';
                return;
            }

            container.style.display = 'block';
            list.innerHTML = '';

            refs.forEach((ref, index) => {
                const item = document.createElement('div');
                item.style.cssText = 'display: flex; align-items: center; gap: 6px; background: #f5f5f5; padding: 6px 10px; border-radius: 8px; font-size: 12px;';

                const icon = getFileIcon(ref);
                const name = ref.type === 'url' ? ref.name : ref.name;

                let preview = '';
                if (ref.type === 'file' && ref.fileType === 'image' && ref.preview) {
                    preview = `<img src="${ref.preview}" style="width: 24px; height: 24px; object-fit: cover; border-radius: 4px; margin-right: 4px;">`;
                }

                item.innerHTML = `
                    ${preview}
                    <span>${icon}</span>
                    <span style="max-width: 150px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${name}</span>
                    <button type="button" onclick="removeReference('${mode}', ${index})" style="background: none; border: none; cursor: pointer; padding: 2px; color: #999; font-size: 14px;">‚úï</button>
                `;
                list.appendChild(item);
            });
        }

        function getFileIcon(ref) {
            if (ref.type === 'url') return 'üîó';
            switch (ref.fileType) {
                case 'image': return 'üñºÔ∏è';
                case 'pdf': return 'üìÑ';
                case 'word': return 'üìù';
                case 'excel': return 'üìä';
                case 'ppt': return 'üìΩÔ∏è';
                case 'markdown': return 'üìã';
                default: return 'üìÑ';
            }
        }

        function removeReference(mode, index) {
            uploadedReferences[mode].splice(index, 1);
            updateUploadedList(mode);
        }

        async function prepareReferencesForAPI(mode) {
            const refs = uploadedReferences[mode];
            const preparedRefs = [];

            for (let ref of refs) {
                if (ref.type === 'url') {
                    preparedRefs.push({
                        type: 'url',
                        url: ref.url
                    });
                } else if (ref.type === 'file') {
                    if (ref.fileType === 'image') {
                        preparedRefs.push({
                            type: 'image',
                            name: ref.name,
                            data: ref.preview
                        });
                    } else {
                        const textContent = await readFileAsText(ref.file);
                        preparedRefs.push({
                            type: 'document',
                            fileType: ref.fileType,
                            name: ref.name,
                            content: textContent
                        });
                    }
                }
            }

            return preparedRefs;
        }

        function readFileAsText(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => resolve(e.target.result);
                reader.onerror = (e) => reject(e);
                
                if (file.type === 'application/pdf') {
                    resolve('[PDF Ê™îÊ°à - ÈúÄË¶ÅÂæåÁ´ØËß£Êûê]');
                } else if (file.name.endsWith('.docx') || file.name.endsWith('.doc')) {
                    resolve('[Word Ê™îÊ°à - ÈúÄË¶ÅÂæåÁ´ØËß£Êûê]');
                } else if (file.name.endsWith('.xlsx') || file.name.endsWith('.xls')) {
                    resolve('[Excel Ê™îÊ°à - ÈúÄË¶ÅÂæåÁ´ØËß£Êûê]');
                } else if (file.name.endsWith('.pptx') || file.name.endsWith('.ppt')) {
                    resolve('[PPT Ê™îÊ°à - ÈúÄË¶ÅÂæåÁ´ØËß£Êûê]');
                } else {
                    reader.readAsText(file);
                }
            });
        }

        async function generateImagePrompt() {
            const input = document.getElementById('imageInput').value;
            const style = document.getElementById('imageStyle').value;
            const ratio = document.getElementById('imageRatio').value;
            const imageModel = document.getElementById('imageModel').value;
            const customModelName = document.getElementById('customModelName')?.value || '';
            const imageSteps = document.getElementById('imageSteps')?.value || '';
            const imageFormat = document.getElementById('imageFormat')?.value || '';
            
            const qualityTags = [];
            if (document.getElementById('imgQualityHD')?.checked) qualityTags.push('HD');
            if (document.getElementById('imgQuality8K')?.checked) qualityTags.push('8K');
            if (document.getElementById('imgQualityDetail')?.checked) qualityTags.push('highly detailed');
            if (document.getElementById('imgQualityLighting')?.checked) qualityTags.push('professional lighting');

            if (!input.trim()) {
                showPromptStatus('Ë´ãËº∏ÂÖ•ÊÇ®ÊÉ≥ÁîüÊàêÁöÑÁï´Èù¢ÊèèËø∞', 'error');
                return;
            }

            if (imageModel === 'custom' && !customModelName.trim()) {
                showPromptStatus('Ë´ãËº∏ÂÖ•Ëá™ÂÆöÁæ©Ê®°ÂûãÂêçÁ®±', 'error');
                return;
            }

            const btn = document.getElementById('imageGenerateBtn');
            btn.disabled = true;
            btn.innerHTML = 'üîÑ AI ËôïÁêÜ‰∏≠...';

            const modelNames = {
                'nanobanana': 'Nano Banana (FLUX)',
                'gpt': 'GPT (DALL-E 3)',
                'midjourney': 'Midjourney',
                'custom': customModelName
            };

            try {
                const references = await prepareReferencesForAPI('image');
                
                const response = await AuthManager.authFetch('/api/refine-prompt', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        mode: 'image',
                        input: input,
                        style: style,
                        ratio: ratio,
                        qualityTags: qualityTags,
                        imageModel: imageModel,
                        customModelName: customModelName,
                        imageSteps: imageSteps,
                        imageFormat: imageFormat,
                        references: references
                    })
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.message || 'AI ËôïÁêÜÂ§±Êïó');
                }

                currentGeneratedPrompt = data.refinedPrompt;
                displayPromptResult(currentGeneratedPrompt);
                showPromptStatus(`‚úÖ ${modelNames[imageModel]} Â∞àÁî®Áπ™ÂúñÊåá‰ª§Â∑≤ÁîüÊàêÔºÅ`, 'success');

            } catch (error) {
                console.error('Image prompt error:', error);
                showPromptStatus(`‚ùå ÈåØË™§: ${error.message}`, 'error');
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'üé® AI ÁîüÊàêÁπ™ÂúñÊåá‰ª§';
            }
        }

        // È°ØÁ§∫ Prompt ÁµêÊûú
        function displayPromptResult(prompt) {
            const resultDiv = document.getElementById('promptResult');
            resultDiv.innerHTML = prompt.replace(/\n/g, '<br>');
            document.getElementById('promptActions').style.display = 'flex';
        }

        // È°ØÁ§∫ÁãÄÊÖãÊèêÁ§∫
        function showPromptStatus(message, type) {
            const statusDiv = document.getElementById('promptStatus');
            statusDiv.style.display = 'block';
            statusDiv.style.background = type === 'success' ? '#d4edda' : '#f8d7da';
            statusDiv.style.color = type === 'success' ? '#155724' : '#721c24';
            statusDiv.innerHTML = message;
            
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 5000);
        }

        // ‰∏ÄÈçµË§áË£Ω
        function copyPromptToClipboard() {
            if (!currentGeneratedPrompt) {
                showPromptStatus('Ê≤íÊúâÂèØË§áË£ΩÁöÑÂÖßÂÆπ', 'error');
                return;
            }

            navigator.clipboard.writeText(currentGeneratedPrompt).then(() => {
                showPromptStatus('‚úÖ Â∑≤Ë§áË£ΩÂà∞Ââ™Ë≤ºÁ∞øÔºÅ', 'success');
            }).catch(err => {
                console.error('Copy failed:', err);
                // Fallback for older browsers
                const textarea = document.createElement('textarea');
                textarea.value = currentGeneratedPrompt;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showPromptStatus('‚úÖ Â∑≤Ë§áË£ΩÂà∞Ââ™Ë≤ºÁ∞øÔºÅ', 'success');
            });
        }

        // Â∞éÂá∫ Word
        async function exportPromptToWord() {
            if (!currentGeneratedPrompt) {
                showPromptStatus('Ê≤íÊúâÂèØÂ∞éÂá∫ÁöÑÂÖßÂÆπ', 'error');
                return;
            }

            try {
                const response = await fetch('/api/export-prompt-word', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        prompt: currentGeneratedPrompt,
                        mode: currentPromptMode,
                        timestamp: new Date().toISOString()
                    })
                });

                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.message || 'Â∞éÂá∫Â§±Êïó');
                }

                // ‰∏ãËºâÊñá‰ª∂
                window.location.href = data.downloadUrl;
                showPromptStatus('‚úÖ Word ÊñáÊ™îÂ∑≤ÁîüÊàêÔºåÊ≠£Âú®‰∏ãËºâ...', 'success');

            } catch (error) {
                console.error('Word export error:', error);
                showPromptStatus(`‚ùå Â∞éÂá∫ÈåØË™§: ${error.message}`, 'error');
            }
        }
    </script>
    
    <!-- ÂºïÂÖ•Â§öË™ûË®ÄÁøªË≠ØÁ≥ªÁµ± -->
    <script src="/js/translations.js"></script>
    <!-- ÂºïÂÖ•Áî®Êà∂Ë™çË≠âÁ≥ªÁµ± -->
    <script src="/js/auth.js"></script>
    <!-- ÂºïÂÖ•Áî®Êà∂Â≠∏ÁøíËøΩËπ§Á≥ªÁµ± -->
    <script src="/js/userLearning.js"></script>
    <script src="/js/admin.js"></script>
    <script src="/js/adminConsole.js"></script>
    <script>
        function switchAdminTab(tabName) {
            document.querySelectorAll('.admin-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.admin-panel').forEach(panel => panel.classList.remove('active'));
            
            event.target.closest('.admin-tab').classList.add('active');
            
            if (tabName === 'users') {
                document.getElementById('adminUsersPanel').classList.add('active');
                AdminManager.loadAdminData();
            } else if (tabName === 'database') {
                document.getElementById('adminDatabasePanel').classList.add('active');
                AdminConsole.init();
            } else if (tabName === 'stats') {
                document.getElementById('adminStatsPanel').classList.add('active');
                loadSystemStats();
            }
        }
        
        async function loadSystemStats() {
            const container = document.getElementById('systemStatsContainer');
            if (!container) return;
            
            container.innerHTML = '<div class="stats-loading">ËºâÂÖ•Áµ±Ë®àË≥áÊñô‰∏≠...</div>';
            
            try {
                const [statsRes, activityRes, usersRes] = await Promise.all([
                    AuthManager.authFetch('/api/admin/db/stats'),
                    AuthManager.authFetch('/api/admin/db/activity?limit=10'),
                    AuthManager.authFetch('/api/admin/users')
                ]);
                
                const stats = await statsRes.json();
                const activity = await activityRes.json();
                const users = await usersRes.json();
                
                const userCount = users.users?.length || 0;
                const activeUsers = users.users?.filter(u => u.status === 'active').length || 0;
                
                container.innerHTML = `
                    <div class="stats-grid">
                        <div class="stat-card stat-card-primary">
                            <div class="stat-icon">üë•</div>
                            <div class="stat-value">${userCount}</div>
                            <div class="stat-label">Á∏ΩÁî®Êà∂Êï∏</div>
                        </div>
                        <div class="stat-card stat-card-success">
                            <div class="stat-icon">‚úÖ</div>
                            <div class="stat-value">${activeUsers}</div>
                            <div class="stat-label">Ê¥ªË∫çÁî®Êà∂</div>
                        </div>
                        <div class="stat-card stat-card-info">
                            <div class="stat-icon">üìä</div>
                            <div class="stat-value">${stats.stats?.totalRecords || 0}</div>
                            <div class="stat-label">Á∏ΩË®òÈåÑÊï∏</div>
                        </div>
                    </div>
                    
                    <div class="stats-section">
                        <h4>üìã Ë≥áÊñôË°®Áµ±Ë®à</h4>
                        <div class="table-stats">
                            ${Object.entries(stats.stats?.tables || {}).map(([name, count]) => `
                                <div class="table-stat-item">
                                    <span class="table-name">${name}</span>
                                    <span class="table-count">${count}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="stats-section">
                        <h4>üïê ÊúÄËøëÊ¥ªÂãï</h4>
                        <div class="activity-list">
                            ${activity.activity?.length > 0 ? activity.activity.map(item => `
                                <div class="activity-item">
                                    <span class="activity-feature">${item.feature_tab || 'N/A'}</span>
                                    <span class="activity-platform">${item.platform || ''}</span>
                                    <span class="activity-time">${new Date(item.created_at).toLocaleString()}</span>
                                </div>
                            `).join('') : '<div class="no-activity">Êö´ÁÑ°Ê¥ªÂãïË®òÈåÑ</div>'}
                        </div>
                    </div>
                `;
            } catch (error) {
                console.error('Failed to load system stats:', error);
                container.innerHTML = '<div class="error-text">ËºâÂÖ•Áµ±Ë®àË≥áÊñôÂ§±Êïó</div>';
            }
        }
    </script>
    <script>
        // ÂàùÂßãÂåñÊôÇÊáâÁî®Ë™ûË®ÄË®≠ÂÆö
        document.addEventListener('DOMContentLoaded', function() {
            updatePageLanguage();
        });
    </script>
    </div><!-- End of appShell -->
    
    <!-- Ë™çË≠âÂΩàÁ™ó Modal (ËàäÁâàÔºå‰øùÁïô‰ΩúÁÇ∫ÂÇôÁî®) -->
    <div class="auth-modal" id="authModal" style="display: none !important;">
        <div class="auth-modal-content">
            <div class="auth-tabs">
                <div class="auth-tab active" id="loginTab" onclick="AuthManager.switchAuthTab('login')">
                    <span data-i18n="auth_login_tab">ÁôªÂÖ•</span>
                </div>
                <div class="auth-tab" id="registerTab" onclick="AuthManager.switchAuthTab('register')">
                    <span data-i18n="auth_register_tab">Ë®ªÂÜä</span>
                </div>
            </div>
            
            <!-- ÁôªÂÖ•Ë°®ÂñÆ -->
            <div class="auth-form-container" id="loginFormContainer" style="display: block;">
                <div class="auth-error" id="loginError"></div>
                <form onsubmit="handleLogin(event)">
                    <div class="auth-form-group">
                        <label for="loginEmail" data-i18n="auth_email">ÈõªÂ≠êÈÉµ‰ª∂</label>
                        <input type="email" id="loginEmail" placeholder="your@email.com" required>
                    </div>
                    <div class="auth-form-group">
                        <label for="loginPassword" data-i18n="auth_password">ÂØÜÁ¢º</label>
                        <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                    <button type="submit" class="auth-submit-btn" data-i18n="auth_login_btn">ÁôªÂÖ•</button>
                </form>
            </div>
            
            <!-- Ë®ªÂÜäË°®ÂñÆ -->
            <div class="auth-form-container" id="registerFormContainer">
                <div class="auth-error" id="registerError"></div>
                <form onsubmit="handleRegister(event)">
                    <div class="auth-form-group">
                        <label for="registerEmail" data-i18n="auth_email">ÈõªÂ≠êÈÉµ‰ª∂</label>
                        <input type="email" id="registerEmail" placeholder="your@email.com" required>
                    </div>
                    <div class="auth-form-group">
                        <label for="registerPassword" data-i18n="auth_password">ÂØÜÁ¢º</label>
                        <input type="password" id="registerPassword" placeholder="Ëá≥Â∞ë6ÂÄãÂ≠óÁ¨¶" required>
                    </div>
                    <div class="auth-form-group">
                        <label for="registerConfirmPassword" data-i18n="auth_confirm_password">Á¢∫Ë™çÂØÜÁ¢º</label>
                        <input type="password" id="registerConfirmPassword" placeholder="ÂÜçÊ¨°Ëº∏ÂÖ•ÂØÜÁ¢º" required>
                    </div>
                    <button type="submit" class="auth-submit-btn" data-i18n="auth_register_btn">Ë®ªÂÜä</button>
                </form>
            </div>
        </div>
    </div>
</body>
</html>